---
title: "WMAP - Metasploit Web Application Vulnerability Scanner"
topic: "Web Application Scanning"
exam_objective: "Web Application Security Assessment and Vulnerability Discovery"
difficulty: "Medium"
tools:
  - "WMAP"
  - "Metasploit Framework"
  - "msfconsole"
related_labs:
  - "06-vulnerability-assessment/nikto-web-scanner.md"
  - "05-service-enumeration/http-enumeration-complete.md"
file_path: "06-vulnerability-assessment/wmap-vulnerability-scanning.md"
last_updated: "2024-11-15"
tags:
  - "web-scanning"
  - "vulnerability-assessment"
  - "metasploit"
  - "ejpt-exam"
---

# 🌐 WMAP - Metasploit Web Application Vulnerability Scanner

**WMAP is a web application vulnerability scanner built into Metasploit Framework. It finds security problems in websites automatically using many different tests - Critical for eJPT exam success!**

## 🎯 What is WMAP?

**WMAP (Web Mapper)** is a powerful web application security scanner that comes built into the Metasploit Framework. It helps penetration testers find vulnerabilities in web applications by running multiple automated tests. WMAP is **very important for eJPT exam** because it covers 25% of web application testing content.

### How WMAP Works
```bash
# Basic workflow:
# 1. Load WMAP → load wmap
# 2. Add target site → wmap_sites -a target_ip
# 3. Add target URL → wmap_targets -t http://target_ip
# 4. Run scan → wmap_run -e
# 5. Check results → wmap_vulns -l
```

### Why It's So Important
- **Built into Metasploit** - No need to install extra tools
- **Automated Testing** - Runs 39+ vulnerability tests automatically
- **Easy Integration** - Works perfectly with other Metasploit modules
- **eJPT Focus** - 25% of web application exam questions use WMAP

---

## 📊 WMAP Components

### Main Features You Must Know
| Feature | What It Does | eJPT Importance |
|---------|--------------|-----------------|
| **Web Server Detection** | Finds web server type and version | 🔴 Critical - 90% |
| **Directory Discovery** | Finds hidden folders and files | 🔴 Critical - 85% |
| **Admin Panel Detection** | Locates admin login pages | 🔴 Critical - 80% |
| **Vulnerability Scanning** | Tests for common web flaws | 🔴 Critical - 95% |
| **Service Enumeration** | Identifies running web services | 🟡 Medium - 60% |

### Module Categories Explained
- **🔍 Scanner Modules:** Find information about web servers (http_version, robots_txt)
- **🚨 Vulnerability Tests:** Test for specific security issues (traversal, injection)
- **📁 Directory Finders:** Discover hidden paths and files (dir_scanner, files_dir)
- **🔐 Admin Finders:** Locate administrative interfaces (admin_dir_listing)
- **📊 Information Gathering:** Collect web application data (scraper, headers)

---

## 📦 Installation and Setup

### System Requirements

#### What You Need:
- **OS:** Kali Linux (WMAP comes pre-installed)
- **RAM:** 2GB minimum (4GB recommended)
- **Storage:** 5GB free space
- **Network:** Internet connection for updates

#### Software Requirements:
- **Metasploit Framework** 6.0 or newer
- **PostgreSQL Database** (for speed and reliability)
- **Ruby Runtime** 2.7+ (included in Kali)

### Quick Setup Check

#### Method 1: Verify Installation (Kali Linux)
```bash
# Check Metasploit version
msfconsole --version
# Expected: metasploit v6.x.x-dev

# Start Metasploit
msfconsole -q

# Load WMAP plugin
msf6 > load wmap
[*] Successfully loaded plugin: wmap
# ✅ WMAP is ready to use!
```

#### Method 2: Database Setup (Critical for Speed!)
```bash
# Check database status
msfdb status
# Expected: Database started

# If database not running:
sudo msfdb init

# Verify in Metasploit
msfconsole -q
msf6 > db_status
# Expected: [*] Connected to msf. Connection type: postgresql
```

---

## 🔧 Essential WMAP Commands

### Core Commands You Must Know

#### 🌐 Site Management Commands
| Command | What It Does | Example |
|---------|--------------|---------|
| `wmap_sites -a [IP]` | Add target website | `wmap_sites -a 192.168.1.100` |
| `wmap_sites -l` | List all added sites | `wmap_sites -l` |
| `wmap_sites -d [ID]` | Delete specific site | `wmap_sites -d 0` |
| `wmap_sites -c` | Clear all sites | `wmap_sites -c` |

#### 🎯 Target Management Commands
| Command | What It Does | Example |
|---------|--------------|---------|
| `wmap_targets -t [URL]` | Add target URL | `wmap_targets -t http://192.168.1.100` |
| `wmap_targets -l` | List all targets | `wmap_targets -l` |
| `wmap_targets -c` | Clear all targets | `wmap_targets -c` |
| `wmap_targets -u [URL]` | Add single URL | `wmap_targets -u http://example.com/admin` |

#### 🚀 Scanning Commands
| Command | What It Does | Example | Use Case |
|---------|--------------|---------|----------|
| `wmap_run -t` | Test modules (preview) | `wmap_run -t` | Check what will run |
| `wmap_run -e` | Execute full scan | `wmap_run -e` | **Most important for eJPT** |
| `wmap_run -p` | Show scan progress | `wmap_run -p` | Monitor running scans |
| `wmap_run -m [module]` | Run specific module | `wmap_run -m http_version` | Targeted testing |

#### 📊 Results Commands
| Command | What It Does | Output |
|---------|--------------|--------|
| `wmap_vulns -l` | List vulnerabilities found | **Critical for eJPT reporting** |
| `wmap_nodes -l` | Show discovered paths | All found directories/files |
| `wmap_help` | Show all WMAP commands | Complete command reference |

---

## 🧪 Real Lab Example: Complete Web Assessment

### Step 1: Network Discovery

```bash
# Find your network interface
ifconfig

# Expected output analysis:
eth0: inet 192.157.89.2  # Your Kali Linux IP
eth1: inet 10.1.1.5      # Alternative interface

# Target is likely: 192.157.89.3 (next IP in range)
```

### Step 2: Basic Target Verification

```bash
# Test if target is alive
ping -c 4 192.157.89.3

# Expected response:
64 bytes from 192.157.89.3: icmp_seq=1 ttl=64 time=0.100 ms
# ✅ TTL=64 means Linux system
# ✅ Fast response means target is up

# Quick port check
nmap -p 80,443 192.157.89.3

# Expected result:
PORT   STATE SERVICE
80/tcp open  http
# ✅ Web server is running on port 80
```

### Step 3: Start Metasploit and Load WMAP

```bash
# Launch Metasploit (quiet mode for exams)
msfconsole -q

# Verify database connection
msf6 > db_status
[*] Connected to msf. Connection type: postgresql
# ✅ Database working properly

# Load WMAP plugin
msf6 > load wmap
[*] Successfully loaded plugin: wmap
# ✅ WMAP ready to use

# Verify WMAP commands available
msf6 > wmap_help
# Shows complete command list
```

### Step 4: Configure WMAP Target

```bash
# Add target site
msf6 > wmap_sites -a 192.157.89.3
[*] Site created.

# Add target URL
msf6 > wmap_targets -t http://192.157.89.3
[*] Target created.

# Verify configuration
msf6 > wmap_sites -l
[*] Available sites
===============
    Id  Host           Port  Proto  # Pages  # Forms
    --  ----           ----  -----  -------  -------
    0   192.157.89.3   80    http   0        0

# ✅ Target properly configured
```

### Step 5: Preview Scan Modules

```bash
# Test what modules will run (important step!)
msf6 > wmap_run -t

[*] Testing target:
[*]     Site: 192.157.89.3 (192.157.89.3)
[*]     Port: 80 SSL: false
===============================================
[*] Loading wmap modules...
[*] 39 wmap enabled modules loaded.

=[ Web Server testing ]=
===============================================
[*] Module auxiliary/scanner/http/http_version
[*] Module auxiliary/scanner/http/robots_txt
[*] Module auxiliary/scanner/http/dir_scanner
[*] Module auxiliary/admin/http/tomcat_administration
[*] Module auxiliary/scanner/http/options
[*] Module auxiliary/scanner/http/trace
[*] ... (additional modules listed)

# 🎯 Key modules that will run:
# - http_version (finds server type)
# - robots_txt (checks robots.txt file)
# - dir_scanner (finds directories)
# - admin modules (looks for admin panels)
```

### Step 6: Execute Full Vulnerability Scan

```bash
# Run complete WMAP scan
msf6 > wmap_run -e

[*] Using ALL wmap enabled modules
[*] Testing started. 2024-11-15 14:30:45 +0000

=[ Web Server testing ]=
===============================================
[*] Module auxiliary/scanner/http/http_version
[+] 192.157.89.3:80 Apache/2.4.18 (Ubuntu)

[*] Module auxiliary/scanner/http/robots_txt
[+] Contents of Robots.txt:
User-agent: *
Disallow: /admin
Disallow: /backup

[*] Module auxiliary/scanner/http/dir_scanner
[+] Found http://192.157.89.3:80/admin/ 401 (Unauthorized)
[+] Found http://192.157.89.3:80/backup/ 200 (OK)
[+] Found http://192.157.89.3:80/images/ 200 (OK)

[*] Module auxiliary/admin/http/tomcat_administration
[*] Attempting to connect to 192.157.89.3:80
[+] No Tomcat manager found

# 🎉 CRITICAL FINDINGS:
# ✅ Web Server: Apache/2.4.18 (Ubuntu)
# ✅ Hidden directories: /admin, /backup, /images
# ✅ Admin directory requires authentication
# ✅ Backup directory is accessible
```

### Step 7: Analyze Results and Findings

```bash
# List all discovered vulnerabilities
msf6 > wmap_vulns -l

# List all discovered web paths
msf6 > wmap_nodes -l
[*] Available nodes
===============
    Id  Method  URL                              Name
    --  ------  ---                              ----
    0   GET     http://192.157.89.3:80/          
    1   GET     http://192.157.89.3:80/admin/    admin
    2   GET     http://192.157.89.3:80/backup/   backup
    3   GET     http://192.157.89.3:80/images/   images

# 📊 Analysis for eJPT:
# - Found 4 web paths total
# - Admin directory exists (potential target)
# - Backup directory accessible (high priority)
# - Images directory for reconnaissance
```

### Step 8: Document Critical Information

```bash
# Key information for eJPT report:

# 1. WEB SERVER DETAILS:
Server: Apache/2.4.18 (Ubuntu)
OS: Linux (Ubuntu)
Port: 80 (HTTP)

# 2. DISCOVERED DIRECTORIES:
/admin/ - Returns 401 (Authentication required)
/backup/ - Returns 200 (Accessible - HIGH PRIORITY!)
/images/ - Returns 200 (Accessible)

# 3. SECURITY FINDINGS:
- Robots.txt reveals hidden directories
- Backup directory exposed publicly
- No SSL/HTTPS encryption
- Directory listing may be enabled
```

---

## 🎯 eJPT Exam Focus (Critical for Success!)

### Exam Statistics and Importance

| Skill Area | Exam Weight | Time to Spend | Must Master |
|------------|-------------|---------------|-------------|
| **Web Server Identification** | 🔴 30% | 3 minutes | Server version detection |
| **Directory Discovery** | 🔴 25% | 5 minutes | Hidden path enumeration |
| **Admin Interface Detection** | 🔴 20% | 3 minutes | Login panel discovery |
| **Vulnerability Documentation** | 🔴 15% | 4 minutes | Proper finding reports |
| **WMAP Configuration** | 🟡 10% | 2 minutes | Target setup correctly |

### Commands You MUST Memorize

```bash
# 1. ESSENTIAL STARTUP SEQUENCE (Practice daily!)
msfconsole -q                                    # Quick start
load wmap                                        # Load WMAP plugin

# 2. TARGET CONFIGURATION (Know by heart!)
wmap_sites -a [TARGET_IP]                       # Add site
wmap_targets -t http://[TARGET_IP]              # Add target URL
wmap_sites -l                                   # Verify sites
wmap_targets -l                                 # Verify targets

# 3. SCANNING WORKFLOW (Essential!)
wmap_run -t                                     # Preview modules
wmap_run -e                                     # Execute scan
wmap_vulns -l                                   # List vulnerabilities
wmap_nodes -l                                   # List discovered paths

# 4. QUICK VERIFICATION (Time-saving!)
wmap_help                                       # Show commands
db_status                                       # Check database
```

### Common eJPT Scenarios with WMAP

#### **Scenario 1: Basic Web Server Assessment** ⭐⭐⭐⭐⭐
```
What you get: IP address with web server running
What you must do: Identify web server and find hidden directories
Time limit: 10 minutes maximum
Success criteria:
✅ Use WMAP to scan target website
✅ Identify web server software and version
✅ Find at least 2 hidden directories
✅ Document findings with screenshots
```

**Solution Approach:**
```bash
# Quick execution sequence:
msfconsole -q
load wmap
wmap_sites -a [TARGET_IP]
wmap_targets -t http://[TARGET_IP]
wmap_run -e
wmap_vulns -l
```

#### **Scenario 2: Administrative Interface Discovery** ⭐⭐⭐⭐
```
What you get: Corporate website with potential admin areas
What you must do: Find administrative login panels
Time limit: 15 minutes maximum
Success criteria:
✅ Configure WMAP for comprehensive scanning
✅ Identify admin directories (/admin, /manager, etc.)
✅ Test accessibility of admin interfaces
✅ Report authentication requirements
```

#### **Scenario 3: Multi-Port Web Application Testing** ⭐⭐⭐
```
What you get: Server with web services on multiple ports
What you must do: Scan all web services comprehensively
Time limit: 20 minutes maximum
Success criteria:
✅ Add multiple sites (port 80, 8080, 443)
✅ Scan each service independently
✅ Compare findings across different ports
✅ Prioritize vulnerabilities by impact
```

### Time Management for eJPT

**⏰ Optimal Time Distribution (for WMAP tasks):**
- **🔧 Setup and Configuration:** 2 minutes (10%)
- **🔍 Scan Execution:** 8 minutes (40%)
- **📊 Results Analysis:** 6 minutes (30%)
- **📝 Documentation:** 4 minutes (20%)

### Success Tips for eJPT

**🔥 Before Starting WMAP:**
- Verify database connection works (`db_status`)
- Test basic network connectivity to target
- Check that target has web service running
- Have screenshot tool ready

**🔥 During WMAP Scanning:**
- Always run `wmap_run -t` first to preview
- Let full scan complete before checking results
- Take screenshots of command outputs
- Focus on [+] positive findings in output

**🔥 Common Mistakes to Avoid:**
- ❌ Forgetting to load WMAP plugin first
- ❌ Not setting up sites and targets properly
- ❌ Stopping scan before completion
- ❌ Missing important findings in long output
- ❌ Not documenting server version information

---

## ⚠️ Common Problems and Solutions

### Problem 1: WMAP Plugin Won't Load

**🚨 What's wrong:** `load wmap` command fails or shows errors

**🔍 Why this happens:**
- Database not initialized properly
- Metasploit installation corrupted
- PostgreSQL service not running

**✅ How to fix:**
```bash
# Check database status first
sudo msfdb status

# If database problems:
sudo msfdb delete
sudo msfdb init

# Restart Metasploit
msfconsole -q
load wmap

# Verify WMAP works
wmap_help
```

### Problem 2: Target Not Responding During Scan

**🚨 What's wrong:** WMAP scan hangs or shows connection errors

**🔍 Why this happens:**
- Target firewall blocking requests
- Wrong IP address or port
- Network connectivity issues

**✅ How to fix:**
```bash
# Test basic connectivity first
ping [TARGET_IP]                    # Basic network test
telnet [TARGET_IP] 80               # Test HTTP port
curl -I http://[TARGET_IP]          # Test HTTP response

# If connectivity good, try:
# Reduce scan intensity
# Use specific modules instead of full scan
wmap_run -m http_version            # Test single module
```

### Problem 3: No Results or Empty Output

**🚨 What's wrong:** WMAP completes but shows no findings

**🔍 Why this happens:**
- Target not configured correctly
- Web server using non-standard responses
- Modules not loading properly

**✅ How to fix:**
```bash
# Verify target configuration
wmap_sites -l                       # Check sites list
wmap_targets -l                     # Check targets list

# Test manual connection
use auxiliary/scanner/http/http_version
set RHOSTS [TARGET_IP]
run

# Reconfigure if needed
wmap_sites -c                       # Clear sites
wmap_targets -c                     # Clear targets
# Add target again with full URL
```

### Problem 4: Scan Takes Too Long

**🚨 What's wrong:** WMAP scan runs for very long time

**🔍 Why this happens:**
- Too many modules running
- Target responding slowly
- Network latency issues

**✅ How to fix:**
```bash
# Check scan progress
wmap_run -p                         # Show progress

# Stop current scan if needed
# Use Ctrl+C to interrupt

# Run selective modules instead
wmap_run -m http_version            # Quick server check
wmap_run -m robots_txt              # Fast robots.txt check
wmap_run -m dir_scanner             # Directory enumeration only
```

---

## 🔗 Integration with Other Tools

### Primary Integration: Nmap → WMAP → Manual Testing

#### **Complete Web Application Assessment Workflow**
```bash
# Phase 1: Network Discovery with Nmap
nmap -sS -sV -p 80,443,8080 [TARGET_IP]        # Find web services

# Phase 2: WMAP Automated Scanning
msfconsole -q
load wmap
wmap_sites -a [TARGET_IP]
wmap_targets -t http://[TARGET_IP]
wmap_run -e

# Phase 3: Manual Follow-up Testing
# Use WMAP findings to guide manual testing
# Focus on discovered directories and vulnerabilities
```

#### **Information Flow Example**
```
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│    Nmap     │───▶│    WMAP     │───▶│   Manual    │
│             │    │             │    │   Testing   │
│ • Port 80   │    │ • Server:   │    │ • Admin     │
│ • HTTP      │    │   Apache    │    │   Login     │
│ • Version   │    │ • /admin/   │    │ • Brute     │
│   Detection │    │ • /backup/  │    │   Force     │
└─────────────┘    └─────────────┘    └─────────────┘
```

### Secondary Integration: WMAP → Dirb → Burp Suite

#### **Enhanced Directory Discovery**
```bash
# Step 1: WMAP baseline scan
wmap_run -e                         # Get initial findings

# Step 2: Targeted dirb scanning
dirb http://[TARGET_IP] /usr/share/wordlists/dirb/common.txt

# Step 3: Manual testing with Burp Suite
# Import discovered URLs into Burp Suite
# Perform detailed parameter analysis
# Test for injection vulnerabilities
```

### Database Integration for Advanced Analysis

```bash
# Import external scan data
msfconsole -q
db_import nmap_results.xml          # Import Nmap findings

# Run WMAP against imported targets
hosts -R                            # Auto-set RHOSTS from database
wmap_sites -a                       # Add from database
services -p 80,443,8080             # Show web services

# Combined analysis
db_export -f xml /tmp/full_results.xml  # Export all findings
```

---

## 📝 Documentation and Reporting

### Evidence You Must Collect for eJPT

**🔥 Screenshots Required:**
- [ ] WMAP plugin loading confirmation (`load wmap` success)
- [ ] Target configuration display (`wmap_sites -l` and `wmap_targets -l`)
- [ ] Scan execution output (at least the key findings)
- [ ] Vulnerability summary (`wmap_vulns -l`)
- [ ] Discovered paths listing (`wmap_nodes -l`)
- [ ] Web server version information

**🔥 Command Logs to Save:**
```bash
# Create log file for documentation
script wmap_session.log             # Start logging

# Run your WMAP commands
msfconsole -q
load wmap
wmap_sites -a [TARGET_IP]
wmap_targets -t http://[TARGET_IP]
wmap_run -e
wmap_vulns -l
wmap_nodes -l

exit                                # Stop logging
# All commands saved to wmap_session.log
```

### Professional Report Template

```markdown
# WMAP Web Application Security Assessment

## Executive Summary
Automated web application security assessment performed using WMAP scanner integrated with Metasploit Framework. Assessment identified web server configuration and discovered accessible directories requiring security review.

## Target Information
- **Target System:** 192.157.89.3
- **Assessment Date:** November 15, 2024
- **Tools Used:** WMAP (Metasploit Framework)
- **Assessment Type:** Automated vulnerability scanning

## Technical Findings

### Web Server Information
**Discovery Method:** WMAP http_version scanner
**Finding:** Apache/2.4.18 (Ubuntu)
**Risk Level:** Low (Information Disclosure)
**Evidence:**
```bash
[+] 192.157.89.3:80 Apache/2.4.18 (Ubuntu)
```

### Directory Discovery Results
**Discovery Method:** WMAP directory enumeration
**Findings:**
- `/admin/` - HTTP 401 (Authentication Required)
- `/backup/` - HTTP 200 (Publicly Accessible) **HIGH RISK**
- `/images/` - HTTP 200 (Accessible)

**Risk Assessment:**
- **Critical:** Backup directory publicly accessible
- **Medium:** Admin interface exposed (though protected)
- **Low:** Images directory accessible

### Security Configuration Analysis
**robots.txt Analysis:**
```
User-agent: *
Disallow: /admin
Disallow: /backup
```
**Finding:** robots.txt reveals sensitive directory locations

## Recommendations

### Immediate Actions (0-24 hours)
1. **Secure backup directory:** Remove public access to `/backup/`
2. **Review robots.txt:** Remove or modify to not reveal sensitive paths
3. **Implement access controls:** Ensure admin areas properly protected

### Short-term Actions (1-7 days)
1. **Server hardening:** Configure Apache to hide version information
2. **Directory monitoring:** Implement logging for sensitive directory access
3. **Security headers:** Add appropriate HTTP security headers

## Supporting Evidence
- WMAP scan configuration screenshots
- Complete vulnerability scan output
- Directory discovery evidence
- Command execution logs
```

### Automated Documentation Script

```bash
#!/bin/bash
# WMAP Assessment Documentation Generator

TARGET=$1
TIMESTAMP=$(date '+%Y-%m-%d_%H-%M-%S')
REPORT_DIR="wmap_assessment_$TIMESTAMP"
mkdir -p $REPORT_DIR

echo "[+] Starting WMAP assessment documentation for $TARGET"

# Generate Metasploit resource file
cat > $REPORT_DIR/wmap_commands.rc << EOF
load wmap
wmap_sites -a $TARGET
wmap_targets -t http://$TARGET
wmap_run -e
wmap_vulns -l
wmap_nodes -l
wmap_sites -l
wmap_targets -l
exit
EOF

# Execute WMAP scan and capture output
echo "[+] Running WMAP scan..."
msfconsole -r $REPORT_DIR/wmap_commands.rc > $REPORT_DIR/wmap_full_output.txt

# Extract key findings
echo "[+] Extracting key findings..."
grep '\[+\]' $REPORT_DIR/wmap_full_output.txt > $REPORT_DIR/key_findings.txt
grep 'Apache\|nginx\|IIS' $REPORT_DIR/wmap_full_output.txt > $REPORT_DIR/server_info.txt

# Generate summary report
cat > $REPORT_DIR/executive_summary.md << EOF
# WMAP Assessment Summary

**Target:** $TARGET
**Date:** $(date)
**Assessment Tool:** WMAP (Metasploit Framework)

## Key Findings
$(cat $REPORT_DIR/key_findings.txt)

## Server Information
$(cat $REPORT_DIR/server_info.txt)

## Files Generated
- wmap_full_output.txt (Complete scan results)
- key_findings.txt (Important discoveries)
- server_info.txt (Web server details)
- wmap_commands.rc (Commands executed)
EOF

echo "[+] Assessment complete. Results in: $REPORT_DIR"
```

---

## 📚 Learning Resources and Practice

### Official Documentation and Guides
| Resource | Link | Purpose |
|----------|------|---------|
| **Metasploit Docs** | https://docs.rapid7.com/metasploit/ | Official WMAP documentation |
| **Rapid7 Blog** | https://blog.rapid7.com/ | Latest techniques and updates |
| **Metasploit Unleashed** | https://www.offensive-security.com/metasploit-unleashed/ | Comprehensive free course |

### Practice Environments for WMAP

#### **Beginner Level (Start Here):**
- **DVWA (Damn Vulnerable Web Application):** Simple web vulnerabilities
- **Metasploitable 2:** Classic vulnerable Linux with web services
- **bWAPP:** Buggy Web Application with multiple vulnerability types
- **WebGoat:** OWASP educational web application

#### **Intermediate Level:**
- **Metasploitable 3:** Advanced vulnerable systems (Windows/Linux)
- **VulnHub Web Challenges:** Various difficulty web applications
- **OverTheWire Natas:** Web exploitation challenges
- **PentesterLab Web Exercises:** Professional-grade practice

#### **Advanced Level:**
- **HackTheBox Web Challenges:** Real-world difficulty scenarios
- **TryHackMe Web Fundamentals:** Guided learning with WMAP
- **Custom Lab Environments:** Build your own vulnerable web apps
- **Bug Bounty Platforms:** Real applications (with permission)

### eJPT Preparation Schedule for WMAP

#### **Week 1: Foundation Building**
- [ ] Install and configure Metasploit with database
- [ ] Learn basic WMAP commands and workflow
- [ ] Practice on DVWA and simple vulnerable applications
- [ ] Master site and target configuration

#### **Week 2: Practical Skills Development**
- [ ] Practice complete WMAP assessments daily
- [ ] Learn to interpret scan results effectively
- [ ] Practice integration with Nmap and other tools
- [ ] Develop documentation and reporting skills

#### **Week 3: Advanced Techniques**
- [ ] Practice multi-target and multi-port scenarios
- [ ] Learn selective module execution
- [ ] Master troubleshooting common issues
- [ ] Practice under time pressure (15-minute assessments)

#### **Week 4: Exam Preparation**
- [ ] Take timed mock exams with WMAP components
- [ ] Review all critical commands and workflows
- [ ] Practice rapid documentation and reporting
- [ ] Final system setup verification and testing

### Quick Reference Command Card

```bash
# ============================================
#           WMAP ESSENTIAL COMMANDS
# ============================================

# BASIC WORKFLOW (memorize this sequence)
msfconsole -q                       # Start Metasploit
load wmap                           # Load WMAP plugin
wmap_sites -a TARGET_IP            # Add target site
wmap_targets -t http://TARGET_IP   # Add target URL
wmap_run -e                        # Execute full scan

# VERIFICATION COMMANDS
wmap_sites -l                      # List configured sites
wmap_targets -l                    # List configured targets
wmap_run -t                        # Preview modules (test mode)

# RESULTS ANALYSIS
wmap_vulns -l                      # List vulnerabilities found
wmap_nodes -l                      # List discovered paths
wmap_help                          # Show all commands

# TROUBLESHOOTING
db_status                          # Check database connection
wmap_sites -c                      # Clear all sites
wmap_targets -c                    # Clear all targets

# TIME-SAVING SHORTCUTS
wmap_run -p                        # Show scan progress
# Ctrl+C                           # Stop running scan
```

---

## 🏁 Final Exam Preparation Checklist

### Technical Readiness Assessment

#### **Core Skills** (Must Score 95%+)
- [ ] Can load WMAP plugin successfully in under 30 seconds
- [ ] Can configure target sites and URLs correctly
- [ ] Can execute full WMAP scan and interpret results
- [ ] Can identify web server versions from scan output
- [ ] Can extract discovered directories and files

#### **Practical Application** (Must Score 90%+)
- [ ] Complete basic WMAP assessment in under 10 minutes
- [ ] Successfully identify at least 3 different web server types
- [ ] Find hidden directories using WMAP scanner
- [ ] Document findings with proper screenshots
- [ ] Troubleshoot common WMAP connectivity issues

#### **Exam Simulation** (Must Score 85%+)
- [ ] Perform WMAP assessment under time pressure
- [ ] Handle multiple targets efficiently
- [ ] Integrate WMAP findings with manual testing
- [ ] Generate professional assessment reports
- [ ] Demonstrate ethical testing practices

### Last-Minute Review Strategy

**🔥 24 Hours Before Exam:**
1. **System Check:** Verify Metasploit and WMAP work perfectly
2. **Command Review:** Practice essential command sequences from memory
3. **Target Testing:** Test WMAP against known vulnerable applications
4. **Documentation:** Prepare templates for rapid evidence collection
5. **Network Setup:** Verify all network interfaces and connectivity

**🔥 Day of Exam:**
1. **Early Start:** Begin with clear mind and confidence
2. **Read Carefully:** Understand each web application scenario completely
3. **Document Everything:** Screenshot every successful WMAP output
4. **Stay Methodical:** Follow the systematic WMAP workflow
5. **Time Management:** Allocate maximum 15 minutes per WMAP task

### Memory Aids and Mnemonics

#### **WMAP Command Memory System**
```
S.T.A.R. Method:
S - Sites (wmap_sites -a TARGET)
T - Targets (wmap_targets -t http://TARGET)  
A - Activate (wmap_run -e)
R - Results (wmap_vulns -l, wmap_nodes -l)
```

#### **Common Finding Patterns**
```
Web Server Memory Aid:
Apache = Look for version disclosure
IIS = Check for Microsoft-specific modules
nginx = Focus on configuration issues
Tomcat = Search for admin interfaces
```

---

## 🛡️ Security and Legal Considerations

### Rules of Engagement for WMAP Testing

#### **Before Starting Any WMAP Scan**
```bash
# Legal verification checklist:
# [ ] Written authorization obtained
# [ ] Target scope clearly defined
# [ ] Time windows established
# [ ] Rate limiting considerations
# [ ] Data handling agreements in place
```

#### **Responsible Scanning Practices**
```bash
# Configure reasonable scan parameters
# Avoid overwhelming target systems
# Respect robots.txt directives when appropriate
# Document all testing activities thoroughly

# Example of responsible configuration:
set THREADS 5              # Limit concurrent connections
set Proxies http:127.0.0.1:8080  # Route through proxy if required
```

### Ethical Testing Guidelines

#### **Professional Standards**
- Only scan systems you have explicit permission to test
- Report vulnerabilities responsibly to system owners
- Protect sensitive data discovered during testing
- Follow coordinated disclosure timelines
- Document authorization and scope clearly

#### **Data Protection During WMAP Scans**
```bash
# Secure evidence handling
mkdir secure_wmap_evidence_$(date +%Y%m%d)
chmod 700 secure_wmap_evidence_*

# Store all WMAP outputs securely
wmap_vulns -l > secure_wmap_evidence_*/vulnerabilities.txt
wmap_nodes -l > secure_wmap_evidence_*/discovered_paths.txt
```

---

## 🚀 Advanced WMAP Techniques

### Selective Module Execution

#### **Server-Specific Testing**
```bash
# For Apache servers (after detection)
msf6 > use auxiliary/scanner/http/apache_userdir_enum
msf6 > set RHOSTS TARGET_IP
msf6 > run

# For IIS servers  
msf6 > use auxiliary/scanner/http/iis_internal_ip
msf6 > set RHOSTS TARGET_IP
msf6 > run

# For content management systems
msf6 > use auxiliary/scanner/http/wordpress_login_enum
msf6 > set RHOSTS TARGET_IP
msf6 > run
```

#### **Custom WMAP Workflows**
```bash
# Quick assessment workflow
modules=(
  "auxiliary/scanner/http/http_version"
  "auxiliary/scanner/http/robots_txt"
  "auxiliary/scanner/http/dir_scanner"
  "auxiliary/admin/http/tomcat_administration"
)

# Execute each module individually
for module in "${modules[@]}"; do
  echo "Running $module..."
  msfconsole -q -x "use $module; set RHOSTS TARGET_IP; run; exit"
done
```

### Performance Optimization

#### **Resource Management for Large Scans**
```bash
# Optimize WMAP performance
msf6 > setg THREADS 10              # Increase thread count
msf6 > setg ConnectTimeout 5        # Reduce timeout
msf6 > setg VERBOSE false           # Reduce output verbosity

# Monitor system resources during scan
# In separate terminal:
top                                 # Monitor CPU usage
netstat -an | grep TARGET_IP        # Monitor connections
```

#### **Batch Processing Multiple Targets**
```bash
#!/bin/bash
# Multiple target WMAP assessment script

TARGETS_FILE="web_targets.txt"
RESULTS_DIR="wmap_batch_results_$(date +%Y%m%d_%H%M%S)"
mkdir -p $RESULTS_DIR

while read -r target; do
  echo "[+] Scanning $target..."
  
  cat > temp_wmap.rc << EOF
load wmap
wmap_sites -a $target
wmap_targets -t http://$target
wmap_run -e
wmap_vulns -l
wmap_nodes -l
exit
EOF

  msfconsole -r temp_wmap.rc > "$RESULTS_DIR/wmap_$target.txt"
  rm temp_wmap.rc
  
done < $TARGETS_FILE

echo "[+] Batch scanning complete. Results in: $RESULTS_DIR"
```

---

## 🔧 Integration with Automation Tools

### WMAP in Automated Penetration Testing

#### **Integration with Other Metasploit Modules**
```bash
# Complete web application assessment chain
#!/bin/bash

TARGET=$1
echo "[+] Starting comprehensive web assessment for $TARGET"

# Phase 1: Service detection
msfconsole -q -x "
use auxiliary/scanner/portscan/syn;
set RHOSTS $TARGET;
set PORTS 80,443,8080,8443;
run;
exit" > service_scan.txt

# Phase 2: WMAP vulnerability scanning  
msfconsole -q -x "
load wmap;
wmap_sites -a $TARGET;
wmap_targets -t http://$TARGET;
wmap_run -e;
wmap_vulns -l;
exit" > wmap_scan.txt

# Phase 3: Specific vulnerability testing
msfconsole -q -x "
use auxiliary/scanner/http/http_put;
set RHOSTS $TARGET;
run;
use auxiliary/scanner/http/options;
set RHOSTS $TARGET;  
run;
exit" > specific_tests.txt

echo "[+] Assessment complete. Check output files for results."
```

#### **Integration with External Tools**
```bash
# WMAP + Nmap + Nikto comprehensive workflow
TARGET=$1

# Step 1: Nmap service discovery
nmap -sS -sV -p 80,443,8080 $TARGET > nmap_results.txt

# Step 2: WMAP automated scanning
msfconsole -q -r wmap_scan.rc

# Step 3: Nikto additional testing
nikto -h $TARGET > nikto_results.txt

# Step 4: Compile comprehensive report
python3 compile_web_report.py nmap_results.txt wmap_output.txt nikto_results.txt
```

### Continuous Integration for Web Security

#### **Automated WMAP in CI/CD Pipelines**
```yaml
# Example Jenkins/GitHub Actions integration
name: Web Security Scan
on: [push, pull_request]

jobs:
  wmap-scan:
    runs-on: ubuntu-latest
    steps:
    - name: Setup Metasploit
      run: |
        apt-get update
        apt-get install metasploit-framework
        
    - name: Run WMAP Scan
      run: |
        msfconsole -q -x "
        load wmap;
        wmap_sites -a ${{ env.TARGET_URL }};
        wmap_targets -t ${{ env.TARGET_URL }};
        wmap_run -e;
        wmap_vulns -l;
        exit" > wmap_results.txt
        
    - name: Process Results
      run: |
        if grep -q "vulnerability" wmap_results.txt; then
          echo "Vulnerabilities found - failing build"
          exit 1
        fi
```

---

## 📈 Career Development with WMAP Skills

### Professional Certifications Path

#### **Next Steps After eJPT**
1. **OSCP (Offensive Security Certified Professional)**
   - Advanced manual exploitation techniques
   - Custom exploit development
   - Buffer overflow exploitation
   - Active Directory attacks

2. **GCIH (GIAC Certified Incident Handler)**
   - Incident response and forensics
   - Malware analysis techniques
   - Network security monitoring
   - Enterprise security operations

3. **GPEN (GIAC Penetration Tester)**
   - Advanced penetration testing methodologies
   - Wireless security assessment
   - Social engineering techniques
   - Professional reporting standards

#### **Industry Applications**
- **Penetration Testing Consultant:** Use WMAP for client assessments
- **Security Analyst:** Integrate WMAP into security monitoring
- **Bug Bounty Hunter:** Apply WMAP skills to find web vulnerabilities
- **Red Team Operator:** Leverage WMAP in complex attack scenarios

### Real-World WMAP Applications

#### **Enterprise Security Assessment**
```bash
# Large-scale web application assessment
# Scanning multiple domains and subdomains

COMPANY_DOMAINS=(
  "example.com"
  "app.example.com"  
  "admin.example.com"
  "api.example.com"
)

for domain in "${COMPANY_DOMAINS[@]}"; do
  echo "[+] Assessing $domain..."
  
  # WMAP assessment
  msfconsole -q -x "
  load wmap;
  wmap_sites -a $domain;
  wmap_targets -t http://$domain;
  wmap_targets -t https://$domain;
  wmap_run -e;
  wmap_vulns -l;
  exit" > "assessment_$domain.txt"
  
done
```

#### **Compliance and Audit Support**
- **PCI DSS:** Web application security requirements
- **SOX:** Financial system security assessments  
- **HIPAA:** Healthcare application security testing
- **ISO 27001:** Information security management compliance

---

## 🎯 Success Metrics and Measurement

### eJPT Exam Success Indicators

#### **Technical Proficiency Benchmarks**
```
WMAP Skill Assessment:
┌─────────────────────────────────┬─────────┬─────────────┐
│ Skill                           │ Target  │ Time Limit  │
├─────────────────────────────────┼─────────┼─────────────┤
│ Basic WMAP setup and execution  │ 100%    │ 5 minutes   │
│ Web server identification       │ 95%     │ 2 minutes   │
│ Directory discovery             │ 90%     │ 3 minutes   │
│ Vulnerability documentation     │ 85%     │ 5 minutes   │
│ Integration with other tools    │ 80%     │ 10 minutes  │
└─────────────────────────────────┴─────────┴─────────────┘
```

#### **Performance Metrics Tracking**
```bash
# Create performance tracking log
echo "Date,Target,Setup_Time,Scan_Time,Findings_Count,Issues_Found" > wmap_performance.csv

# Record each practice session
echo "2024-11-15,192.168.1.100,120,480,8,0" >> wmap_performance.csv

# Analyze improvement over time
awk -F',' '{sum+=$3; count++} END {print "Average setup time:", sum/count}' wmap_performance.csv
```

### Career Development Milestones

#### **Professional Growth Indicators**
- **Months 1-3:** Master basic WMAP operations and eJPT certification
- **Months 4-6:** Integrate WMAP with advanced testing methodologies
- **Months 7-12:** Develop custom WMAP automation and reporting solutions
- **Year 2+:** Lead web application security assessments professionally

---

## 🎊 Conclusion and Final Thoughts

### Key Takeaways for eJPT Success

WMAP represents a critical component of modern web application security testing and serves as an essential tool for eJPT certification success. This comprehensive guide has covered every aspect necessary to master WMAP from basic operations to advanced integration techniques.

#### **Essential Success Factors**
1. **Master the Workflow:** Sites → Targets → Execute → Analyze becomes second nature
2. **Speed and Efficiency:** Complete WMAP assessments in under 15 minutes consistently  
3. **Results Interpretation:** Quickly identify and prioritize critical findings
4. **Professional Documentation:** Generate clear, actionable security reports
5. **Integration Skills:** Combine WMAP with other tools for comprehensive assessments

#### **eJPT Exam Readiness Checklist**
- [ ] Execute complete WMAP workflow in under 10 minutes
- [ ] Identify web server versions and technologies accurately
- [ ] Discover hidden directories and administrative interfaces
- [ ] Document findings with proper screenshots and evidence
- [ ] Troubleshoot common issues independently
- [ ] Integrate WMAP findings with manual testing techniques

### Beyond eJPT: Professional Applications

#### **Real-World Impact**
WMAP skills directly translate to professional penetration testing capabilities, providing the foundation for:
- **Client Security Assessments:** Comprehensive web application testing
- **Compliance Auditing:** Meeting regulatory security requirements
- **Vulnerability Management:** Systematic identification and prioritization
- **Security Research:** Contributing to the broader security community

#### **Continuous Learning Path**
- **Stay Updated:** Regular Metasploit updates bring new WMAP modules
- **Practice Regularly:** Maintain skills with consistent hands-on testing
- **Share Knowledge:** Contribute to security communities and forums
- **Ethical Application:** Always use skills responsibly and legally

### Final Words of Encouragement

Web application security represents one of the most dynamic and important areas of cybersecurity. WMAP provides an excellent foundation for understanding automated vulnerability assessment while developing the critical thinking skills necessary for manual security testing.

The skills developed through mastering WMAP extend far beyond the eJPT exam, forming the basis for a successful career in penetration testing, security analysis, and cybersecurity consulting. Remember that each scan teaches something new, every vulnerability discovered makes systems more secure, and every professional assessment contributes to a safer digital world.

**Master WMAP, excel in your eJPT exam, and build the foundation for a rewarding cybersecurity career!**

---

### Additional Support and Community

**Need help with WMAP or eJPT preparation?**
- **Official Metasploit Documentation:** https://docs.rapid7.com/metasploit/
- **eJPT Study Communities:** Reddit r/eJPT, Discord study groups
- **Practice Platforms:** TryHackMe, HackTheBox, VulnHub
- **Professional Development:** Local cybersecurity meetups and conferences

**Remember:** Ethical hacking requires permission, responsibility, and continuous learning. Use these skills to make the digital world more secure for everyone.

---

**Last Updated:** November 15, 2024  
**Version:** 1.0 - Complete eJPT Study Guide  
**Authors:** Cybersecurity Education Team  
**License:** Educational use with proper attribution
