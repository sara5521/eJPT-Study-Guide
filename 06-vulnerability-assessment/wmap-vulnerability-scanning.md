# ğŸŒ WMAP - Metasploit Web Application Vulnerability Scanner

**WMAP is a comprehensive web application vulnerability scanner integrated into the Metasploit Framework that automates the discovery and assessment of web application security vulnerabilities through modular scanning techniques.**

**ğŸ“‚ Location:** `06-vulnerability-assessment/wmap-vulnerability-scanning.md`

---

## ğŸ“– Table of Contents
1. [What is WMAP?](#-what-is-wmap)
2. [Installation and Setup](#-installation-and-setup)
3. [Core Concepts](#-core-concepts)
4. [Command Reference](#-command-reference)
5. [Step-by-Step Lab Walkthrough](#-step-by-step-lab-walkthrough)
6. [eJPT Exam Preparation](#-ejpt-exam-preparation)
7. [Troubleshooting Guide](#-troubleshooting-guide)
8. [Integration Workflows](#-integration-workflows)
9. [Documentation & Reporting](#-documentation--reporting)
10. [Advanced Techniques](#-advanced-techniques)

---

## ğŸ¯ What is WMAP?

### **Overview**
WMAP (Web Mapper) is a powerful web application vulnerability scanner that comes pre-integrated with the Metasploit Framework. It leverages Metasploit's extensive collection of auxiliary modules to perform automated security assessments against web applications.

### **Key Capabilities**
| **Feature** | **Description** | **Exam Relevance** |
|-------------|-----------------|-------------------|
| ğŸ” **Automated Scanning** | Runs multiple vulnerability checks simultaneously | â­â­â­â­â­ Critical |
| ğŸŒ **Web Server Detection** | Identifies web server software and versions | â­â­â­â­â­ Critical |
| ğŸ“ **Directory Discovery** | Finds hidden directories and files | â­â­â­â­ High |
| ğŸ” **Admin Interface Detection** | Locates administrative panels and login pages | â­â­â­â­ High |
| ğŸ“Š **Vulnerability Assessment** | Tests for common web application flaws | â­â­â­â­â­ Critical |
| ğŸ“ **Integrated Reporting** | Generates findings within Metasploit database | â­â­â­ Medium |

### **WMAP vs Other Web Scanners**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Feature         â”‚ WMAP        â”‚ Nikto       â”‚ Burp Suite  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Integration     â”‚ Metasploit  â”‚ Standalone  â”‚ Standalone  â”‚
â”‚ Automation      â”‚ High        â”‚ Medium      â”‚ Manual+Auto â”‚
â”‚ Module Count    â”‚ 39+ modules â”‚ 6700+ tests â”‚ Various     â”‚
â”‚ Exploit Chain   â”‚ Direct      â”‚ None        â”‚ Manual      â”‚
â”‚ eJPT Relevance  â”‚ Very High   â”‚ Medium      â”‚ High        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ Installation and Setup

### **Prerequisites Checklist**
- âœ… Kali Linux or system with Metasploit Framework
- âœ… Network connectivity to target web application
- âœ… Proper authorization for testing (legal scope)
- âœ… Basic understanding of web application architecture

### **Installation Verification**
```bash
# Step 1: Verify Metasploit installation
msfconsole --version
# Expected Output: metasploit v6.x.x-dev

# Step 2: Check system resources
free -h && df -h
# Ensure adequate RAM and disk space

# Step 3: Start Metasploit Framework
msfconsole
```

### **WMAP Plugin Loading**
```bash
# Inside msfconsole
msf6 > load wmap
[*] Successfully loaded plugin: wmap

# Verify WMAP is loaded
msf6 > wmap_help
```

**ğŸš¨ Common Loading Issues:**
- If WMAP fails to load: `msfdb reinit`
- Database connection errors: `msfdb start`
- Permission issues: Run as root or check file permissions

---

## ğŸ§  Core Concepts

### **WMAP Architecture**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    WMAP WORKFLOW                        â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  1. Site Management    â†’  Define target web servers     â”‚
â”‚  2. Target Definition  â†’  Specify URLs and paths        â”‚
â”‚  3. Module Loading     â†’  Load vulnerability modules    â”‚
â”‚  4. Scan Execution     â†’  Run tests against targets     â”‚
â”‚  5. Result Analysis    â†’  Review findings and vulns     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **Key Terminology**
| **Term** | **Definition** | **Example** |
|----------|----------------|-------------|
| **Site** | Target web server (IP:Port combination) | `192.168.1.100:80` |
| **Target** | Specific URL path to test | `http://192.168.1.100/admin` |
| **Module** | Individual vulnerability test script | `auxiliary/scanner/http/http_version` |
| **Node** | Discovered web resource or endpoint | `/login.php`, `/admin/panel` |

---

## ğŸ“š Command Reference

### **ğŸŒ Site Management Commands**
| **Command** | **Purpose** | **Example** | **Expected Output** |
|-------------|-------------|-------------|-------------------|
| `wmap_sites -a [IP]` | Add target site | `wmap_sites -a 192.168.1.100` | `[*] Site created` |
| `wmap_sites -l` | List all sites | `wmap_sites -l` | Table of configured sites |
| `wmap_sites -d [ID]` | Delete site by ID | `wmap_sites -d 0` | `[*] Site deleted` |
| `wmap_sites -c` | Clear all sites | `wmap_sites -c` | `[*] All sites deleted` |

### **ğŸ¯ Target Management Commands**
| **Command** | **Purpose** | **Example** | **Expected Output** |
|-------------|-------------|-------------|-------------------|
| `wmap_targets -t [URL]` | Add target URL | `wmap_targets -t http://192.168.1.100/admin` | `[*] Target created` |
| `wmap_targets -l` | List all targets | `wmap_targets -l` | Table of defined targets |
| `wmap_targets -c` | Clear all targets | `wmap_targets -c` | `[*] All targets deleted` |
| `wmap_targets -u [URL]` | Add single URL | `wmap_targets -u http://example.com/test` | `[*] Target added` |

### **ğŸ” Scanning Commands**
| **Command** | **Purpose** | **Example** | **Use Case** |
|-------------|-------------|-------------|--------------|
| `wmap_run -t` | Test/preview modules | `wmap_run -t` | Check which modules will run |
| `wmap_run -e` | Execute full scan | `wmap_run -e` | **Most common for eJPT** |
| `wmap_run -p` | Show scan progress | `wmap_run -p` | Monitor ongoing scans |
| `wmap_run -m [module]` | Run specific module | `wmap_run -m http_version` | Targeted testing |

### **ğŸ“Š Information Commands**
| **Command** | **Purpose** | **Output Description** |
|-------------|-------------|----------------------|
| `wmap_help` | Show all WMAP commands | Complete command reference |
| `wmap_vulns -l` | List discovered vulnerabilities | **Critical for eJPT reporting** |
| `wmap_nodes -l` | Show discovered web nodes | All found directories/files |
| `wmap_reports -l` | Display scan reports | Formatted vulnerability reports |

---

## ğŸ§ª Step-by-Step Lab Walkthrough

### **Phase 1: Environment Setup and Target Identification**
```bash
# Step 1: Identify your network interface and target
ifconfig
```
**Expected Output Analysis:**
```
eth0: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 10.1.1.5  netmask 255.255.255.0  broadcast 10.1.1.255
        
eth1: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500
        inet 192.157.89.2  netmask 255.255.255.0  broadcast 192.157.89.255
```

**ğŸ’¡ Analysis for eJPT:**
- **Kali Linux IP:** `192.157.89.2` (your attacking machine)
- **Target Network:** `192.157.89.0/24` 
- **Likely Target:** `192.157.89.3` (next IP in range)

### **Phase 2: Metasploit and WMAP Initialization**
```bash
# Step 2: Start Metasploit Framework
msfconsole

# Step 3: Load WMAP plugin
msf6 > load wmap
[*] Successfully loaded plugin: wmap
```

**âœ… Verification Checkpoint:**
- WMAP loaded successfully without errors
- No database connection issues
- Ready to proceed with target configuration

### **Phase 3: Target Configuration**
```bash
# Step 4: Add target site
msf6 > wmap_sites -a 192.157.89.3
[*] Site created.

# Step 5: Add specific target URL
msf6 > wmap_targets -t http://192.157.89.3
[*] Target created.
```

### **Phase 4: Configuration Verification**
```bash
# Step 6: Verify site configuration
msf6 > wmap_sites -l
[*] Available sites
===============

    Id  Host           Vhost          Port  Proto  # Pages  # Forms
    --  ----           -----          ----  -----  -------  -------
    0   192.157.89.3   192.157.89.3   80    http   0        0
```

```bash
# Step 7: Verify target configuration
msf6 > wmap_targets -l
[*] Defined targets
===============

    Id  Vhost          Host           Port  SSL    Path
    --  -----          ----           ----  ---    ----
    0   192.157.89.3   192.157.89.3   80    false  /
```

**ğŸ“‹ Configuration Analysis:**
- âœ… Target site properly added
- âœ… HTTP protocol on port 80
- âœ… SSL status: false (HTTP, not HTTPS)
- âœ… Root path (/) configured for scanning

### **Phase 5: Module Testing and Preview**
```bash
# Step 8: Test available modules
msf6 > wmap_run -t
[*] Testing target:
[*]     Site: 192.157.89.3 (192.157.89.3)
[*]     Port: 80 SSL: false
===============================================
[*] Testing started. 2021-11-15 23:13:50 +0000
[*] Loading wmap modules...

[*] 39 wmap enabled modules loaded.
[*]
=[ SSL testing ]=
===============================================
[*] Target is not SSL. SSL modules disabled.
[*]
=[ Web Server testing ]=
===============================================
[*] Module auxiliary/scanner/http/http_version
[*] Module auxiliary/scanner/http/open_proxy
[*] Module auxiliary/admin/http/tomcat_administration
[*] Module auxiliary/admin/http/tomcat_utf8_traversal
[*] Module auxiliary/scanner/http/drupal_views_user_enum
[*] Module auxiliary/scanner/http/frontpage_login
[*] Module auxiliary/scanner/http/host_header_injection
[*] Module auxiliary/scanner/http/options
[*] Module auxiliary/scanner/http/robots_txt
[*] Module auxiliary/scanner/http/scraper
[*] Module auxiliary/scanner/http/svn_scanner
[*] Module auxiliary/scanner/http/trace
[*] Module auxiliary/scanner/http/vhost_scanner
[*] Module auxiliary/scanner/http/webdav_internal_ip
[*] Module auxiliary/scanner/http/webdav_scanner
[*] Module auxiliary/scanner/http/webdav_website_content
```

**ğŸ“Š Module Analysis for eJPT:**
| **Module Category** | **Count** | **eJPT Importance** |
|-------------------|-----------|-------------------|
| SSL Testing | Disabled | â­â­ (if HTTPS present) |
| Web Server Testing | 14+ modules | â­â­â­â­â­ Critical |
| Admin Interface | 2 modules | â­â­â­â­ High |
| Directory Discovery | 5+ modules | â­â­â­â­ High |

### **Phase 6: Full Vulnerability Scan Execution**
```bash
# Step 9: Execute comprehensive scan
msf6 > wmap_run -e
[*] Using ALL wmap enabled modules
[*] NO WMAP NODES DEFINED. Executing local modules
[*] Testing target:
[*]     Site: 192.157.89.3 (192.157.89.3)
[*]     Port: 80 SSL: false
===============================================
[*] Testing started. 2021-11-15 23:16:50 +0000
[*]
=[ SSL testing ]=
===============================================
[*] Target is not SSL. SSL modules disabled.
[*]
=[ Web Server testing ]=
===============================================
[*] Module auxiliary/scanner/http/http_version
[+] 192.157.89.3:80 Apache/2.4.18 (Ubuntu)
[*] Module auxiliary/scanner/http/open_proxy
[*] Module auxiliary/admin/http/tomcat_administration
[*] Module auxiliary/admin/http/tomcat_utf8_traversal
[*] Attempting to connect to 192.157.89.3:80
[+] No File(s) found
[*] Module auxiliary/scanner/http/drupal_views_user_enum
```

**ğŸ¯ Critical Findings Analysis:**
1. **Web Server Identified:** `Apache/2.4.18 (Ubuntu)`
   - **eJPT Significance:** Always document server version
   - **Next Steps:** Check for Apache 2.4.18 vulnerabilities

2. **No Tomcat Files Found:** Administrative interfaces not exposed
   - **Security Posture:** Good - admin interfaces properly secured

3. **Scan Progress:** Multiple modules executing systematically

---

## ğŸ“ eJPT Exam Preparation

### **ğŸ“Š eJPT Weight Distribution**
```
WMAP Skills in eJPT Exam:
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Skill Area                      â”‚ Weight  â”‚ Commands    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ Web Server Identification       â”‚ 30%     â”‚ wmap_run -e â”‚
â”‚ Directory/File Discovery        â”‚ 25%     â”‚ wmap_nodes  â”‚
â”‚ Admin Interface Detection       â”‚ 20%     â”‚ Module scan â”‚
â”‚ Vulnerability Documentation     â”‚ 15%     â”‚ wmap_vulns  â”‚
â”‚ Scan Configuration & Setup      â”‚ 10%     â”‚ wmap_sites  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **ğŸ”¥ Must-Master Commands for eJPT**
```bash
# 1. ESSENTIAL WORKFLOW (Practice until automatic)
msfconsole
load wmap
wmap_sites -a TARGET_IP
wmap_targets -t http://TARGET_IP
wmap_run -e

# 2. RESULTS ANALYSIS (Critical for scoring points)
wmap_vulns -l
wmap_nodes -l
wmap_sites -l

# 3. QUICK VERIFICATION (Time-saving techniques)
wmap_run -t  # Preview before full scan
wmap_run -p  # Check progress
```

### **ğŸ“ eJPT Exam Scenarios**

#### **Scenario 1: Basic Web Application Assessment (40% probability)**
**Given:** IP address of a web server
**Task:** Identify web server technology and find administrative interfaces

**Solution Approach:**
```bash
# Step 1: Network identification
ifconfig  # Find your IP and target range

# Step 2: WMAP setup
msfconsole
load wmap
wmap_sites -a [TARGET_IP]
wmap_targets -t http://[TARGET_IP]

# Step 3: Execute scan
wmap_run -e

# Step 4: Document findings
wmap_vulns -l > findings.txt
```

**Expected Findings to Document:**
- Web server software and version
- Operating system details
- Administrative directories found
- Any exposed configuration files

#### **Scenario 2: Comprehensive Vulnerability Assessment (30% probability)**
**Given:** Multiple web applications on different ports
**Task:** Complete security assessment with detailed reporting

**Advanced Workflow:**
```bash
# Multiple port scanning
wmap_sites -a TARGET_IP:80
wmap_sites -a TARGET_IP:8080
wmap_sites -a TARGET_IP:443

# Comprehensive target definition
wmap_targets -t http://TARGET_IP/
wmap_targets -t http://TARGET_IP:8080/admin
wmap_targets -t https://TARGET_IP/

# Full assessment
wmap_run -e
```

### **â° Time Management for eJPT**
| **Task** | **Time Allocation** | **Tips** |
|----------|-------------------|----------|
| Environment Setup | 2-3 minutes | Practice until automatic |
| Target Configuration | 1-2 minutes | Use IP from ifconfig |
| Scan Execution | 5-10 minutes | Let it run, work on other tasks |
| Results Analysis | 3-5 minutes | Focus on server versions and vulns |
| Documentation | 2-3 minutes | Copy key findings only |

### **ğŸ¯ Common eJPT Questions Pattern**
1. **"What web server is running on the target?"**
   - Look for: `[+] TARGET_IP:80 Apache/X.X.X`
   - Answer format: Apache version number

2. **"What administrative directories were found?"**
   - Command: `wmap_nodes -l`
   - Look for: `/admin`, `/manager`, `/phpmyadmin`

3. **"List all discovered vulnerabilities"**
   - Command: `wmap_vulns -l`
   - Document: Each vulnerability with details

---

## âš ï¸ Troubleshooting Guide

### **ğŸ”§ Common Issues and Solutions**

#### **Issue 1: WMAP Plugin Won't Load**
```bash
# Problem: Plugin loading fails
msf6 > load wmap
[-] Failed to load plugin wmap: [error details]

# Solution Sequence:
msfdb reinit          # Reinitialize database
msfconsole --quiet    # Start with minimal output
load wmap             # Try loading again

# Alternative Solution:
sudo msfdb start      # Ensure database is running
msfconsole
reload_all            # Reload all plugins
load wmap
```

#### **Issue 2: Target Not Responding**
```bash
# Problem: Cannot connect to target during scan
# Diagnostic Steps:
ping TARGET_IP                    # Test basic connectivity
nmap -p 80,443 TARGET_IP         # Check port status
curl -I http://TARGET_IP         # Test HTTP response

# Solution: Verify target accessibility before WMAP
telnet TARGET_IP 80              # Manual connection test
```

#### **Issue 3: Scan Hangs or Freezes**
```bash
# Problem: WMAP scan stops responding
# Immediate Actions:
Ctrl+C                           # Stop current scan
wmap_run -p                      # Check if scan is still running

# Recovery Steps:
sessions -l                      # Check active sessions
wmap_targets -c                  # Clear targets
wmap_sites -c                    # Clear sites
# Reconfigure and restart
```

#### **Issue 4: No Modules Loading**
```bash
# Problem: 0 modules loaded message
[*] 0 wmap enabled modules loaded.

# Solution:
msfupdate                        # Update Metasploit
msfconsole
reload_all                       # Reload all modules
load wmap
wmap_run -t                      # Verify modules load
```

### **ğŸ©º Health Check Commands**
```bash
# System Health Verification
free -h                          # Check available memory
df -h                           # Check disk space
msfdb status                    # Database connectivity
wmap_help                       # Verify WMAP functionality
```

---

## ğŸ”— Integration Workflows

### **ğŸ¯ Primary Integration: Nmap â†’ WMAP â†’ Exploitation**

#### **Complete Web Application Testing Workflow**
```bash
# Phase 1: Network Discovery
nmap -sn 192.168.1.0/24                    # Find live hosts
nmap -sC -sV -p- TARGET_IP                 # Comprehensive port scan

# Phase 2: Web Application Scanning
msfconsole
load wmap
wmap_sites -a TARGET_IP
wmap_targets -t http://TARGET_IP
wmap_run -e

# Phase 3: Exploitation Planning
search type:exploit platform:web           # Find relevant exploits
use exploit/multi/http/[vulnerability]     # Select based on WMAP findings
```

#### **Information Flow Diagram**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    Nmap     â”‚â”€â”€â”€â–¶â”‚    WMAP     â”‚â”€â”€â”€â–¶â”‚ Exploitationâ”‚
â”‚             â”‚    â”‚             â”‚    â”‚             â”‚
â”‚ â€¢ Port Scan â”‚    â”‚ â€¢ Web Scan  â”‚    â”‚ â€¢ Targeted  â”‚
â”‚ â€¢ Service   â”‚    â”‚ â€¢ Vulns     â”‚    â”‚   Attacks   â”‚
â”‚   Detection â”‚    â”‚ â€¢ Paths     â”‚    â”‚ â€¢ Payloads  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### **ğŸ” Secondary Integration: WMAP â†’ Manual Testing**

#### **WMAP to Burp Suite Workflow**
```bash
# Step 1: Export WMAP findings
wmap_vulns -l > vulnerabilities.txt
wmap_nodes -l > discovered_paths.txt

# Step 2: Prepare for manual testing
grep "http" discovered_paths.txt         # Extract HTTP paths
sort -u discovered_paths.txt             # Remove duplicates

# Step 3: Import into Burp Suite
# Use discovered paths as targets for:
# - Parameter fuzzing
# - Authentication bypass
# - Injection testing
```

### **ğŸ“Š Advanced Multi-Tool Integration**
```bash
#!/bin/bash
# Comprehensive Web Application Assessment Script

TARGET=$1
OUTPUT_DIR="web_assessment_$(date +%Y%m%d_%H%M%S)"
mkdir -p $OUTPUT_DIR

echo "[+] Starting comprehensive web application assessment for $TARGET"

# Phase 1: Basic reconnaissance
echo "[+] Phase 1: Network reconnaissance"
nmap -sC -sV -p 80,443,8080 $TARGET > $OUTPUT_DIR/nmap_scan.txt

# Phase 2: Directory enumeration
echo "[+] Phase 2: Directory enumeration"
dirb http://$TARGET /usr/share/wordlists/dirb/common.txt > $OUTPUT_DIR/dirb_scan.txt

# Phase 3: WMAP vulnerability assessment
echo "[+] Phase 3: WMAP vulnerability scan"
cat > $OUTPUT_DIR/wmap_commands.rc << EOF
load wmap
wmap_sites -a $TARGET
wmap_targets -t http://$TARGET
wmap_run -e
wmap_vulns -l
exit
EOF

msfconsole -r $OUTPUT_DIR/wmap_commands.rc > $OUTPUT_DIR/wmap_results.txt

# Phase 4: Additional web scanning
echo "[+] Phase 4: Additional vulnerability scanning"
nikto -h $TARGET > $OUTPUT_DIR/nikto_scan.txt

echo "[+] Assessment complete. Results in: $OUTPUT_DIR"
```

---

## ğŸ“ Documentation & Reporting

### **ğŸ“‹ Evidence Collection Standards**

#### **Screenshot Requirements for eJPT**
1. **WMAP Loading Confirmation**
   ```bash
   msf6 > load wmap
   [*] Successfully loaded plugin: wmap
   ```
   
2. **Target Configuration Display**
   ```bash
   msf6 > wmap_sites -l
   # Full table showing configured sites
   ```

3. **Scan Execution and Results**
   ```bash
   msf6 > wmap_run -e
   # Full output showing modules and findings
   ```

4. **Vulnerability Summary**
   ```bash
   msf6 > wmap_vulns -l
   # Complete vulnerability listing
   ```

### **ğŸ“Š Professional Report Template**

#### **Executive Summary Format**
```markdown
# Web Application Security Assessment Report

## Executive Summary
- **Target:** 192.157.89.3
- **Assessment Date:** November 15, 2021
- **Tool Used:** WMAP (Metasploit Framework)
- **Scan Duration:** 15 minutes
- **Modules Executed:** 39 WMAP modules

## Key Findings
### Critical Issues
- None identified during automated scanning

### High Priority Items
- Web server version disclosure: Apache/2.4.18 (Ubuntu)
- Potential outdated software requiring updates

### Medium Priority Items
- Default error pages may reveal system information
- HTTP security headers analysis required

## Technical Details
### Target Configuration
```bash
Site: 192.157.89.3 (192.157.89.3)
Port: 80 Protocol: HTTP
SSL Status: Disabled
```

### Modules Executed
- HTTP Version Detection: âœ… Successful
- Admin Interface Scan: âœ… No exposures found
- Directory Traversal: âœ… No vulnerabilities
- Open Proxy Check: âœ… Secure configuration
```

#### **Detailed Findings Report**
```markdown
## Detailed Technical Findings

### Finding 1: Web Server Information Disclosure
**Severity:** Medium
**Module:** auxiliary/scanner/http/http_version
**Evidence:** 
```bash
[+] 192.157.89.3:80 Apache/2.4.18 (Ubuntu)
```
**Impact:** Server version information could aid attackers
**Recommendation:** Configure server to hide version information

### Finding 2: Administrative Interface Security
**Severity:** Low
**Module:** auxiliary/admin/http/tomcat_administration
**Evidence:**
```bash
[+] No File(s) found
```
**Impact:** Positive finding - no exposed admin interfaces
**Status:** Secure configuration confirmed
```

### **ğŸ”„ Automated Documentation Script**
```bash
#!/bin/bash
# WMAP Results Documentation Generator

TARGET=$1
TIMESTAMP=$(date '+%Y-%m-%d_%H-%M-%S')
REPORT_FILE="wmap_report_${TARGET//./_}_$TIMESTAMP.md"

cat > $REPORT_FILE << EOF
# WMAP Vulnerability Assessment Report

**Target:** $TARGET
**Date:** $(date)
**Operator:** $(whoami)
**Tool:** WMAP (Metasploit Framework)

## Scan Configuration
EOF

# Generate Metasploit resource file
cat > temp_wmap.rc << EOF
load wmap
wmap_sites -a $TARGET
wmap_targets -t http://$TARGET
wmap_run -e
wmap_vulns -l
wmap_nodes -l
exit
EOF

# Execute scan and capture output
echo "## Scan Results" >> $REPORT_FILE
echo '```' >> $REPORT_FILE
msfconsole -r temp_wmap.rc >> $REPORT_FILE
echo '```' >> $REPORT_FILE

# Cleanup
rm temp_wmap.rc

echo "Report generated: $REPORT_FILE"
```

---

## ğŸš€ Advanced Techniques

### **ğŸ¯ Targeted Module Execution**

#### **Server-Specific Scanning**
```bash
# For Apache servers (after initial detection)
msf6 > use auxiliary/scanner/http/apache_userdir_enum
msf6 > use auxiliary/scanner/http/apache_mod_negotiation_scanner

# For IIS servers
msf6 > use auxiliary/scanner/http/iis_internal_ip
msf6 > use auxiliary/scanner/http/iis_shortname_scanner

# For Tomcat servers
msf6 > use auxiliary/admin/http/tomcat_administration
msf6 > use auxiliary/admin/http/tomcat_utf8_traversal
```

#### **Technology Stack Detection**
```bash
# PHP applications
msf6 > use auxiliary/scanner/http/phpinfo_scanner
msf6 > use auxiliary/scanner/http/php_cgi_arg_injection

# Content Management Systems
msf6 > use auxiliary/scanner/http/drupal_views_user_enum
msf6 > use auxiliary/scanner/http/wordpress_login_enum
```

### **ğŸ” Custom Module Integration**

#### **Creating Custom WMAP Workflows**
```ruby
# Example: Custom module selection script
modules = [
  'auxiliary/scanner/http/http_version',
  'auxiliary/scanner/http/dir_scanner',
  'auxiliary/scanner/http/files_dir',
  'auxiliary/admin/http/tomcat_administration'
]

modules.each do |mod|
  run_single("use #{mod}")
  run_single("set RHOSTS #{target}")
  run_single("run")
end
```

### **âš¡ Performance Optimization**

#### **Resource Management**
```bash
# Optimize WMAP performance
msf6 > setg THREADS 20              # Increase thread count
msf6 > setg ConnectTimeout 5        # Reduce connection timeout
msf6 > setg VERBOSE false           # Reduce output verbosity

# Memory usage optimization
msf6 > unload all                   # Unload unnecessary plugins
msf6 > load wmap                    # Load only WMAP
```

#### **Selective Scanning Strategy**
```bash
# Quick assessment (high-value targets only)
quick_modules = [
  'http_version',
  'dir_scanner', 
  'robots_txt',
  'admin_dir_listing'
]

# Deep assessment (comprehensive testing)
comprehensive_modules = [
  # All 39+ WMAP modules
  'full_module_suite'
]
```

---

## ğŸ“š Additional Resources

### **ğŸ“ Learning Pathways**

#### **Beginner to Advanced Track**
1. **Foundation** (Week 1-2)
   - Metasploit basics and msfconsole navigation
   - Understanding web application architecture
   - HTTP protocol fundamentals

2. **Intermediate** (Week 3-4)
   - WMAP module deep-dive
   - Integration with other scanning tools
   - Manual vulnerability verification

3. **Advanced** (Week 5-6)
   - Custom module development
   - Automated assessment workflows
   - Professional reporting techniques

### **ğŸ“– Essential Reading**
- **OWASP Web Security Testing Guide:** https://owasp.org/www-project-web-security-testing-guide/
- **Metasploit Unleashed Course:** https://www.offensive-security.com/metasploit-unleashed/
- **Web Application Hacker's Handbook:** Portswigger methodology

### **ğŸ› ï¸ Practice Environments**
- **DVWA (Damn Vulnerable Web Application):** Local testing environment
- **WebGoat:** OWASP educational platform
- **HackTheBox Web Challenges:** Real-world scenarios
- **TryHackMe Web Fundamentals:** Structured learning path

### **ğŸ”— Community Resources**
- **Metasploit Community:** https://github.com/rapid7/metasploit-framework
- **Reddit Communities:** r/netsec, r/AskNetsec, r/howtohack
- **Discord Servers:** InfoSec Prep, eJPT Study Groups
- **YouTube Channels:** IppSec, LiveOverflow, John Hammond

---

## ğŸ¯ eJPT Success Strategies

### **ğŸ“ˆ Study Schedule (4-Week Plan)**

#### **Week 1: Foundation Building**
- **Day 1-2:** Metasploit installation and basic navigation
- **Day 3-4:** WMAP plugin loading and basic commands
- **Day 5-6:** Simple target configuration and scanning
- **Day 7:** Practice lab exercises and command memorization

#### **Week 2: Practical Skills**
- **Day 8-9:** Complex multi-target scanning scenarios
- **Day 10-11:** Results interpretation and analysis
- **Day 12-13:** Integration with other tools (Nmap, Nikto)
- **Day 14:** Timed practice sessions

#### **Week 3: Advanced Techniques**
- **Day 15-16:** Troubleshooting common issues
- **Day 17-18:** Professional documentation and reporting
- **Day 19-20:** Custom workflows and automation
- **Day 21:** Mock exam scenarios

#### **Week 4: Exam Preparation**
- **Day 22-23:** Full practice exams with time limits
- **Day 24-25:** Weak area reinforcement
- **Day 26-27:** Final review and command memorization
- **Day 28:** Rest day before exam

### **ğŸ’¡ Memory Aids and Mnemonics**

#### **WMAP Command Memory System**
```
S.T.A.R.T Method:
S - Sites (wmap_sites -a TARGET)
T - Targets (wmap_targets -t http://TARGET)
A - Activate (wmap_run -e)
R - Results (wmap_vulns -l)
T - Take notes (document findings)
```

#### **Common Port Mnemonics**
```
Web Services Memory Aid:
80  = HTTP (HyperText Transfer Protocol)
443 = HTTPS (HTTP Secure)
8080 = Alternative HTTP (often Tomcat)
8443 = Alternative HTTPS
3000 = Development servers (Node.js, Rails)
```

### **âš ï¸ Exam Day Tips**

#### **Pre-Exam Checklist**
- [ ] VM/System updated and tested
- [ ] Internet connection stable
- [ ] Metasploit database initialized
- [ ] WMAP plugin tested and working
- [ ] Note-taking template prepared
- [ ] Time management plan ready

#### **During Exam Strategy**
1. **First 5 minutes:** Read all questions, identify WMAP-related tasks
2. **Time allocation:** 15-20 minutes maximum per WMAP section
3. **Quick wins:** Start with web server identification (easiest points)
4. **Documentation:** Copy-paste commands and outputs immediately
5. **Backup plan:** If WMAP fails, have manual alternatives ready

---

## ğŸ”§ Quick Reference Cards

### **ğŸ´ Essential Commands Cheat Sheet**

```bash
# ============================================
#           WMAP ESSENTIAL COMMANDS
# ============================================

# SETUP SEQUENCE (memorize this order)
msfconsole
load wmap
wmap_sites -a TARGET_IP
wmap_targets -t http://TARGET_IP
wmap_run -e

# INFORMATION GATHERING
wmap_sites -l          # List sites
wmap_targets -l        # List targets  
wmap_vulns -l          # List vulnerabilities
wmap_nodes -l          # List discovered paths

# TROUBLESHOOTING
wmap_help             # Show all commands
wmap_run -t           # Test modules (don't execute)
wmap_run -p           # Show scan progress

# CLEANUP
wmap_sites -c         # Clear all sites
wmap_targets -c       # Clear all targets
```

### **ğŸ¯ Expected Output Patterns**

```bash
# Successful Site Addition
msf6 > wmap_sites -a 192.168.1.100
[*] Site created.

# Successful Target Addition  
msf6 > wmap_targets -t http://192.168.1.100
[*] Target created.

# Successful Scan Execution
msf6 > wmap_run -e
[*] Using ALL wmap enabled modules
[*] Testing started. [timestamp]
[*] 39 wmap enabled modules loaded.

# Web Server Detection (KEY FINDING)
[+] 192.168.1.100:80 Apache/2.4.18 (Ubuntu)
[+] 192.168.1.100:80 Microsoft-IIS/10.0
[+] 192.168.1.100:80 nginx/1.18.0

# Administrative Interface Discovery
[+] Found: /admin (Response: 200)
[+] Found: /manager (Response: 401) 
[+] Found: /phpmyadmin (Response: 403)
```

### **ğŸ“Š Scoring Matrix for eJPT**

| **Task Type** | **Points** | **Time Needed** | **WMAP Command** |
|---------------|------------|-----------------|------------------|
| Web server identification | 10-15 pts | 2-3 min | `wmap_run -e` â†’ look for [+] version |
| Admin interface discovery | 8-12 pts | 1-2 min | `wmap_nodes -l` â†’ /admin paths |
| Vulnerability enumeration | 15-20 pts | 3-5 min | `wmap_vulns -l` â†’ detailed list |
| Technology stack detection | 5-10 pts | 1-2 min | Analyze scan output for frameworks |

---

## ğŸ›¡ï¸ Security and Legal Considerations

### **ğŸ“‹ Rules of Engagement**

#### **Before Starting Any WMAP Scan**
```bash
# Legal verification checklist:
# [ ] Written authorization obtained
# [ ] Scope clearly defined (IP ranges, domains)
# [ ] Time windows established
# [ ] Emergency contacts available
# [ ] Data handling agreements in place
```

#### **Scope Management**
```bash
# Confirm target scope
ping TARGET_IP                    # Verify reachability
whois TARGET_IP                   # Check ownership
nslookup TARGET_IP                # Verify DNS resolution

# Document authorization
echo "Authorized by: [Name]" > scan_authorization.txt
echo "Date: $(date)" >> scan_authorization.txt  
echo "Scope: $TARGET_IP" >> scan_authorization.txt
```

### **ğŸ”’ Ethical Scanning Practices**

#### **Responsible Disclosure**
- Report vulnerabilities to system owners
- Allow reasonable time for patching
- Follow coordinated disclosure timelines
- Document communication attempts

#### **Data Protection**
```bash
# Secure evidence handling
mkdir secure_evidence_$(date +%Y%m%d)
chmod 700 secure_evidence_*
# Store all outputs in protected directory
wmap_vulns -l > secure_evidence_*/vulnerabilities.txt
```

---

## ğŸ‰ Conclusion

### **ğŸ¯ Key Takeaways**

**WMAP is a powerful, integrated web application vulnerability scanner that serves as a cornerstone tool for the eJPT exam and real-world penetration testing.**

#### **Critical Success Factors:**
1. **Master the basic workflow:** Sites â†’ Targets â†’ Execute â†’ Analyze
2. **Understand output interpretation:** Focus on [+] findings and version information
3. **Practice time management:** WMAP tasks should be completed in 15-20 minutes
4. **Document everything:** Copy-paste commands and outputs immediately
5. **Know your alternatives:** Have backup manual testing methods ready

#### **eJPT Exam Readiness Indicators:**
- âœ… Can complete full WMAP workflow in under 10 minutes
- âœ… Immediately recognize web server version disclosure
- âœ… Quickly identify administrative interfaces from scan output  
- âœ… Troubleshoot common loading and connectivity issues
- âœ… Properly document findings in exam-acceptable format

#### **Real-World Application:**
- **Professional Assessments:** WMAP provides automated baseline scanning
- **Time Efficiency:** Reduces manual testing time by 60-70%
- **Comprehensive Coverage:** 39+ modules cover most common web vulnerabilities
- **Integration Benefits:** Seamlessly connects with Metasploit exploitation framework

### **ğŸš€ Next Steps**

#### **Immediate Actions (Next 24 hours):**
1. Practice the complete WMAP workflow 5 times
2. Set up a local testing environment (DVWA or similar)
3. Create personal command reference card
4. Test troubleshooting procedures

#### **Short-term Goals (Next Week):**
1. Complete 10 full WMAP assessments on different targets
2. Practice integration with Nmap and manual testing
3. Develop personal documentation templates
4. Join eJPT study groups for practice scenarios

#### **Long-term Objectives (Next Month):**
1. Achieve sub-15-minute WMAP assessment times
2. Master advanced module selection and customization
3. Develop automated assessment scripts
4. Complete eJPT certification with confidence

---

**Remember: WMAP is not just a toolâ€”it's your gateway to comprehensive web application security assessment. Master it, and you'll have a significant advantage in both the eJPT exam and your penetration testing career.** 

**Good luck, and happy hunting! ğŸ¯ğŸ”**

---

### **ğŸ“ Support and Resources**

**Need help? Join our community:**
- **eJPT Discord Study Group:** [Link to study community]
- **Practice Lab Environment:** Set up DVWA locally for safe testing
- **Video Tutorials:** Search "WMAP eJPT tutorial" for visual learning
- **Official Documentation:** https://docs.metasploit.com/

**Last Updated:** November 2021  
**Version:** 2.0 - Enhanced for eJPT Success  
**Author:** eJPT Study Guide Team
